<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Homework6</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Homework6</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab131"></a><h1 class="section">Homework 6, By Jason Gross</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8.html#"><span class="id" type="library">Utf8</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.Eqdep_dec.html#"><span class="id" type="library">Eqdep_dec</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#"><span class="id" type="library">JMeq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#"><span class="id" type="library">Ensembles</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#"><span class="id" type="library">ProofIrrelevance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#"><span class="id" type="library">FunctionalExtensionality</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Setoids.Setoid.html#"><span class="id" type="library">Setoid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.omega.Omega.html#"><span class="id" type="library">Omega</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#"><span class="id" type="library">Classes.RelationClasses</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.Morphisms.html#"><span class="id" type="library">Morphisms</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ClassicalFacts.html#"><span class="id" type="library">ClassicalFacts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.ZArith.ZArith.html#"><span class="id" type="library">ZArith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.Eqdep.html#"><span class="id" type="library">Eqdep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Program.Basics.html#"><span class="id" type="library">Coq.Program.Basics</span></a>.<br/>

<br/>
<span class="id" type="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" type="keyword">Generalizable</span> <span class="id" type="keyword">All</span> <span class="id" type="keyword">Variables</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="::'∅'"><span class="id" type="notation">"</span></a>&empty;" := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#Empty_set"><span class="id" type="inductive">Datatypes.Empty_set</span></a>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="ℕ"><span class="id" type="abbreviation">&#x2115;</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>.<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name=":type_scope:x_'×'_x"><span class="id" type="notation">"</span></a>&times;" := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#prod"><span class="id" type="inductive">prod</span></a> (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 40, <span class="id" type="tactic">left</span> <span class="id" type="keyword">associativity</span>): <span class="id" type="var">type_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name="::x_'=='_x"><span class="id" type="notation">"</span></a>==" := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq"><span class="id" type="inductive">JMeq</span></a> (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name=":type_scope:x_'⊔'_x"><span class="id" type="notation">"</span></a>&#x2294;" := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#sum"><span class="id" type="inductive">sum</span></a> (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 50, <span class="id" type="tactic">left</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">type_scope</span>.<br/>

<br/>
<span class="id" type="var">Reserved</span> <span class="id" type="keyword">Infix</span> "o" (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 40, <span class="id" type="tactic">left</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" type="var">Reserved</span></span> <span class="inlinecode"><span class="id" type="keyword">Notation</span></span> <span class="inlinecode">"<a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a></span> <span class="inlinecode"><span class="id" type="var"><sup>-1</sup></span>"</span> <span class="inlinecode">(<span class="id" type="tactic">at</span></span> <span class="inlinecode"><span class="id" type="keyword">level</span></span> <span class="inlinecode">10).</span> 
</div>
<div class="code">

<br/>

<br/>
<span class="id" type="var">Reserved</span> <span class="id" type="keyword">Infix</span> "≅" (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70).<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="::x_'∈'_x"><span class="id" type="notation">"</span></a>x ∈ X" := (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#In"><span class="id" type="definition">In</span></a> <span class="id" type="var">_</span> <span class="id" type="var">X</span> <span class="id" type="var">x</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 50, <span class="id" type="keyword">no</span> <span class="id" type="keyword">associativity</span>).<br/>
<span class="id" type="keyword">Notation</span> <a name="::x_'∩'_x"><span class="id" type="notation">"</span></a>A ∩ B" := (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Intersection"><span class="id" type="inductive">Intersection</span></a> <span class="id" type="var">_</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 50, <span class="id" type="keyword">no</span> <span class="id" type="keyword">associativity</span>).<br/>
<span class="id" type="keyword">Notation</span> <a name="::x_'∪'_x"><span class="id" type="notation">"</span></a>A ∪ B" := (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Union"><span class="id" type="inductive">Union</span></a> <span class="id" type="var">_</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 50, <span class="id" type="keyword">no</span> <span class="id" type="keyword">associativity</span>).<br/>
<span class="id" type="keyword">Notation</span> <a name="::x_'⊆'_x"><span class="id" type="notation">"</span></a>A ⊆ B" := (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Included"><span class="id" type="definition">Included</span></a> <span class="id" type="var">_</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 50, <span class="id" type="keyword">no</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="sumbool_to_bool"><span class="id" type="definition">sumbool_to_bool</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">{</span></a><a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">{</span></a><a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">}</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a><br/>
&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="keyword">if</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> <span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a>.<br/>

<br/>
<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#sumbool_to_bool"><span class="id" type="definition">sumbool_to_bool</span></a> : <span class="id" type="var">sumbool</span> &gt;-&gt; <span class="id" type="var">bool</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="sig"><span class="id" type="section">sig</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="sigT_of_sigT2"><span class="id" type="definition">sigT_of_sigT2</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> (<span class="id" type="var">x</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT2"><span class="id" type="inductive">sigT2</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) := <span class="id" type="keyword">let</span> (<span class="id" type="var">a</span>, <span class="id" type="var">h</span>, <span class="id" type="var">_</span>) := <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#h"><span class="id" type="variable">h</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#sigT_of_sigT2"><span class="id" type="definition">sigT_of_sigT2</span></a> : <span class="id" type="var">sigT2</span> &gt;-&gt; <span class="id" type="var">sigT</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="projT3"><span class="id" type="definition">projT3</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> (<span class="id" type="var">x</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT2"><span class="id" type="inductive">sigT2</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">x0</span>, <span class="id" type="var">_</span>, <span class="id" type="var">h</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x0</span> <span class="id" type="keyword">return</span> (<a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#x0"><span class="id" type="variable">x0</span></a>)) := <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="Homework6.html#h"><span class="id" type="variable">h</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> (<span class="id" type="var">x</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig2"><span class="id" type="inductive">sig2</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) := <span class="id" type="keyword">let</span> (<span class="id" type="var">a</span>, <span class="id" type="var">h</span>, <span class="id" type="var">_</span>) := <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#h"><span class="id" type="variable">h</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> : <span class="id" type="var">sig2</span> &gt;-&gt; <span class="id" type="var">sig</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> (<span class="id" type="var">x</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig2"><span class="id" type="inductive">sig2</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">x0</span>, <span class="id" type="var">_</span>, <span class="id" type="var">h</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x0</span> <span class="id" type="keyword">return</span> (<a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#x0"><span class="id" type="variable">x0</span></a>)) := <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="Homework6.html#h"><span class="id" type="variable">h</span></a>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#sig"><span class="id" type="section">sig</span></a>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "not_tac" <span class="id" type="var">tactic</span>(<span class="id" type="var">tac</span>) := (<span class="id" type="var">tac</span>; <span class="id" type="tactic">fail</span> 1) || <span class="id" type="tactic">idtac</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "test_tac" <span class="id" type="var">tactic</span>(<span class="id" type="var">tac</span>) := <span class="id" type="var">not_tac</span> (<span class="id" type="var">not_tac</span> <span class="id" type="var">tac</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">atomic</span> <span class="id" type="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">f</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">fail</span> 1 <span class="id" type="var">x</span> "is not atomic"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">fail</span> 1 <span class="id" type="var">x</span> "is not atomic"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">_</span>, <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">fail</span> 1 <span class="id" type="var">x</span> "is not atomic"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">unique_pose</span> <span class="id" type="var">defn</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">T</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">defn</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">T</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">defn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">unique_pose_with_body</span> <span class="id" type="var">defn</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">defn</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">pose</span> <span class="id" type="var">defn</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "has_no_body" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">not_tac</span> (<span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">pose</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>).<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "has_body" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">not_tac</span> (<span class="id" type="var">has_no_body</span> <span class="id" type="var">H</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">head</span> <span class="id" type="var">expr</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">expr</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">f</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">head</span> <span class="id" type="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">expr</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">head_hnf</span> <span class="id" type="var">expr</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">expr'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">expr</span> <span class="id" type="keyword">in</span> <span class="id" type="var">head</span> <span class="id" type="var">expr'</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_do</span> <span class="id" type="var">tac</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">pose</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>; <span class="id" type="var">tac</span> <span class="id" type="var">H'</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_do_clear</span> <span class="id" type="var">tac</span> <span class="id" type="var">H</span> := <span class="id" type="var">simpl_do</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>) <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">do_with_hyp</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_hyp'</span> := <span class="id" type="var">do_with_hyp</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_hyp</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">rewrite_hyp'</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_rev_hyp'</span> := <span class="id" type="var">do_with_hyp</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_rev_hyp</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">rewrite_rev_hyp'</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_hyp'</span> := <span class="id" type="var">do_with_hyp</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_hyp</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">apply_hyp'</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">eapply_hyp'</span> := <span class="id" type="var">do_with_hyp</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">eapply</span> <span class="id" type="var">H</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">eapply_hyp</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">eapply_hyp'</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t'</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t'_long</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">intuition</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_con_with</span> <span class="id" type="var">con</span> <span class="id" type="var">tac</span> := <span class="id" type="var">tac</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="keyword">context</span>[<span class="id" type="var">con</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">core</span> <span class="id" type="keyword">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="var">tac</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_con_rev_with</span> <span class="id" type="var">con</span> <span class="id" type="var">tac</span> := <span class="id" type="var">tac</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="keyword">context</span>[<span class="id" type="var">con</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">core</span> <span class="id" type="keyword">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="var">tac</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_with</span> <span class="id" type="var">tac</span> := <span class="id" type="var">t_con_with</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <span class="id" type="var">tac</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_rev_with</span> <span class="id" type="var">tac</span> := <span class="id" type="var">t_con_rev_with</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <span class="id" type="var">tac</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_con</span> <span class="id" type="var">con</span> := <span class="id" type="var">t_con_with</span> <span class="id" type="var">con</span> <span class="id" type="var">t'</span>; <span class="id" type="var">t_con_with</span> <span class="id" type="var">con</span> <span class="id" type="var">t'_long</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_con_rev</span> <span class="id" type="var">con</span> := <span class="id" type="var">t_con_rev_with</span> <span class="id" type="var">con</span> <span class="id" type="var">t'</span>; <span class="id" type="var">t_con_rev_with</span> <span class="id" type="var">con</span> <span class="id" type="var">t'_long</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t</span> := <span class="id" type="var">t_with</span> <span class="id" type="var">t'</span>; <span class="id" type="var">t_with</span> <span class="id" type="var">t'_long</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_rev</span> := <span class="id" type="var">t_rev_with</span> <span class="id" type="var">t'</span>; <span class="id" type="var">t_rev_with</span> <span class="id" type="var">t'_long</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_transitivity</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">solve</span> [ <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">_</span> : ?<span class="id" type="var">Rel</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span>, <span class="id" type="var">_</span> : ?<span class="id" type="var">Rel</span> ?<span class="id" type="var">b</span> ?<span class="id" type="var">c</span> |- ?<span class="id" type="var">Rel</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">c</span> ] ⇒ <span class="id" type="tactic">transitivity</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">assumption</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> ].<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_all_matches_then</span> <span class="id" type="var">matcher</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">T</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">matcher</span> <span class="id" type="var">T</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>; <span class="id" type="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_all_matches</span> <span class="id" type="var">matcher</span> := <span class="id" type="var">destruct_all_matches_then</span> <span class="id" type="var">matcher</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_all_matches'</span> <span class="id" type="var">matcher</span> := <span class="id" type="var">destruct_all_matches_then</span> <span class="id" type="var">matcher</span> <span class="id" type="tactic">idtac</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_type_matcher</span> <span class="id" type="var">T</span> <span class="id" type="var">HT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<span class="id" type="var">T</span>] ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_type</span> <span class="id" type="var">T</span> := <span class="id" type="var">destruct_all_matches</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="var">destruct_type_matcher</span> <span class="id" type="var">T</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_type'</span> <span class="id" type="var">T</span> := <span class="id" type="var">destruct_all_matches'</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="var">destruct_type_matcher</span> <span class="id" type="var">T</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_head_matcher</span> <span class="id" type="var">T</span> <span class="id" type="var">HT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">head</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">T</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_head</span> <span class="id" type="var">T</span> := <span class="id" type="var">destruct_all_matches</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="var">destruct_head_matcher</span> <span class="id" type="var">T</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_head'</span> <span class="id" type="var">T</span> := <span class="id" type="var">destruct_all_matches'</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="var">destruct_head_matcher</span> <span class="id" type="var">T</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_head_hnf_matcher</span> <span class="id" type="var">T</span> <span class="id" type="var">HT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">head_hnf</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">T</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_head_hnf</span> <span class="id" type="var">T</span> := <span class="id" type="var">destruct_all_matches</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="var">destruct_head_hnf_matcher</span> <span class="id" type="var">T</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_head_hnf'</span> <span class="id" type="var">T</span> := <span class="id" type="var">destruct_all_matches'</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="var">destruct_head_hnf_matcher</span> <span class="id" type="var">T</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_hypotheses_matcher</span> <span class="id" type="var">HT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">HT'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">HT'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#ex"><span class="id" type="inductive">ex</span></a> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#and"><span class="id" type="inductive">and</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#prod"><span class="id" type="inductive">prod</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_hypotheses</span> := <span class="id" type="var">destruct_all_matches</span> <span class="id" type="var">destruct_hypotheses_matcher</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_hypotheses'</span> := <span class="id" type="var">destruct_all_matches'</span> <span class="id" type="var">destruct_hypotheses_matcher</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_sig_matcher</span> <span class="id" type="var">HT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">HT'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">HT'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig"><span class="id" type="inductive">sig</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig2"><span class="id" type="inductive">sig2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT2"><span class="id" type="inductive">sigT2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_sig</span> := <span class="id" type="var">destruct_all_matches</span> <span class="id" type="var">destruct_sig_matcher</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_sig'</span> := <span class="id" type="var">destruct_all_matches'</span> <span class="id" type="var">destruct_sig_matcher</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_all_hypotheses</span> := <span class="id" type="var">destruct_all_matches</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">HT</span> ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">destruct_hypotheses_matcher</span> <span class="id" type="var">HT</span> || <span class="id" type="var">destruct_sig_matcher</span> <span class="id" type="var">HT</span><br/>
).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_exists'</span> <span class="id" type="var">T</span> := <span class="id" type="tactic">cut</span> <span class="id" type="var">T</span>; <span class="id" type="tactic">try</span> (<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">∃</span> <span class="id" type="var">H</span>).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_exists</span> := <span class="id" type="var">destruct_head_hnf</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#ex"><span class="id" type="inductive">ex</span></a>;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#ex"><span class="id" type="inductive">ex</span></a> ?<span class="id" type="var">T</span> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">destruct_exists'</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig"><span class="id" type="inductive">sig</span></a> ?<span class="id" type="var">T</span> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">destruct_exists'</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> ?<span class="id" type="var">T</span> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">destruct_exists'</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig2"><span class="id" type="inductive">sig2</span></a> ?<span class="id" type="var">T</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">destruct_exists'</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT2"><span class="id" type="inductive">sigT2</span></a> ?<span class="id" type="var">T</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">destruct_exists'</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">specialized_assumption</span> <span class="id" type="var">tac</span> := <span class="id" type="var">tac</span>;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">H</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">_</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">specialize</span> (<span class="id" type="var">H</span> <span class="id" type="var">x</span>); <span class="id" type="var">specialized_assumption</span> <span class="id" type="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">assumption</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">specialize_uniquely</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">y</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">test_tac</span> (<span class="id" type="tactic">specialize</span> (<span class="id" type="var">H</span> <span class="id" type="var">x</span>)); <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">specialize</span> (<span class="id" type="var">H</span> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">specialize_all_ways_forall</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">H</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">_</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">unique_pose</span> (<span class="id" type="var">H</span> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">specialize_all_ways</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">unique_pose</span> (<span class="id" type="var">H</span> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">try_rewrite</span> <span class="id" type="var">rew_H</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">rew_H</span>; <span class="id" type="var">tac</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">rew_H</span>; <span class="id" type="var">tac</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">try_rewrite_by</span> <span class="id" type="var">rew_H</span> <span class="id" type="var">by_tac</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">rew_H</span> <span class="id" type="tactic">by</span> <span class="id" type="var">by_tac</span>; <span class="id" type="var">tac</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">rew_H</span> <span class="id" type="tactic">by</span> <span class="id" type="var">by_tac</span>; <span class="id" type="var">tac</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">try_rewrite_repeat</span> <span class="id" type="var">rew_H</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">rewrite</span> <span class="id" type="var">rew_H</span>; <span class="id" type="var">tac</span>)) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">rew_H</span>; <span class="id" type="var">tac</span>)).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">solve_repeat_rewrite</span> <span class="id" type="var">rew_H</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">rewrite</span> <span class="id" type="var">rew_H</span>; <span class="id" type="var">tac</span>) ] ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">rew_H</span>; <span class="id" type="var">tac</span>) ].<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sig_eq"><span class="id" type="lemma">sig_eq</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> (<span class="id" type="var">s</span> <span class="id" type="var">s'</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig"><span class="id" type="inductive">sig</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> → <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">s</span>, <span class="id" type="var">s'</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sig2_eq"><span class="id" type="lemma">sig2_eq</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> (<span class="id" type="var">s</span> <span class="id" type="var">s'</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig2"><span class="id" type="inductive">sig2</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> → <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">s</span>, <span class="id" type="var">s'</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sigT_eq"><span class="id" type="lemma">sigT_eq</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> (<span class="id" type="var">s</span> <span class="id" type="var">s'</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> → <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">s</span>, <span class="id" type="var">s'</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sigT2_eq"><span class="id" type="lemma">sigT2_eq</span></a> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> (<span class="id" type="var">s</span> <span class="id" type="var">s'</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT2"><span class="id" type="inductive">sigT2</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">s</span>, <span class="id" type="var">s'</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="injective_projections_JMeq"><span class="id" type="lemma">injective_projections_JMeq</span></a> (<span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">A'</span> <span class="id" type="var">B'</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">p1</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">p2</span> : <a class="idref" href="Homework6.html#A'"><span class="id" type="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a> → <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p1</span>, <span class="id" type="var">p2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">clear_refl_eq</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">x</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_eq'</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#sig_eq"><span class="id" type="lemma">sig_eq</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#sig2_eq"><span class="id" type="lemma">sig2_eq</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| ((<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#sigT_eq"><span class="id" type="lemma">sigT_eq</span></a> || <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#sigT2_eq"><span class="id" type="lemma">sigT2_eq</span></a>); <span class="id" type="tactic">intros</span>; <span class="id" type="var">clear_refl_eq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#injective_projections"><span class="id" type="lemma">injective_projections</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#injective_projections_JMeq"><span class="id" type="lemma">injective_projections_JMeq</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_eq</span> := <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">repeat</span> (<br/>
&nbsp;&nbsp;<span class="id" type="var">simpl_eq'</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×<br/>
).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_eq_refl</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">a</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">a</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">H</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.Eqdep_dec.html#K_dec"><span class="id" type="lemma">K_dec</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">try</span> <span class="id" type="var">decide</span> <span class="id" type="var">equality</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">congruence</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">split_in_context</span> <span class="id" type="var">ident</span> <span class="id" type="var">funl</span> <span class="id" type="var">funr</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="keyword">context</span> <span class="id" type="var">p</span> [<span class="id" type="var">ident</span>] |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H0</span> := <span class="id" type="keyword">context</span> <span class="id" type="var">p</span>[<span class="id" type="var">funl</span>] <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H0'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> <span class="id" type="var">H0'</span> <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H1</span> := <span class="id" type="keyword">context</span> <span class="id" type="var">p</span>[<span class="id" type="var">funr</span>] <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H1'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> <span class="id" type="var">H1'</span> <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">split_iff</span> := <span class="id" type="var">split_in_context</span> <span class="id" type="var">iff</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="keyword">Prop</span> ⇒ <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> → <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="keyword">Prop</span> ⇒ <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> → <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">split_and'</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">b</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">H0</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H1</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H0</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#proj1"><span class="id" type="lemma">proj1</span></a> <span class="id" type="var">H</span>); <span class="id" type="tactic">assert</span> (<span class="id" type="var">H1</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#proj2"><span class="id" type="lemma">proj2</span></a> <span class="id" type="var">H</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">split_and</span> := <span class="id" type="var">split_and'</span>; <span class="id" type="var">split_in_context</span> <span class="id" type="var">and</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="keyword">Prop</span> ⇒ <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="keyword">Prop</span> ⇒ <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">clear_hyp_of_type</span> <span class="id" type="var">type</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">type</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">clear_hyp_unless_context</span> <span class="id" type="var">hyp</span> <span class="id" type="var">conVar</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">hypT</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">hyp</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H0</span> : <span class="id" type="var">hypT</span>, <span class="id" type="var">H</span> : <span class="id" type="keyword">context</span>[<span class="id" type="var">conVar</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">fail</span> 1 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="var">conVar</span>] ] ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">clear_hyp_of_type</span> <span class="id" type="var">hypT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">recur_clear_context</span> <span class="id" type="var">con</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<span class="id" type="var">con</span>] |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">recur_clear_context</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">appcontext</span>[<span class="id" type="var">con</span>] |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">recur_clear_context</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">FreeQ</span> <span class="id" type="var">expr</span> <span class="id" type="var">subexpr</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">expr</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">appcontext</span>[<span class="id" type="var">subexpr</span>] ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_mor</span> <span class="id" type="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">Rel</span> ?<span class="id" type="var">a</span> <span class="id" type="var">x</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">FreeQ</span> <span class="id" type="var">a</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="var">clear_hyp_unless_context</span> <span class="id" type="var">H</span> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">Rel</span> <span class="id" type="var">x</span> ?<span class="id" type="var">a</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">FreeQ</span> <span class="id" type="var">a</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="var">clear_hyp_unless_context</span> <span class="id" type="var">H</span> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">repeat_subst_mor_of_type</span> <span class="id" type="var">type</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">m</span> : <span class="id" type="keyword">context</span>[<span class="id" type="var">type</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">subst_mor</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_by_rewrite_hyp_rew</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span> <span class="id" type="var">rew'</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">rew'</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<span class="id" type="var">a</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">fail</span> 1 "Rewrite failed to clear all instances of" <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<span class="id" type="var">a</span>] ] ⇒ <span class="id" type="tactic">fail</span> 1 "Rewrite failed to clear all instances of" <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_by_rewrite_hyp</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">subst_by_rewrite_hyp_rew</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">try</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">try</span> <span class="id" type="tactic">setoid_rewrite</span> <span class="id" type="var">H</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_by_rewrite_rev_hyp</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">subst_by_rewrite_hyp_rew</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">try</span> <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">try</span> <span class="id" type="tactic">setoid_rewrite</span> &lt;- <span class="id" type="var">H</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_by_rewrite</span> <span class="id" type="var">a</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">Rel</span> <span class="id" type="var">a</span> ?<span class="id" type="var">b</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">subst_by_rewrite_hyp</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">Rel</span> ?<span class="id" type="var">b</span> <span class="id" type="var">a</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">subst_by_rewrite_rev_hyp</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_atomic</span> <span class="id" type="var">a</span> := <span class="id" type="tactic">first</span> [ <span class="id" type="var">atomic</span> <span class="id" type="var">a</span> | <span class="id" type="tactic">fail</span> "Non-atomic variable" <span class="id" type="var">a</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">subst_by_rewrite</span> <span class="id" type="var">a</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_rel</span> <span class="id" type="var">rel</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">rel</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span> |- <span class="id" type="var">_</span> ] ⇒ (<span class="id" type="var">atomic</span> <span class="id" type="var">a</span>; <span class="id" type="var">subst_by_rewrite_hyp</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span>) || (<span class="id" type="var">atomic</span> <span class="id" type="var">b</span>; <span class="id" type="var">subst_by_rewrite_rev_hyp</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_body</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">subst</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">P</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>) : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Common_existT"><span class="id" type="constructor">Common_existT</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : <span class="id" type="var">A</span>, <span class="id" type="var">P</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> → <a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> <span class="id" type="var">P</span>.<br/>
<span class="id" type="keyword">Definition</span> <a name="Common_projT1"><span class="id" type="definition">Common_projT1</span></a> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">P</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">x</span> : @<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>) := <span class="id" type="keyword">let</span> (<span class="id" type="var">a</span>, <span class="id" type="var">_</span>) := <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>.<br/>
<span class="id" type="keyword">Definition</span> <a name="Common_projT2"><span class="id" type="definition">Common_projT2</span></a> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">P</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">x</span> : @<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>) := <span class="id" type="keyword">let</span> (<span class="id" type="var">x0</span>, <span class="id" type="var">h</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x0</span> <span class="id" type="keyword">return</span> (<a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> (<a class="idref" href="Homework6.html#Common_projT1"><span class="id" type="definition">Common_projT1</span></a> <a class="idref" href="Homework6.html#x0"><span class="id" type="variable">x0</span></a>)) := <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="Homework6.html#h"><span class="id" type="variable">h</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">uncurryT</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> (<span class="id" type="var">x</span> : ?<span class="id" type="var">T1</span>) (<span class="id" type="var">y</span> : @?<span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>), @?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> ⇒ <span class="id" type="var">uncurryT</span> (<span class="id" type="keyword">∀</span> <span class="id" type="var">xy</span> : @<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span>, <span class="id" type="var">f</span> (<a class="idref" href="Homework6.html#Common_projT1"><span class="id" type="definition">Common_projT1</span></a> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a>) (<a class="idref" href="Homework6.html#Common_projT2"><span class="id" type="definition">Common_projT2</span></a> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H'</span> ⇒ <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">curryT</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">xy</span> : @<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> ?<span class="id" type="var">T1</span> ?<span class="id" type="var">T2</span>, @?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a> ⇒ <span class="id" type="var">curryT</span> (<span class="id" type="keyword">∀</span> (<span class="id" type="var">x</span> : <span class="id" type="var">T1</span>) (<span class="id" type="var">y</span> : <span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>), <span class="id" type="var">f</span> (@<a class="idref" href="Homework6.html#Common_existT"><span class="id" type="constructor">Common_existT</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H'</span> ⇒ <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">uncurry</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">HT</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> (<span class="id" type="var">x</span> : ?<span class="id" type="var">T1</span>) (<span class="id" type="var">y</span> : @?<span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="var">z</span> : @?<span class="id" type="var">T3</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>), @?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#z"><span class="id" type="variable">z</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">uncurry</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">xyz</span> ⇒ <span class="id" type="var">H</span> (<a class="idref" href="Homework6.html#Common_projT1"><span class="id" type="definition">Common_projT1</span></a> (<a class="idref" href="Homework6.html#Common_projT1"><span class="id" type="definition">Common_projT1</span></a> <a class="idref" href="Homework6.html#xyz"><span class="id" type="variable">xyz</span></a>)) (<a class="idref" href="Homework6.html#Common_projT2"><span class="id" type="definition">Common_projT2</span></a> (<a class="idref" href="Homework6.html#Common_projT1"><span class="id" type="definition">Common_projT1</span></a> <a class="idref" href="Homework6.html#xyz"><span class="id" type="variable">xyz</span></a>)) (<a class="idref" href="Homework6.html#Common_projT2"><span class="id" type="definition">Common_projT2</span></a> <a class="idref" href="Homework6.html#xyz"><span class="id" type="variable">xyz</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> (<span class="id" type="var">x</span> : ?<span class="id" type="var">T1</span>) (<span class="id" type="var">y</span> : @?<span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>), @?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> ⇒ <span class="id" type="var">uncurry</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">xy</span> : @<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> ⇒ <span class="id" type="var">H</span> (<a class="idref" href="Homework6.html#Common_projT1"><span class="id" type="definition">Common_projT1</span></a> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a>) (<a class="idref" href="Homework6.html#Common_projT2"><span class="id" type="definition">Common_projT2</span></a> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H'</span> ⇒ <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">curry</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">HT</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">xy</span> : @<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> ?<span class="id" type="var">T1</span> ?<span class="id" type="var">T2</span>, @?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a> ⇒ <span class="id" type="var">curry</span> (<span class="id" type="keyword">fun</span> (<span class="id" type="var">x</span> : <span class="id" type="var">T1</span>) (<span class="id" type="var">y</span> : <span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) ⇒ <span class="id" type="var">H</span> (@<a class="idref" href="Homework6.html#Common_existT"><span class="id" type="constructor">Common_existT</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H'</span> ⇒ <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fg_equal"><span class="id" type="lemma">fg_equal</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">f</span> <span class="id" type="var">g</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>) : <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="telescope"><span class="id" type="section">telescope</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="telescope"><span class="id" type="inductive">telescope</span></a> :=<br/>
&nbsp;&nbsp;| <a name="Base"><span class="id" type="constructor">Base</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">B</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>), (<span class="id" type="keyword">∀</span> <span class="id" type="var">a</span>, <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) → (<span class="id" type="keyword">∀</span> <span class="id" type="var">a</span>, <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) → <a class="idref" href="Homework6.html#telescope"><span class="id" type="inductive">telescope</span></a><br/>
&nbsp;&nbsp;| <a name="Quant"><span class="id" type="constructor">Quant</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>, (<a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <a class="idref" href="Homework6.html#telescope"><span class="id" type="inductive">telescope</span></a>) → <a class="idref" href="Homework6.html#telescope"><span class="id" type="inductive">telescope</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="telescopeOut"><span class="id" type="definition">telescopeOut</span></a> (<span class="id" type="var">t</span> : <a class="idref" href="Homework6.html#telescope"><span class="id" type="inductive">telescope</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#Base"><span class="id" type="constructor">Base</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> ⇒ <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#Quant"><span class="id" type="constructor">Quant</span></a> <span class="id" type="var">_</span> <span class="id" type="var">f</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#telescopeOut"><span class="id" type="definition">telescopeOut</span></a> (<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="telescopeOut'"><span class="id" type="definition">telescopeOut'</span></a> (<span class="id" type="var">t</span> : <a class="idref" href="Homework6.html#telescope"><span class="id" type="inductive">telescope</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#Base"><span class="id" type="constructor">Base</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">g</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#Quant"><span class="id" type="constructor">Quant</span></a> <span class="id" type="var">_</span> <span class="id" type="var">f</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#telescopeOut'"><span class="id" type="definition">telescopeOut'</span></a> (<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="generalized_fg_equal"><span class="id" type="lemma">generalized_fg_equal</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">t</span> : <a class="idref" href="Homework6.html#telescope"><span class="id" type="inductive">telescope</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#telescopeOut"><span class="id" type="definition">telescopeOut</span></a> <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#telescopeOut'"><span class="id" type="definition">telescopeOut'</span></a> <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intuition</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#telescope"><span class="id" type="section">telescope</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">curry_in_Quant</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="Homework6.html#Quant"><span class="id" type="constructor">Quant</span></a> (@<a class="idref" href="Homework6.html#Common_sigT"><span class="id" type="inductive">Common_sigT</span></a> ?<span class="id" type="var">T1</span> ?<span class="id" type="var">T2</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">xy</span> ⇒ @?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#xy"><span class="id" type="variable">xy</span></a>) ⇒ <span class="id" type="var">curry_in_Quant</span> (@<a class="idref" href="Homework6.html#Quant"><span class="id" type="constructor">Quant</span></a> <span class="id" type="var">T1</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ @<a class="idref" href="Homework6.html#Quant"><span class="id" type="constructor">Quant</span></a> (<span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">y</span> ⇒ <span class="id" type="var">f</span> (@<a class="idref" href="Homework6.html#Common_existT"><span class="id" type="constructor">Common_existT</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H'</span> ⇒ <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">reifyToTelescope'</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">HT</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="var">uncurryT</span> <span class="id" type="var">HT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">H'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> ?<span class="id" type="var">T</span> ?<span class="id" type="var">f</span> ?<span class="id" type="var">g</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">T'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">T</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">T'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : ?<span class="id" type="var">a</span>, @?<span class="id" type="var">b</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> ⇒ <span class="id" type="keyword">constr</span>:(@<a class="idref" href="Homework6.html#Base"><span class="id" type="constructor">Base</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> (@?<span class="id" type="var">T</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (@?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (@?<span class="id" type="var">g</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">T'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">T</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">T'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">y</span> : @?<span class="id" type="var">a</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>, @?<span class="id" type="var">b</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>) ⇒ <span class="id" type="keyword">constr</span>:(<a class="idref" href="Homework6.html#Quant"><span class="id" type="constructor">Quant</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ @<a class="idref" href="Homework6.html#Base"><span class="id" type="constructor">Base</span></a> (<span class="id" type="var">a</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="var">b</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="var">g</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">reifyToTelescope</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">t'</span> := <span class="id" type="var">reifyToTelescope'</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">curry_in_Quant</span> <span class="id" type="var">t'</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">fg_equal_in</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">reifyToTelescope</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">apply</span> (<a class="idref" href="Homework6.html#generalized_fg_equal"><span class="id" type="lemma">generalized_fg_equal</span></a> <span class="id" type="var">t</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">fg_equal</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">fg_equal_in</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="f_equal_helper"><span class="id" type="lemma">f_equal_helper</span></a> <span class="id" type="var">A0</span> (<span class="id" type="var">A</span> <span class="id" type="var">B</span> : <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a0</span>, <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a0</span>, <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) :<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">a0</span>, <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) → (<span class="id" type="keyword">∀</span> <span class="id" type="var">a0</span>, <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> (<a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> (<a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">a0</span>; <span class="id" type="tactic">specialize</span> (<span class="id" type="var">H</span> <span class="id" type="var">a0</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">f_equal_in_r</span> <span class="id" type="var">H</span> <span class="id" type="var">k</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="var">uncurry</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H'T</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H'</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">k'</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">v</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">v'</span> := <span class="id" type="var">curry</span> <span class="id" type="var">v</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <span class="id" type="var">v'</span>); <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="tactic">eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'T</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> ?<span class="id" type="var">A</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ⇒ <span class="id" type="var">k</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">B</span> (<span class="id" type="var">f</span> : <span class="id" type="var">A</span> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>) ⇒ @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#f_equal"><span class="id" type="lemma">f_equal</span></a> <span class="id" type="var">A</span> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H'</span>) <span class="id" type="var">k'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">a0</span> : ?<span class="id" type="var">A0</span>, @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> (@?<span class="id" type="var">A</span> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) (@?<span class="id" type="var">x</span> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) (@?<span class="id" type="var">y</span> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <span class="id" type="var">k</span> (<span class="id" type="keyword">fun</span> (<span class="id" type="var">B</span> : <span class="id" type="var">A0</span> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a0</span> : <span class="id" type="var">A0</span>, <span class="id" type="var">A</span> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) ⇒ @<a class="idref" href="Homework6.html#f_equal_helper"><span class="id" type="lemma">f_equal_helper</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">A</span> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H'</span>) <span class="id" type="var">k'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">f_equal_in</span> <span class="id" type="var">f</span> <span class="id" type="var">H</span> := <span class="id" type="var">f_equal_in_r</span> <span class="id" type="var">H</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">pf</span> <span class="id" type="var">k</span> ⇒ <span class="id" type="var">k</span> (<span class="id" type="var">pf</span> <span class="id" type="var">_</span> <span class="id" type="var">f</span>)).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">eta_red</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ ?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">change</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) <span class="id" type="keyword">with</span> <span class="id" type="var">f</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ ?<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>] ] ⇒ <span class="id" type="tactic">change</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">f</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) <span class="id" type="keyword">with</span> <span class="id" type="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sigT_eta"><span class="id" type="lemma">sigT_eta</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">A</span> (<span class="id" type="var">P</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sigT2_eta"><span class="id" type="lemma">sigT2_eta</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">A</span> (<span class="id" type="var">P</span> <span class="id" type="var">Q</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT2"><span class="id" type="inductive">sigT2</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT2"><span class="id" type="constructor">existT2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sig_eta"><span class="id" type="lemma">sig_eta</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">A</span> (<span class="id" type="var">P</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig"><span class="id" type="inductive">sig</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="sig2_eta"><span class="id" type="lemma">sig2_eta</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">A</span> (<span class="id" type="var">P</span> <span class="id" type="var">Q</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig2"><span class="id" type="inductive">sig2</span></a> <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist2"><span class="id" type="constructor">exist2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prod_eta"><span class="id" type="lemma">prod_eta</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">A</span> <span class="id" type="var">B</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#pair"><span class="id" type="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_eta_in</span> <span class="id" type="var">Hf</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">Hf</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT2"><span class="id" type="constructor">existT2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sigT2_eta"><span class="id" type="lemma">sigT2_eta</span></a> <span class="id" type="var">E</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist2"><span class="id" type="constructor">exist2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sig2_eta"><span class="id" type="lemma">sig2_eta</span></a> <span class="id" type="var">E</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sigT_eta"><span class="id" type="lemma">sigT_eta</span></a> <span class="id" type="var">E</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sig_eta"><span class="id" type="lemma">sig_eta</span></a> <span class="id" type="var">E</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#pair"><span class="id" type="constructor">pair</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#prod_eta"><span class="id" type="lemma">prod_eta</span></a> <span class="id" type="var">E</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_eta</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT2"><span class="id" type="constructor">existT2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sigT2_eta"><span class="id" type="lemma">sigT2_eta</span></a> <span class="id" type="var">E</span>); <span class="id" type="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist2"><span class="id" type="constructor">exist2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sig2_eta"><span class="id" type="lemma">sig2_eta</span></a> <span class="id" type="var">E</span>); <span class="id" type="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sigT_eta"><span class="id" type="lemma">sigT_eta</span></a> <span class="id" type="var">E</span>); <span class="id" type="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#sig_eta"><span class="id" type="lemma">sig_eta</span></a> <span class="id" type="var">E</span>); <span class="id" type="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">E</span> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#pair"><span class="id" type="constructor">pair</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Homework6.html#prod_eta"><span class="id" type="lemma">prod_eta</span></a> <span class="id" type="var">E</span>); <span class="id" type="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_proj2_sig_from_goal'_by</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> ?<span class="id" type="var">x</span>] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> (<a class="idref" href="Homework6.html#sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> ?<span class="id" type="var">x</span>)] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_proj2_sig_from_goal_by</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> ?<span class="id" type="var">x</span>] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> (<a class="idref" href="Homework6.html#sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> ?<span class="id" type="var">x</span>)] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_projT2_from_goal_by</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> ?<span class="id" type="var">x</span>] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> (<a class="idref" href="Homework6.html#sigT_of_sigT2"><span class="id" type="definition">sigT_of_sigT2</span></a> ?<span class="id" type="var">x</span>)] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_proj2_sig_by</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> ?<span class="id" type="var">x</span>] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> ?<span class="id" type="var">x</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> ?<span class="id" type="var">x</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> (<a class="idref" href="Homework6.html#sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> ?<span class="id" type="var">x</span>)] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> (<a class="idref" href="Homework6.html#sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> ?<span class="id" type="var">x</span>)] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> (<a class="idref" href="Homework6.html#sig_of_sig2"><span class="id" type="definition">sig_of_sig2</span></a> ?<span class="id" type="var">x</span>)] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_projT2_by</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> ?<span class="id" type="var">x</span>] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> ?<span class="id" type="var">x</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> ?<span class="id" type="var">x</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> (<a class="idref" href="Homework6.html#sigT_of_sigT2"><span class="id" type="definition">sigT_of_sigT2</span></a> ?<span class="id" type="var">x</span>)] ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> (<a class="idref" href="Homework6.html#sigT_of_sigT2"><span class="id" type="definition">sigT_of_sigT2</span></a> ?<span class="id" type="var">x</span>)] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> (<a class="idref" href="Homework6.html#sigT_of_sigT2"><span class="id" type="definition">sigT_of_sigT2</span></a> ?<span class="id" type="var">x</span>)] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tac</span> (<a class="idref" href="Homework6.html#projT3"><span class="id" type="definition">projT3</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_proj2_sig_from_goal'</span> := <span class="id" type="var">intro_proj2_sig_from_goal'_by</span> <span class="id" type="var">unique_pose</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_proj2_sig_from_goal</span> := <span class="id" type="var">intro_proj2_sig_from_goal_by</span> <span class="id" type="var">unique_pose</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_projT2_from_goal</span> := <span class="id" type="var">intro_projT2_from_goal_by</span> <span class="id" type="var">unique_pose</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_projT2_from_goal_with_body</span> := <span class="id" type="var">intro_projT2_from_goal_by</span> <span class="id" type="var">unique_pose_with_body</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_proj2_sig</span> := <span class="id" type="var">intro_proj2_sig_by</span> <span class="id" type="var">unique_pose</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_projT2</span> := <span class="id" type="var">intro_projT2_by</span> <span class="id" type="var">unique_pose</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_projT2_with_body</span> := <span class="id" type="var">intro_projT2_by</span> <span class="id" type="var">unique_pose_with_body</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">recr_destruct_with</span> <span class="id" type="var">tac</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H0</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">H1</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">tac</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>, <span class="id" type="var">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">recr_destruct_with</span> <span class="id" type="var">tac</span> <span class="id" type="var">H0</span> || <span class="id" type="var">recr_destruct_with</span> <span class="id" type="var">tac</span> <span class="id" type="var">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H0</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H1</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">do_rewrite</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">do_rewrite_rev</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">recr_destruct_rewrite</span> <span class="id" type="var">H</span> := <span class="id" type="var">recr_destruct_with</span> <span class="id" type="var">do_rewrite</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">recr_destruct_rewrite_rev</span> <span class="id" type="var">H</span> := <span class="id" type="var">recr_destruct_with</span> <span class="id" type="var">do_rewrite_rev</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">use_proj2_sig_with</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> ?<span class="id" type="var">x</span>] ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a>] ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">simpl_do_clear</span> <span class="id" type="var">tac</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_proj2_sig</span> := <span class="id" type="var">use_proj2_sig_with</span> <span class="id" type="var">recr_destruct_rewrite</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_rev_proj2_sig</span> := <span class="id" type="var">use_proj2_sig_with</span> <span class="id" type="var">recr_destruct_rewrite_rev</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="is_unique"><span class="id" type="definition">is_unique</span></a> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) := <span class="id" type="keyword">∀</span> <span class="id" type="var">x'</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>, <a class="idref" href="Homework6.html#x'"><span class="id" type="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Implicit Arguments</span> <a class="idref" href="Homework6.html#is_unique"><span class="id" type="definition">is_unique</span></a> [<span class="id" type="var">A</span>].<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_unique</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <a class="idref" href="Homework6.html#is_unique"><span class="id" type="definition">is_unique</span></a> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">unfold</span> <a class="idref" href="Homework6.html#is_unique"><span class="id" type="definition">is_unique</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> || <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>; <span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">generalize_is_unique_hyp</span> <span class="id" type="var">H</span> <span class="id" type="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">T</span>, <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="var">etransitivity</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span> || <span class="id" type="tactic">symmetry</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">generalize_is_unique</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : @<a class="idref" href="Homework6.html#is_unique"><span class="id" type="definition">is_unique</span></a> ?<span class="id" type="var">T</span> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">generalize_is_unique_hyp</span> <span class="id" type="var">H</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">intro_fresh_unique</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : @<a class="idref" href="Homework6.html#is_unique"><span class="id" type="definition">is_unique</span></a> ?<span class="id" type="var">T</span> ?<span class="id" type="var">x</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">x'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> (<span class="id" type="var">x'</span> := <span class="id" type="var">x</span>); <span class="id" type="tactic">rewrite</span> &lt;- (<span class="id" type="var">H</span> <span class="id" type="var">x'</span>) <span class="id" type="keyword">in</span> *; <span class="id" type="var">generalize_is_unique_hyp</span> <span class="id" type="var">H</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">specialize_with_evars_then_do</span> <span class="id" type="var">E</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">E</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">y</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">evar</span> (<span class="id" type="var">y</span> : <span class="id" type="var">T</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">y'</span> := (<span class="id" type="tactic">eval</span> <span class="id" type="tactic">unfold</span> <span class="id" type="var">y</span> <span class="id" type="keyword">in</span> <span class="id" type="var">y</span>) <span class="id" type="keyword">in</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">specialize_with_evars_then_do</span> (<span class="id" type="var">E</span> <span class="id" type="var">y'</span>) <span class="id" type="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">E</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">specialize_hyp_with_evars</span> <span class="id" type="var">E</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">E</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">y</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">evar</span> (<span class="id" type="var">y</span> : <span class="id" type="var">T</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">y'</span> := (<span class="id" type="tactic">eval</span> <span class="id" type="tactic">unfold</span> <span class="id" type="var">y</span> <span class="id" type="keyword">in</span> <span class="id" type="var">y</span>) <span class="id" type="keyword">in</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">E</span> <span class="id" type="var">y'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">existential_to_evar</span> <span class="id" type="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">is_evar</span> <span class="id" type="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">x'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">x'</span> := <span class="id" type="var">x</span>) <span class="id" type="keyword">in</span> ×.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">existentials_to_evars_in_goal</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[?<span class="id" type="var">x</span>] ] ⇒ <span class="id" type="var">existential_to_evar</span> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">existentials_to_evars_in_hyps</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="keyword">context</span>[?<span class="id" type="var">x</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">existential_to_evar</span> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">existentials_to_evars_in</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span>[?<span class="id" type="var">x</span>] ⇒ <span class="id" type="var">existential_to_evar</span> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" := <span class="id" type="var">existentials_to_evars_in_goal</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" "in" "|-" "*" := <span class="id" type="var">existentials_to_evars_in_goal</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" "in" "*" := <span class="id" type="var">existentials_to_evars_in_goal</span>; <span class="id" type="var">existentials_to_evars_in_hyps</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" "in" "*" "|-" := <span class="id" type="var">existentials_to_evars_in_hyps</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>) "|-" "*" := <span class="id" type="var">existentials_to_evars_in</span> <span class="id" type="var">H</span>; <span class="id" type="var">existentials_to_evars_in_goal</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>) := <span class="id" type="var">existentials_to_evars_in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "existentials_to_evars" "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>) "|-" := <span class="id" type="var">existentials_to_evars_in</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simultaneous_rewrite'</span> <span class="id" type="var">E</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">E</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">X</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">generalize</span> <span class="id" type="var">E</span>; <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">X</span>; <span class="id" type="tactic">intros</span> <span class="id" type="tactic">until</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span> <span class="id" type="tactic">at</span> <span class="id" type="var">top</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" type="var">X'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">subst</span> <span class="id" type="var">X'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simultaneous_rewrite_rev'</span> <span class="id" type="var">E</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">E</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X</span> ⇒ <span class="id" type="tactic">generalize</span> <span class="id" type="var">E</span>; <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">X</span>; <span class="id" type="tactic">intros</span> <span class="id" type="tactic">until</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span> <span class="id" type="tactic">at</span> <span class="id" type="var">top</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X'</span> ⇒ <span class="id" type="tactic">subst</span> <span class="id" type="var">X'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simultaneous_rewrite</span> <span class="id" type="var">E</span> := <span class="id" type="var">specialize_with_evars_then_do</span> <span class="id" type="var">E</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">E</span> ⇒<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">E</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">T</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">_</span> : <span class="id" type="keyword">context</span>[?<span class="id" type="var">F</span>] |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> : <span class="id" type="var">T</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">F</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="var">simultaneous_rewrite'</span> <span class="id" type="var">E</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simultaneous_rewrite_rev</span> <span class="id" type="var">E</span> := <span class="id" type="var">specialize_with_evars_then_do</span> <span class="id" type="var">E</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">E</span> ⇒<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">E</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">T</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">_</span> : <span class="id" type="keyword">context</span>[?<span class="id" type="var">F</span>] |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> : <span class="id" type="var">T</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">F</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="var">simultaneous_rewrite_rev'</span> <span class="id" type="var">E</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">conv_rewrite_with</span> <span class="id" type="var">rew_tac</span> <span class="id" type="var">H</span> := <span class="id" type="var">specialize_with_evars_then_do</span> <span class="id" type="var">H</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span> ⇒ <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[?<span class="id" type="var">a'</span>] ] ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span> : <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">a'</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">change</span> <span class="id" type="var">a'</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="var">rew_tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">conv_rewrite_rev_with</span> <span class="id" type="var">rew_tac</span> <span class="id" type="var">H</span> := <span class="id" type="var">specialize_with_evars_then_do</span> <span class="id" type="var">H</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">a</span> ⇒ <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[?<span class="id" type="var">a'</span>] ] ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span> : <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">a'</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">change</span> <span class="id" type="var">a'</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="var">rew_tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">conv_rewrite</span> <span class="id" type="var">H</span> := <span class="id" type="var">conv_rewrite_with</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">h</span> ⇒ <span class="id" type="tactic">rewrite</span> <span class="id" type="var">h</span>) <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">conv_rewrite_rev</span> <span class="id" type="var">H</span> := <span class="id" type="var">conv_rewrite_rev_with</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">h</span> ⇒ <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">h</span>) <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">conv_repeat_rewrite</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">conv_rewrite_with</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">h</span> ⇒ <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">h</span>) <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">conv_repeat_rewrite_rev</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">conv_rewrite_rev_with</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">h</span> ⇒ <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">h</span>) <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_by_context</span> <span class="id" type="var">ctx</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">y</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">ctx'</span> := <span class="id" type="keyword">context</span> <span class="id" type="var">ctx</span>[<span class="id" type="var">x</span>] <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">ctx''</span> := <span class="id" type="keyword">context</span> <span class="id" type="var">ctx</span>[<span class="id" type="var">y</span>] <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> <span class="id" type="var">ctx'</span>; [ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span> |- *; <span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> <span class="id" type="var">ctx''</span>; [ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>; <span class="id" type="var">etransitivity</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rewrite_rev_by_context</span> <span class="id" type="var">ctx</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">y</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">ctx'</span> := <span class="id" type="keyword">context</span> <span class="id" type="var">ctx</span>[<span class="id" type="var">y</span>] <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">ctx''</span> := <span class="id" type="keyword">context</span> <span class="id" type="var">ctx</span>[<span class="id" type="var">x</span>] <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> <span class="id" type="var">ctx'</span>; [ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span> |- *; <span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> <span class="id" type="var">ctx''</span>; [ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>; <span class="id" type="var">etransitivity</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>; <span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">do_for_each_hyp'</span> <span class="id" type="var">tac</span> <span class="id" type="var">fail_if_seen</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">fail_if_seen</span> <span class="id" type="var">H</span>; <span class="id" type="var">tac</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">do_for_each_hyp'</span> <span class="id" type="var">tac</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H'</span> ⇒ <span class="id" type="var">fail_if_seen</span> <span class="id" type="var">H'</span>; <span class="id" type="keyword">match</span> <span class="id" type="var">H'</span> <span class="id" type="keyword">with</span> | <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">fail</span> 1 | <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span> <span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">do_for_each_hyp</span> <span class="id" type="var">tac</span> := <span class="id" type="var">do_for_each_hyp'</span> <span class="id" type="var">tac</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">idtac</span>).<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "change_in_all" <span class="id" type="keyword">constr</span>(<span class="id" type="var">from</span>) "with" <span class="id" type="keyword">constr</span>(<span class="id" type="var">to</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">change</span> <span class="id" type="var">from</span> <span class="id" type="keyword">with</span> <span class="id" type="var">to</span>; <span class="id" type="var">do_for_each_hyp</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> ⇒ <span class="id" type="tactic">change</span> <span class="id" type="var">from</span> <span class="id" type="keyword">with</span> <span class="id" type="var">to</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">expand</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" type="var">X</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">Y</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">X'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">Y'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Y</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">change</span> (<span class="id" type="var">X'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">Y'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" type="var">X</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">Y</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">X'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">Y'</span> := <span class="id" type="tactic">eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Y</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">change</span> (<span class="id" type="var">X'</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <span class="id" type="var">Y'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">simpl</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">x</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="keyword">match</span> <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">pf</span> ⇒ <span class="id" type="tactic">fail</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">generalize</span> <span class="id" type="var">pf</span>; <span class="id" type="tactic">intro</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "hideProofs" <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf</span>)<br/>
&nbsp;&nbsp;:= <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf</span>.<br/>
<span class="id" type="keyword">Tactic Notation</span> "hideProofs" <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf0</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf1</span>)<br/>
&nbsp;&nbsp;:= <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf0</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf1</span>).<br/>
<span class="id" type="keyword">Tactic Notation</span> "hideProofs" <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf0</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf1</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf2</span>)<br/>
&nbsp;&nbsp;:= <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf0</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf1</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf2</span>).<br/>
<span class="id" type="keyword">Tactic Notation</span> "hideProofs" <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf0</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf1</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf2</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf3</span>)<br/>
&nbsp;&nbsp;:= <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf0</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf1</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf2</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf3</span>).<br/>
<span class="id" type="keyword">Tactic Notation</span> "hideProofs" <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf0</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf1</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf2</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf3</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf4</span>)<br/>
&nbsp;&nbsp;:= <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf0</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf1</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf2</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf3</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf4</span>).<br/>
<span class="id" type="keyword">Tactic Notation</span> "hideProofs" <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf0</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf1</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf2</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf3</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf4</span>) <span class="id" type="keyword">constr</span>(<span class="id" type="var">pf5</span>)<br/>
&nbsp;&nbsp;:= <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf0</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf1</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf2</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf3</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf4</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">hideProof'</span> <span class="id" type="var">pf5</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_to_empty_set</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">T</span> → <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>, <span class="id" type="var">a</span> : ?<span class="id" type="var">T</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">destruct</span> (<span class="id" type="var">H</span> <span class="id" type="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="keyword">context</span>[<a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">assumption</span> ]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_to_empty_set_in_match</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">appcontext</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">x</span> <span class="id" type="keyword">with</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> || <span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">pose</span> <span class="id" type="var">x</span> <span class="id" type="keyword">as</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">_</span> : <span class="id" type="var">appcontext</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">x</span> <span class="id" type="keyword">with</span> <span class="id" type="keyword">end</span>] |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> || <span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">pose</span> <span class="id" type="var">x</span> <span class="id" type="keyword">as</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> ]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="unit"><span class="id" type="section">unit</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="unit_singleton"><span class="id" type="lemma">unit_singleton</span></a> (<span class="id" type="var">u</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a>) : <a class="idref" href="Homework6.html#u"><span class="id" type="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#tt"><span class="id" type="constructor">tt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">u</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="unit_eq"><span class="id" type="lemma">unit_eq</span></a> (<span class="id" type="var">u</span> <span class="id" type="var">u'</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a>) : <a class="idref" href="Homework6.html#u"><span class="id" type="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#u'"><span class="id" type="variable">u'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">u</span>; <span class="id" type="tactic">case</span> <span class="id" type="var">u'</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="unit_JMeq"><span class="id" type="lemma">unit_JMeq</span></a> (<span class="id" type="var">u</span> <span class="id" type="var">u'</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a>) : <a class="idref" href="Homework6.html#u"><span class="id" type="variable">u</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#u'"><span class="id" type="variable">u'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">u</span>; <span class="id" type="tactic">case</span> <span class="id" type="var">u'</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Empty_set_eq"><span class="id" type="lemma">Empty_set_eq</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>) : <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Empty_set_JMeql"><span class="id" type="lemma">Empty_set_JMeql</span></a> (<span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>) <span class="id" type="var">T</span> (<span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a>) : <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Empty_set_JMeqr"><span class="id" type="lemma">Empty_set_JMeqr</span></a> <span class="id" type="var">T</span> (<span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a>) (<span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>) : <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#unit"><span class="id" type="section">unit</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#unit_singleton"><span class="id" type="lemma">unit_singleton</span></a>.<br/>
<span class="id" type="keyword">Hint Extern</span> 0 (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#unit_eq"><span class="id" type="lemma">unit_eq</span></a>.<br/>
<span class="id" type="keyword">Hint Extern</span> 0 (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq"><span class="id" type="inductive">JMeq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a> <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a> <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#unit_JMeq"><span class="id" type="lemma">unit_JMeq</span></a>.<br/>
<span class="id" type="keyword">Hint Extern</span> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a> ⇒ <span class="id" type="tactic">constructor</span>.<br/>
<span class="id" type="keyword">Hint Extern</span> 0 (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Empty_set_eq"><span class="id" type="lemma">Empty_set_eq</span></a>.<br/>
<span class="id" type="keyword">Hint Extern</span> 0 (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq"><span class="id" type="inductive">JMeq</span></a> <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Empty_set_JMeql"><span class="id" type="lemma">Empty_set_JMeql</span></a>.<br/>
<span class="id" type="keyword">Hint Extern</span> 0 (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq"><span class="id" type="inductive">JMeq</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Empty_set_JMeqr"><span class="id" type="lemma">Empty_set_JMeqr</span></a>.<br/>

<br/>
</div>

<div class="doc">
In a dependently typed programming language like, Coq, it is more
    natural to define a separate set of edges for each pair of
    vertices.  I define both this type of graph and the one in the
    book, and define an almost-isomorphism between them.  It's
    actually only an isomorphism up to isomorphism of types; it
    requires univalence to be a proper isomorphism. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Record</span> <a name="Graph"><span class="id" type="record">Graph</span></a> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Vertex"><span class="id" type="projection">Vertex</span></a> :> <span class="id" type="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Edge"><span class="id" type="projection">Edge</span></a> : <a class="idref" href="Homework6.html#Vertex"><span class="id" type="method">Vertex</span></a> → <a class="idref" href="Homework6.html#Vertex"><span class="id" type="method">Vertex</span></a> → <span class="id" type="keyword">Type</span><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" type="keyword">Record</span> <a name="Graph'"><span class="id" type="record">Graph'</span></a> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Vertex'"><span class="id" type="projection">Vertex'</span></a> :> <span class="id" type="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Arrow'"><span class="id" type="projection">Arrow'</span></a> : <span class="id" type="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Graph'Source"><span class="id" type="projection">Graph'Source</span></a> : <a class="idref" href="Homework6.html#Arrow'"><span class="id" type="method">Arrow'</span></a> → <a class="idref" href="Homework6.html#Vertex'"><span class="id" type="method">Vertex'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Graph'Target"><span class="id" type="projection">Graph'Target</span></a> : <a class="idref" href="Homework6.html#Arrow'"><span class="id" type="method">Arrow'</span></a> → <a class="idref" href="Homework6.html#Vertex'"><span class="id" type="method">Vertex'</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="graph_equivalence"><span class="id" type="section">graph_equivalence</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="GraphToGraph'"><span class="id" type="definition">GraphToGraph'</span></a> (<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a>) : <a class="idref" href="Homework6.html#Graph'"><span class="id" type="record">Graph'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">Vertex'</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">Vertex</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">G</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">Arrow'</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">{</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sd</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">G</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">&times;</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">G</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">&amp;</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">Edge</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">G</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">fst</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sd</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">)</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">snd</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sd</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">)</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">};</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">Graph'Source</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sdm</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">fst</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">projT1</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sdm</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">));</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">Graph'Target</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sdm</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">snd</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">projT1</span></a> <a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">sdm</span></a><a class="idref" href="Homework6.html#Build_Graph'"><span class="id" type="constructor">))</span></a> |}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="Graph'ToGraph"><span class="id" type="definition">Graph'ToGraph</span></a> (<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Graph'"><span class="id" type="record">Graph'</span></a>) : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">Vertex</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">Vertex'</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">G</span></a><a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">Edge</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">s</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">d</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">{</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">m</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">Arrow'</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">G</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">|</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">Graph'Source</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">m</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">=</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">∧</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">Graph'Target</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">m</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">=</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">d</span></a> <a class="idref" href="Homework6.html#Build_Graph"><span class="id" type="constructor">})</span></a> |}.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#graph_equivalence"><span class="id" type="section">graph_equivalence</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab132"></a><h2 class="section">Graph Homomorphisms</h2>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="graph_homomorphisms"><span class="id" type="section">graph_homomorphisms</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Record</span> <a name="GraphHomomorphism"><span class="id" type="record">GraphHomomorphism</span></a> (<span class="id" type="var">G</span> <span class="id" type="var">G'</span> : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="OnVertices"><span class="id" type="projection">OnVertices</span></a> :> <a class="idref" href="Homework6.html#Vertex"><span class="id" type="projection">Vertex</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> → <a class="idref" href="Homework6.html#Vertex"><span class="id" type="projection">Vertex</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="OnEdges"><span class="id" type="projection">OnEdges</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">src</span> <span class="id" type="var">tgt</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Edge"><span class="id" type="projection">Edge</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#src"><span class="id" type="variable">src</span></a> <a class="idref" href="Homework6.html#tgt"><span class="id" type="variable">tgt</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#Edge"><span class="id" type="projection">Edge</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> (<a class="idref" href="Homework6.html#OnVertices"><span class="id" type="method">OnVertices</span></a> <a class="idref" href="Homework6.html#src"><span class="id" type="variable">src</span></a>) (<a class="idref" href="Homework6.html#OnVertices"><span class="id" type="method">OnVertices</span></a> <a class="idref" href="Homework6.html#tgt"><span class="id" type="variable">tgt</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="identity_graph_homomorphism"><span class="id" type="definition">identity_graph_homomorphism</span></a> (<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#GraphHomomorphism"><span class="id" type="record">GraphHomomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="compose_graph_homomorphisms"><span class="id" type="definition">compose_graph_homomorphisms</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">G</span> <span class="id" type="var">G'</span> <span class="id" type="var">G''</span> : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#GraphHomomorphism"><span class="id" type="record">GraphHomomorphism</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> <a class="idref" href="Homework6.html#G''"><span class="id" type="variable">G''</span></a> → <a class="idref" href="Homework6.html#GraphHomomorphism"><span class="id" type="record">GraphHomomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> → <a class="idref" href="Homework6.html#GraphHomomorphism"><span class="id" type="record">GraphHomomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G''"><span class="id" type="variable">G''</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">m1</span> (<span class="id" type="var">m2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">e</span> ⇒ <a class="idref" href="Homework6.html#OnEdges"><span class="id" type="projection">OnEdges</span></a> <span class="id" type="var">m1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#OnEdges"><span class="id" type="projection">OnEdges</span></a> <span class="id" type="var">m2</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="GraphHomomorphism_Eq"><span class="id" type="lemma">GraphHomomorphism_Eq</span></a> (<span class="id" type="var">G</span> <span class="id" type="var">G'</span> : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m</span> <span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#GraphHomomorphism"><span class="id" type="record">GraphHomomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a>)<br/>
&nbsp;&nbsp;: (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#OnVertices"><span class="id" type="projection">OnVertices</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#OnVertices"><span class="id" type="projection">OnVertices</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" type="keyword">∀</span> <span class="id" type="var">src</span> <span class="id" type="var">tgt</span> <span class="id" type="var">e</span>, <a class="idref" href="Homework6.html#OnEdges"><span class="id" type="projection">OnEdges</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#src"><span class="id" type="variable">src</span></a> <a class="idref" href="Homework6.html#tgt"><span class="id" type="variable">tgt</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#OnEdges"><span class="id" type="projection">OnEdges</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#src"><span class="id" type="variable">src</span></a> <a class="idref" href="Homework6.html#tgt"><span class="id" type="variable">tgt</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H1'</span> : <a class="idref" href="Homework6.html#OnVertices"><span class="id" type="projection">OnVertices</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#OnVertices"><span class="id" type="projection">OnVertices</span></a> <span class="id" type="var">m'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">assumption</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">m</span>, <span class="id" type="var">m'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">intro</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#graph_homomorphisms"><span class="id" type="section">graph_homomorphisms</span></a>.<br/>

<br/>
</div>

<div class="doc">
And now the version in the book 
</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="graph'_homomorphisms"><span class="id" type="section">graph'_homomorphisms</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Record</span> <a name="Graph'Homomorphism"><span class="id" type="record">Graph'Homomorphism</span></a> (<span class="id" type="var">G</span> <span class="id" type="var">G'</span> : <a class="idref" href="Homework6.html#Graph'"><span class="id" type="record">Graph'</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="OnVertices'"><span class="id" type="projection">OnVertices'</span></a> :> <a class="idref" href="Homework6.html#Vertex'"><span class="id" type="projection">Vertex'</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> → <a class="idref" href="Homework6.html#Vertex'"><span class="id" type="projection">Vertex'</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="OnArrows'"><span class="id" type="projection">OnArrows'</span></a> : <a class="idref" href="Homework6.html#Arrow'"><span class="id" type="projection">Arrow'</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> → <a class="idref" href="Homework6.html#Arrow'"><span class="id" type="projection">Arrow'</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SourceCommutes'"><span class="id" type="projection">SourceCommutes'</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#OnVertices'"><span class="id" type="method">OnVertices'</span></a> (<a class="idref" href="Homework6.html#Graph'Source"><span class="id" type="projection">Graph'Source</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Graph'Source"><span class="id" type="projection">Graph'Source</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> (<a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="method">OnArrows'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="TargetCommutes'"><span class="id" type="projection">TargetCommutes'</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#OnVertices'"><span class="id" type="method">OnVertices'</span></a> (<a class="idref" href="Homework6.html#Graph'Target"><span class="id" type="projection">Graph'Target</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Graph'Target"><span class="id" type="projection">Graph'Target</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> (<a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="method">OnArrows'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="identity_graph'_homomorphism"><span class="id" type="definition">identity_graph'_homomorphism</span></a> (<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Graph'"><span class="id" type="record">Graph'</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#Graph'Homomorphism"><span class="id" type="record">Graph'Homomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="compose_graph'_homomorphisms"><span class="id" type="definition">compose_graph'_homomorphisms</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">G</span> <span class="id" type="var">G'</span> <span class="id" type="var">G''</span> : <a class="idref" href="Homework6.html#Graph'"><span class="id" type="record">Graph'</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#Graph'Homomorphism"><span class="id" type="record">Graph'Homomorphism</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> <a class="idref" href="Homework6.html#G''"><span class="id" type="variable">G''</span></a> → <a class="idref" href="Homework6.html#Graph'Homomorphism"><span class="id" type="record">Graph'Homomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a> → <a class="idref" href="Homework6.html#Graph'Homomorphism"><span class="id" type="record">Graph'Homomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G''"><span class="id" type="variable">G''</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">m1</span> (<span class="id" type="var">m2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="projection">OnArrows'</span></a> <span class="id" type="var">m1</span> (<a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="projection">OnArrows'</span></a> <span class="id" type="var">m2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#SourceCommutes'"><span class="id" type="projection">SourceCommutes'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#TargetCommutes'"><span class="id" type="projection">TargetCommutes'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Graph'Homomorphism_Eq"><span class="id" type="lemma">Graph'Homomorphism_Eq</span></a> (<span class="id" type="var">G</span> <span class="id" type="var">G'</span> : <a class="idref" href="Homework6.html#Graph'"><span class="id" type="record">Graph'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m</span> <span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#Graph'Homomorphism"><span class="id" type="record">Graph'Homomorphism</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#G'"><span class="id" type="variable">G'</span></a>)<br/>
&nbsp;&nbsp;: (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#OnVertices'"><span class="id" type="projection">OnVertices'</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#OnVertices'"><span class="id" type="projection">OnVertices'</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="projection">OnArrows'</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="projection">OnArrows'</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H1'</span> : <a class="idref" href="Homework6.html#OnVertices'"><span class="id" type="projection">OnVertices'</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#OnVertices'"><span class="id" type="projection">OnVertices'</span></a> <span class="id" type="var">m'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H2'</span> : <a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="projection">OnArrows'</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#OnArrows'"><span class="id" type="projection">OnArrows'</span></a> <span class="id" type="var">m'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">m</span>, <span class="id" type="var">m'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#graph'_homomorphisms"><span class="id" type="section">graph'_homomorphisms</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab133"></a><h1 class="section">Functions</h1>

</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="compose"><span class="id" type="definition">compose</span></a> <span class="id" type="var">X</span> <span class="id" type="var">Y</span> <span class="id" type="var">Z</span> (<span class="id" type="var">f</span> : <a class="idref" href="Homework6.html#Y"><span class="id" type="variable">Y</span></a> → <a class="idref" href="Homework6.html#Z"><span class="id" type="variable">Z</span></a>) (<span class="id" type="var">g</span> : <a class="idref" href="Homework6.html#X"><span class="id" type="variable">X</span></a> → <a class="idref" href="Homework6.html#Y"><span class="id" type="variable">Y</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">&lambda;</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> (<a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#compose"><span class="id" type="definition">compose</span></a> [<span class="id" type="var">X</span> <span class="id" type="var">Y</span> <span class="id" type="var">Z</span>] <span class="id" type="var">f</span> <span class="id" type="var">g</span> <span class="id" type="var">x</span> / .<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name="::x_'o'_x"><span class="id" type="notation">"</span></a>&#x25cb;" := (@<a class="idref" href="Homework6.html#compose"><span class="id" type="definition">compose</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab134"></a><h1 class="section">Isomorphism</h1>

</div>
<div class="code">
<span class="id" type="keyword">Record</span> <a name="is_isomorphism"><span class="id" type="record">is_isomorphism</span></a> <span class="id" type="var">X</span> <span class="id" type="var">Y</span> (<span class="id" type="var">f</span> : <a class="idref" href="Homework6.html#X"><span class="id" type="variable">X</span></a> → <a class="idref" href="Homework6.html#Y"><span class="id" type="variable">Y</span></a>) :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="isomorphism_inverse"><span class="id" type="projection">isomorphism_inverse</span></a> : <a class="idref" href="Homework6.html#Y"><span class="id" type="variable">Y</span></a> → <a class="idref" href="Homework6.html#X"><span class="id" type="variable">X</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="isomorphism_right_inverse"><span class="id" type="projection">isomorphism_right_inverse</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, (<a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#isomorphism_inverse"><span class="id" type="method">isomorphism_inverse</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">&lambda;</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="isomorphism_left_inverse"><span class="id" type="projection">isomorphism_left_inverse</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, (<a class="idref" href="Homework6.html#isomorphism_inverse"><span class="id" type="method">isomorphism_inverse</span></a> <a class="idref" href="Homework6.html#::x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">&lambda;</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" type="keyword">Notation</span></span> <span class="inlinecode">"<a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a></span> <span class="inlinecode"><span class="id" type="var"><sup>-1</sup></span>"</span> <span class="inlinecode">:=</span> <span class="inlinecode">(<a class="idref" href="Isomorphism.html#isomorphism_inverse"><span class="id" type="projection">isomorphism_inverse</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a>)</span> <span class="inlinecode">(<span class="id" type="tactic">at</span></span> <span class="inlinecode"><span class="id" type="keyword">level</span></span> <span class="inlinecode">10).</span> 
</div>
<div class="code">

<br/>

<br/>
<span class="id" type="keyword">Record</span> <a name="isomorphic"><span class="id" type="record">isomorphic</span></a> <span class="id" type="var">X</span> <span class="id" type="var">Y</span> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="isomorphic_morphism"><span class="id" type="projection">isomorphic_morphism</span></a> :> <a class="idref" href="Homework6.html#X"><span class="id" type="variable">X</span></a> → <a class="idref" href="Homework6.html#Y"><span class="id" type="variable">Y</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="isomorphic_is_isomorphism"><span class="id" type="projection">isomorphic_is_isomorphism</span></a> :> <a class="idref" href="Homework6.html#is_isomorphism"><span class="id" type="record">is_isomorphism</span></a> <a class="idref" href="Homework6.html#isomorphic_morphism"><span class="id" type="method">isomorphic_morphism</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" type="keyword">Hint Resolve</span> <a class="idref" href="Homework6.html#isomorphic_is_isomorphism"><span class="id" type="projection">isomorphic_is_isomorphism</span></a>.<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name=":type_scope:x_'≅'_x"><span class="id" type="notation">"</span></a>&cong;" := (<a class="idref" href="Homework6.html#isomorphic"><span class="id" type="record">isomorphic</span></a>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70) : <span class="id" type="var">type_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="isomorphic_eq"><span class="id" type="lemma">isomorphic_eq</span></a> <span class="id" type="var">X</span> <span class="id" type="var">Y</span> (<span class="id" type="var">f</span> <span class="id" type="var">g</span> : <a class="idref" href="Homework6.html#X"><span class="id" type="variable">X</span></a> <a class="idref" href="Homework6.html#:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#Y"><span class="id" type="variable">Y</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="Homework6.html#isomorphic_morphism"><span class="id" type="projection">isomorphic_morphism</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#isomorphic_morphism"><span class="id" type="projection">isomorphic_morphism</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#isomorphism_inverse"><span class="id" type="projection">isomorphism_inverse</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#isomorphism_inverse"><span class="id" type="projection">isomorphism_inverse</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">f</span> <span class="id" type="keyword">as</span> [ ? [ ] ], <span class="id" type="var">g</span> <span class="id" type="keyword">as</span> [ ? [ ] ]; <span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="relation"><span class="id" type="abbreviation">relation</span></a> <span class="id" type="var">A</span> := (<span class="id" type="var">A</span> → <span class="id" type="var">A</span> → <span class="id" type="keyword">Type</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Reflexive"><span class="id" type="definition">Reflexive</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">R</span> : <a class="idref" href="Homework6.html#relation"><span class="id" type="abbreviation">relation</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) := <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Definition</span> <a name="Symmetric"><span class="id" type="definition">Symmetric</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">R</span> : <a class="idref" href="Homework6.html#relation"><span class="id" type="abbreviation">relation</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) := <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Definition</span> <a name="Transitive"><span class="id" type="definition">Transitive</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">R</span> : <a class="idref" href="Homework6.html#relation"><span class="id" type="abbreviation">relation</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) := <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>, <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#z"><span class="id" type="variable">z</span></a> → <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#z"><span class="id" type="variable">z</span></a>.<br/>

<br/>
<span class="id" type="keyword">Record</span> <a name="Equivalence"><span class="id" type="record">Equivalence</span></a> {<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>} (<span class="id" type="var">R</span> : <a class="idref" href="Homework6.html#relation"><span class="id" type="abbreviation">relation</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>)<br/>
&nbsp;&nbsp;:= <a name="Build_Equivalence"><span class="id" type="constructor">Build_Equivalence</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <a name="Equivalence_Reflexive"><span class="id" type="projection">Equivalence_Reflexive</span></a> : <a class="idref" href="Homework6.html#Reflexive"><span class="id" type="definition">Reflexive</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="Equivalence_Symmetric"><span class="id" type="projection">Equivalence_Symmetric</span></a> : <a class="idref" href="Homework6.html#Symmetric"><span class="id" type="definition">Symmetric</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="Equivalence_Transitive"><span class="id" type="projection">Equivalence_Transitive</span></a> : <a class="idref" href="Homework6.html#Transitive"><span class="id" type="definition">Transitive</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> }.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="isomorphic_relation"><span class="id" type="section">isomorphic_relation</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ ? [] ]; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="isomorphic_reflexive"><span class="id" type="definition">isomorphic_reflexive</span></a> : <a class="idref" href="Homework6.html#Reflexive"><span class="id" type="definition">Reflexive</span></a> <a class="idref" href="Homework6.html#isomorphic"><span class="id" type="record">isomorphic</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">&lambda;</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">&lambda;</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#::'λ'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="isomorphic_symmetric"><span class="id" type="definition">isomorphic_symmetric</span></a> : <a class="idref" href="Homework6.html#Symmetric"><span class="id" type="definition">Symmetric</span></a> <a class="idref" href="Homework6.html#isomorphic"><span class="id" type="record">isomorphic</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eexists</span> (<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#::x_'⁻¹'"><span class="id" type="notation"><sup>-1</sup></span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">f</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="isomorphic_transitive"><span class="id" type="definition">isomorphic_transitive</span></a> : <a class="idref" href="Homework6.html#Transitive"><span class="id" type="definition">Transitive</span></a> <a class="idref" href="Homework6.html#isomorphic"><span class="id" type="record">isomorphic</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="var">g</span> <a class="idref" href="Homework6.html#::x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="var">f</span> <a class="idref" href="Homework6.html#::x_'⁻¹'"><span class="id" type="notation"><sup>-1</sup></span></a> <a class="idref" href="Homework6.html#::x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">g</span> <a class="idref" href="Homework6.html#::x_'⁻¹'"><span class="id" type="notation"><sup>-1</sup></span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#isomorphic_relation"><span class="id" type="section">isomorphic_relation</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#isomorphic_reflexive"><span class="id" type="definition">isomorphic_reflexive</span></a> @<a class="idref" href="Homework6.html#isomorphic_symmetric"><span class="id" type="definition">isomorphic_symmetric</span></a>.<br/>
<span class="id" type="keyword">Hint Immediate</span> @<a class="idref" href="Homework6.html#isomorphic_reflexive"><span class="id" type="definition">isomorphic_reflexive</span></a> @<a class="idref" href="Homework6.html#isomorphic_symmetric"><span class="id" type="definition">isomorphic_symmetric</span></a> @<a class="idref" href="Homework6.html#isomorphic_transitive"><span class="id" type="definition">isomorphic_transitive</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab135"></a><h1 class="section">Categories</h1>
 We include the object type as a parameter, because, otherwise, we
    can't make a category of categories easily. 
</div>
<div class="code">
<span class="id" type="keyword">Record</span> <a name="Category"><span class="id" type="record">Category</span></a> {<span class="id" type="var">obj</span> : <span class="id" type="keyword">Type</span>} :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Object</span> :> <span class="id" type="var">_</span> := <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Morphism"><span class="id" type="projection">Morphism</span></a> : <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a> → <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a> → <span class="id" type="keyword">Type</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Identity"><span class="id" type="projection">Identity</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Compose"><span class="id" type="projection">Compose</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span>, <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> → <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Associativity"><span class="id" type="projection">Associativity</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">o1</span> <span class="id" type="var">o2</span> <span class="id" type="var">o3</span> <span class="id" type="var">o4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m1</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#o1"><span class="id" type="variable">o1</span></a> <a class="idref" href="Homework6.html#o2"><span class="id" type="variable">o2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m2</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#o2"><span class="id" type="variable">o2</span></a> <a class="idref" href="Homework6.html#o3"><span class="id" type="variable">o3</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m3</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#o3"><span class="id" type="variable">o3</span></a> <a class="idref" href="Homework6.html#o4"><span class="id" type="variable">o4</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Compose"><span class="id" type="method">Compose</span></a> (<a class="idref" href="Homework6.html#Compose"><span class="id" type="method">Compose</span></a> <a class="idref" href="Homework6.html#m3"><span class="id" type="variable">m3</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a>) <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Compose"><span class="id" type="method">Compose</span></a> <a class="idref" href="Homework6.html#m3"><span class="id" type="variable">m3</span></a> (<a class="idref" href="Homework6.html#Compose"><span class="id" type="method">Compose</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> (<span class="id" type="var">f</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>), <a class="idref" href="Homework6.html#Compose"><span class="id" type="method">Compose</span></a> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="method">Identity</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>) <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="RightIdentity"><span class="id" type="projection">RightIdentity</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> (<span class="id" type="var">f</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="method">Morphism</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>), <a class="idref" href="Homework6.html#Compose"><span class="id" type="method">Compose</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="method">Identity</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" type="keyword">Delimit</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">category_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Delimit</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">object_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">object</span>.<br/>
<span class="id" type="keyword">Delimit</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">morphism_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>.<br/>

<br/>
<span class="id" type="keyword">Bind</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">category_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">Category</span>.<br/>
<span class="id" type="keyword">Bind</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">object_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">Object</span>.<br/>
<span class="id" type="keyword">Bind</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">morphism_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">Morphism</span>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#Object"><span class="id" type="projection">Object</span></a> {<span class="id" type="var">obj</span>%<span class="id" type="var">type</span>} <span class="id" type="var">C</span>%<span class="id" type="var">category</span> : <span class="id" type="tactic">rename</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> {<span class="id" type="var">obj</span>%<span class="id" type="var">type</span>} <span class="id" type="var">C</span>%<span class="id" type="var">category</span> <span class="id" type="var">s</span>%<span class="id" type="var">object</span> <span class="id" type="var">d</span>%<span class="id" type="var">object</span> : <span class="id" type="tactic">rename</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> {<span class="id" type="var">obj</span>%<span class="id" type="var">type</span>} [<span class="id" type="var">C</span>%<span class="id" type="var">category</span>] <span class="id" type="var">x</span>%<span class="id" type="var">object</span> : <span class="id" type="tactic">rename</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#Compose"><span class="id" type="projection">Compose</span></a> {<span class="id" type="var">obj</span>%<span class="id" type="var">type</span>} [<span class="id" type="var">C</span>%<span class="id" type="var">category</span> <span class="id" type="var">s</span>%<span class="id" type="var">object</span> <span class="id" type="var">d</span>%<span class="id" type="var">object</span> <span class="id" type="var">d'</span>%<span class="id" type="var">object</span>] <span class="id" type="var">m1</span>%<span class="id" type="var">morphism</span> <span class="id" type="var">m2</span>%<span class="id" type="var">morphism</span> : <span class="id" type="tactic">rename</span>.<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name=":morphism_scope:x_'o'_x"><span class="id" type="notation">"</span></a>&#x25cb;" := (@<a class="idref" href="Homework6.html#Compose"><span class="id" type="projection">Compose</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) : <span class="id" type="var">morphism_scope</span>.<br/>

<br/>
<span class="id" type="var">Create</span> <span class="id" type="var">HintDb</span> <span class="id" type="var">category</span> <span class="id" type="var">discriminated</span>.<br/>
<span class="id" type="var">Create</span> <span class="id" type="var">HintDb</span> <span class="id" type="var">morphism</span> <span class="id" type="var">discriminated</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a> @<a class="idref" href="Homework6.html#RightIdentity"><span class="id" type="projection">RightIdentity</span></a> @<a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a> @<a class="idref" href="Homework6.html#RightIdentity"><span class="id" type="projection">RightIdentity</span></a> @<a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> : <span class="id" type="var">morphism</span>.<br/>
<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a> @<a class="idref" href="Homework6.html#RightIdentity"><span class="id" type="projection">RightIdentity</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a> @<a class="idref" href="Homework6.html#RightIdentity"><span class="id" type="projection">RightIdentity</span></a> : <span class="id" type="var">morphism</span>.<br/>

<br/>
</div>

<div class="doc">
We create aliases for categories, calling them small and locally
    small in accordance with mathematical terminology.   
</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="LocallySmallCategory"><span class="id" type="definition">LocallySmallCategory</span></a> {<span class="id" type="var">obj</span> : <span class="id" type="keyword">Type</span>}  := @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a>.<br/>
<span class="id" type="keyword">Definition</span> <a name="SmallCategory"><span class="id" type="definition">SmallCategory</span></a> {<span class="id" type="var">obj</span> : <span class="id" type="keyword">Set</span>}  := @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a>.<br/>
<span class="id" type="keyword">Identity</span> <span class="id" type="keyword">Coercion</span> <span class="id" type="var">LocallySmallCategory_Category_Id</span><br/>
: <span class="id" type="var">LocallySmallCategory</span> &gt;-&gt; <span class="id" type="var">Category</span>.<br/>
<span class="id" type="keyword">Identity</span> <span class="id" type="keyword">Coercion</span> <span class="id" type="var">SmallCategory_LocallySmallCategory_Id</span><br/>
: <span class="id" type="var">SmallCategory</span> &gt;-&gt; <span class="id" type="var">Category</span>.<br/>

<br/>
</div>

<div class="doc">
We use the dependently typed formulation of graphs 
</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="path"><span class="id" type="section">path</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="path.V"><span class="id" type="variable">V</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="path.E"><span class="id" type="variable">E</span></a> : <a class="idref" href="Homework6.html#path.V"><span class="id" type="variable">V</span></a> → <a class="idref" href="Homework6.html#path.V"><span class="id" type="variable">V</span></a> → <span class="id" type="keyword">Type</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="path"><span class="id" type="inductive">path</span></a> (<span class="id" type="var">s</span> : <a class="idref" href="Homework6.html#path.V"><span class="id" type="variable">V</span></a>) : <a class="idref" href="Homework6.html#path.V"><span class="id" type="variable">V</span></a> → <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="NoEdges"><span class="id" type="constructor">NoEdges</span></a> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <span class="id" type="var">s</span> <span class="id" type="var">s</span><br/>
&nbsp;&nbsp;| <a name="AddEdge"><span class="id" type="constructor">AddEdge</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span>, <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <span class="id" type="var">s</span> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#path.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> → <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <span class="id" type="var">s</span> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="prepend"><span class="id" type="definition">prepend</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <span class="id" type="keyword">∀</span> <span class="id" type="var">s'</span>, <a class="idref" href="Homework6.html#path.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> → <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">E'</span> ⇒ <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> (<a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> <span class="id" type="var">_</span>) <a class="idref" href="Homework6.html#E'"><span class="id" type="variable">E'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p'</span> <span class="id" type="var">E</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">E'</span> ⇒ <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> (<a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> <span class="id" type="var">p'</span> <a class="idref" href="Homework6.html#E'"><span class="id" type="variable">E'</span></a>) <span class="id" type="var">E</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="concatenate"><span class="id" type="definition">concatenate</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">p'</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>) : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> ⇒ <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p'</span> <span class="id" type="var">E</span> ⇒ <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> (<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a>) <span class="id" type="var">E</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="concatenate'"><span class="id" type="definition">concatenate'</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <span class="id" type="keyword">∀</span> <span class="id" type="var">d'</span>, <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> → <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">p'</span> ⇒ <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">E</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">p'</span> ⇒ <a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <span class="id" type="var">E</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="path.typeOf"><span class="id" type="variable">typeOf</span></a> : <a class="idref" href="Homework6.html#path.V"><span class="id" type="variable">V</span></a> → <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="path.functionOf"><span class="id" type="variable">functionOf</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>, <a class="idref" href="Homework6.html#path.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#path.typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> → <a class="idref" href="Homework6.html#path.typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="compose_path"><span class="id" type="definition">compose_path</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#path.typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> → <a class="idref" href="Homework6.html#path.typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p'</span> <span class="id" type="var">E</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#path.functionOf"><span class="id" type="variable">functionOf</span></a> <span class="id" type="var">E</span> (<a class="idref" href="Homework6.html#compose_path"><span class="id" type="definition">compose_path</span></a> <span class="id" type="var">p'</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#path"><span class="id" type="section">path</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> [<span class="id" type="var">V</span> <span class="id" type="var">E</span> <span class="id" type="var">s</span>].<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> [<span class="id" type="var">V</span> <span class="id" type="var">E</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span>] <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> [<span class="id" type="var">V</span> <span class="id" type="var">E</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>] <span class="id" type="var">p</span> [<span class="id" type="var">s'</span>] <span class="id" type="var">p'</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="path_Theorems"><span class="id" type="section">path_Theorems</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="path_Theorems.V"><span class="id" type="variable">V</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="path_Theorems.E"><span class="id" type="variable">E</span></a> : <a class="idref" href="Homework6.html#path_Theorems.V"><span class="id" type="variable">V</span></a> → <a class="idref" href="Homework6.html#path_Theorems.V"><span class="id" type="variable">V</span></a> → <span class="id" type="keyword">Type</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_noedges_p"><span class="id" type="lemma">concatenate_noedges_p</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_p_noedges"><span class="id" type="lemma">concatenate_p_noedges</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate'_p_addedge"><span class="id" type="lemma">concatenate'_p_addedge</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> <span class="id" type="var">d''</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p'</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> <a class="idref" href="Homework6.html#d''"><span class="id" type="variable">d''</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> (<a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a>) <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#concatenate'_p_addedge"><span class="id" type="lemma">concatenate'_p_addedge</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate'_p_noedges"><span class="id" type="lemma">concatenate'_p_noedges</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate'_noedges_p"><span class="id" type="lemma">concatenate'_noedges_p</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#concatenate'_p_noedges"><span class="id" type="lemma">concatenate'_p_noedges</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_addedge_concatenate'_prepend"><span class="id" type="lemma">concatenate_addedge_concatenate'_prepend</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'0</span> <span class="id" type="var">d'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'0"><span class="id" type="variable">d'0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p'</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d'0"><span class="id" type="variable">d'0</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> (<a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>) <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p'</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Resolve</span> <a class="idref" href="Homework6.html#concatenate_noedges_p"><span class="id" type="lemma">concatenate_noedges_p</span></a> <a class="idref" href="Homework6.html#concatenate_addedge_concatenate'_prepend"><span class="id" type="lemma">concatenate_addedge_concatenate'_prepend</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_concatenate'_equivalent"><span class="id" type="lemma">concatenate_concatenate'_equivalent</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p'</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#concatenate'"><span class="id" type="definition">concatenate'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#concatenate_noedges_p"><span class="id" type="lemma">concatenate_noedges_p</span></a> <a class="idref" href="Homework6.html#concatenate_addedge_concatenate'_prepend"><span class="id" type="lemma">concatenate_addedge_concatenate'_prepend</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> &lt;- <a class="idref" href="Homework6.html#concatenate_concatenate'_equivalent"><span class="id" type="lemma">concatenate_concatenate'_equivalent</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_p_addedge"><span class="id" type="lemma">concatenate_p_addedge</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> <span class="id" type="var">d''</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p'</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> <a class="idref" href="Homework6.html#d''"><span class="id" type="variable">d''</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> (<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a>) <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_prepend_p"><span class="id" type="lemma">concatenate_prepend_p</span></a> <span class="id" type="var">s</span> <span class="id" type="var">s'</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p1</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p2</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> (<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a>) <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> (<a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>) <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p1</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#concatenate_prepend_p"><span class="id" type="lemma">concatenate_prepend_p</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="concatenate_associative"><span class="id" type="lemma">concatenate_associative</span></a> <span class="id" type="var">o1</span> <span class="id" type="var">o2</span> <span class="id" type="var">o3</span> <span class="id" type="var">o4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p1</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#o1"><span class="id" type="variable">o1</span></a> <a class="idref" href="Homework6.html#o2"><span class="id" type="variable">o2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p2</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#o2"><span class="id" type="variable">o2</span></a> <a class="idref" href="Homework6.html#o3"><span class="id" type="variable">o3</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p3</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#o3"><span class="id" type="variable">o3</span></a> <a class="idref" href="Homework6.html#o4"><span class="id" type="variable">o4</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> (<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a>) <a class="idref" href="Homework6.html#p3"><span class="id" type="variable">p3</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p1"><span class="id" type="variable">p1</span></a> (<a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p2"><span class="id" type="variable">p2</span></a> <a class="idref" href="Homework6.html#p3"><span class="id" type="variable">p3</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p1</span>; <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="compose_path_addedge"><span class="id" type="lemma">compose_path_addedge</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>) <span class="id" type="var">typeOf</span> <span class="id" type="var">functionOf</span><br/>
&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#compose_path"><span class="id" type="definition">compose_path</span></a> <a class="idref" href="Homework6.html#typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#functionOf"><span class="id" type="variable">functionOf</span></a> (<a class="idref" href="Homework6.html#AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#functionOf"><span class="id" type="variable">functionOf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a> (<a class="idref" href="Homework6.html#compose_path"><span class="id" type="definition">compose_path</span></a> <a class="idref" href="Homework6.html#typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#functionOf"><span class="id" type="variable">functionOf</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t_with</span> <span class="id" type="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="compose_path_prepend"><span class="id" type="lemma">compose_path_prepend</span></a> <span class="id" type="var">s'</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#path_Theorems.E"><span class="id" type="variable">E</span></a> <a class="idref" href="Homework6.html#s'"><span class="id" type="variable">s'</span></a> <span class="id" type="var">_</span>) <span class="id" type="var">typeOf</span> <span class="id" type="var">functionOf</span><br/>
&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#compose_path"><span class="id" type="definition">compose_path</span></a> <a class="idref" href="Homework6.html#typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#functionOf"><span class="id" type="variable">functionOf</span></a> (<a class="idref" href="Homework6.html#prepend"><span class="id" type="definition">prepend</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#compose_path"><span class="id" type="definition">compose_path</span></a> <a class="idref" href="Homework6.html#typeOf"><span class="id" type="variable">typeOf</span></a> <a class="idref" href="Homework6.html#functionOf"><span class="id" type="variable">functionOf</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Homework6.html#functionOf"><span class="id" type="variable">functionOf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>; <span class="id" type="var">t_with</span> <span class="id" type="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#path_Theorems"><span class="id" type="section">path_Theorems</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#compose_path_prepend"><span class="id" type="lemma">compose_path_prepend</span></a> <a class="idref" href="Homework6.html#compose_path_addedge"><span class="id" type="lemma">compose_path_addedge</span></a>.<br/>
<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#concatenate_p_noedges"><span class="id" type="lemma">concatenate_p_noedges</span></a> <a class="idref" href="Homework6.html#concatenate_noedges_p"><span class="id" type="lemma">concatenate_noedges_p</span></a>.<br/>
<span class="id" type="keyword">Hint Resolve</span> <a class="idref" href="Homework6.html#concatenate_p_noedges"><span class="id" type="lemma">concatenate_p_noedges</span></a> <a class="idref" href="Homework6.html#concatenate_noedges_p"><span class="id" type="lemma">concatenate_noedges_p</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="PathsOf"><span class="id" type="definition">PathsOf</span></a> (<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Graph"><span class="id" type="record">Graph</span></a>)<br/>
&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">sd</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#:type_scope:x_'×'_x"><span class="id" type="notation">&times;</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> @<a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> (<a class="idref" href="Homework6.html#Edge"><span class="id" type="projection">Edge</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <span class="id" type="var">sd</span>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">sd</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">}</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab136"></a><h1 class="section">Category of Paths</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <a name="PathsCategory"><span class="id" type="section">PathsCategory</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="PathsCategory.V"><span class="id" type="variable">V</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="PathsCategory.E"><span class="id" type="variable">E</span></a> : <a class="idref" href="Homework6.html#PathsCategory.V"><span class="id" type="variable">V</span></a> → <a class="idref" href="Homework6.html#PathsCategory.V"><span class="id" type="variable">V</span></a> → <span class="id" type="keyword">Type</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Immediate</span> <a class="idref" href="Homework6.html#concatenate_associative"><span class="id" type="lemma">concatenate_associative</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> <a class="idref" href="Homework6.html#concatenate_associative"><span class="id" type="lemma">concatenate_associative</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="PathsCategory"><span class="id" type="definition">PathsCategory</span></a> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#PathsCategory.V"><span class="id" type="variable">V</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (@<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Build_Category</span></a> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="Homework6.html#path"><span class="id" type="inductive">path</span></a> <a class="idref" href="Homework6.html#PathsCategory.V"><span class="id" type="variable">V</span></a> <a class="idref" href="Homework6.html#PathsCategory.E"><span class="id" type="variable">E</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="Homework6.html#NoEdges"><span class="id" type="constructor">NoEdges</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">p'</span> ⇒ <a class="idref" href="Homework6.html#concatenate"><span class="id" type="definition">concatenate</span></a> <a class="idref" href="Homework6.html#p'"><span class="id" type="variable">p'</span></a> <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="var">t_with</span> <span class="id" type="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#PathsCategory"><span class="id" type="section">PathsCategory</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab137"></a><h1 class="section">Discrete Category</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="DiscreteCategory"><span class="id" type="section">DiscreteCategory</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="DiscreteCategory.O"><span class="id" type="variable">O</span></a> : <span class="id" type="keyword">Type</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_eq</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">subst_body</span>; <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">destruct_type</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#inhabited"><span class="id" type="inductive">inhabited</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_transitivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="DiscreteCategory.DiscreteCategory_Morphism"><span class="id" type="variable">DiscreteCategory_Morphism</span></a> (<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#DiscreteCategory.O"><span class="id" type="variable">O</span></a>) := <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="DiscreteCategory_Compose"><span class="id" type="definition">DiscreteCategory_Compose</span></a> (<span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> : <a class="idref" href="Homework6.html#DiscreteCategory.O"><span class="id" type="variable">O</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#DiscreteCategory.DiscreteCategory_Morphism"><span class="id" type="variable">DiscreteCategory_Morphism</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#DiscreteCategory.DiscreteCategory_Morphism"><span class="id" type="variable">DiscreteCategory_Morphism</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#DiscreteCategory.DiscreteCategory_Morphism"><span class="id" type="variable">DiscreteCategory_Morphism</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="DiscreteCategory_Identity"><span class="id" type="definition">DiscreteCategory_Identity</span></a> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#DiscreteCategory.DiscreteCategory_Morphism"><span class="id" type="variable">DiscreteCategory_Morphism</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#DiscreteCategory_Compose"><span class="id" type="definition">DiscreteCategory_Compose</span></a> [<span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span>] <span class="id" type="var">m</span> <span class="id" type="var">m'</span> /.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#DiscreteCategory_Identity"><span class="id" type="definition">DiscreteCategory_Identity</span></a> <span class="id" type="var">x</span> /.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#DiscreteCategory.O"><span class="id" type="variable">O</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (@<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Build_Category</span></a> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#DiscreteCategory.DiscreteCategory_Morphism"><span class="id" type="variable">DiscreteCategory_Morphism</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#DiscreteCategory_Identity"><span class="id" type="definition">DiscreteCategory_Identity</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#DiscreteCategory_Compose"><span class="id" type="definition">DiscreteCategory_Compose</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Homework6.html#DiscreteCategory_Compose"><span class="id" type="definition">DiscreteCategory_Compose</span></a>, <a class="idref" href="Homework6.html#DiscreteCategory_Identity"><span class="id" type="definition">DiscreteCategory_Identity</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="section">DiscreteCategory</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab138"></a><h1 class="section">Functors</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <a name="Functors"><span class="id" type="section">Functors</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">D</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objD</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">morphism_scope</span>.<br/>

<br/>
</div>

<div class="doc">
     Quoting from the lecture notes for 18.705, Commutative Algebra:

<div class="paragraph"> </div>

     A map of categories is known as a functor. Namely, given
     categories <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> and <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C'"><span class="id" type="variable">C'</span></a></span>, a (covariant) functor <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C'"><span class="id" type="variable">C'</span></a></span> is a rule that assigns to
     each object <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> of <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> an object <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> of <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C'"><span class="id" type="variable">C'</span></a></span> and to each map <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_3_2.html#Exercise_4_2_3_2_continuity_bad.B"><span class="id" type="constructor">B</span></a></span> of <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> a map
     <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_3_2.html#Exercise_4_2_3_2_continuity_bad.B"><span class="id" type="constructor">B</span></a></span> of <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C'"><span class="id" type="variable">C'</span></a></span> preserving composition and identity; that is,

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode">(<a class="idref" href="CategoryIsomorphisms.html#m'"><span class="id" type="variable">m'</span></a></span> <span class="inlinecode">○</span> <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m"><span class="id" type="variable">m</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode">(<a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m'"><span class="id" type="variable">m'</span></a>)</span> <span class="inlinecode">○</span> <span class="inlinecode">(<a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m"><span class="id" type="variable">m</span></a>)</span> for maps <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_3_2.html#Exercise_4_2_3_2_continuity_bad.B"><span class="id" type="constructor">B</span></a></span> and <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m'"><span class="id" type="variable">m'</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_3_2.html#Exercise_4_2_3_2_continuity_bad.B"><span class="id" type="constructor">B</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> of <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span>, and

</li>
<li> <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode">(<a class="idref" href="Monoid.html#id"><span class="id" type="projection">id</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Monoid.html#id"><span class="id" type="projection">id</span></a></span> <span class="inlinecode">(<a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a>)</span> for any object <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> of <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span>, where <span class="inlinecode"><a class="idref" href="Monoid.html#id"><span class="id" type="projection">id</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> is the identity morphism of <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span>.

</li>
</ul>
     
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Record</span> <a name="Functor"><span class="id" type="record">Functor</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ObjectOf"><span class="id" type="projection">ObjectOf</span></a> :> <a class="idref" href="Homework6.html#Functors.objC"><span class="id" type="variable">objC</span></a> → <a class="idref" href="Homework6.html#Functors.objD"><span class="id" type="variable">objD</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="MorphismOf"><span class="id" type="projection">MorphismOf</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>, <a class="idref" href="Homework6.html#Functors.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#Functors.D"><span class="id" type="variable">D</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) (<a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="method">ObjectOf</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) (<a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="method">ObjectOf</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="FCompositionOf"><span class="id" type="projection">FCompositionOf</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> (<span class="id" type="var">m1</span> : <a class="idref" href="Homework6.html#Functors.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">m2</span>: <a class="idref" href="Homework6.html#Functors.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="method">MorphismOf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="method">MorphismOf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="method">MorphismOf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="method">MorphismOf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> (<a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="method">ObjectOf</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#Functors"><span class="id" type="section">Functors</span></a>.<br/>

<br/>
<span class="id" type="keyword">Delimit</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">functor_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">functor</span>.<br/>
<span class="id" type="keyword">Bind</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">functor_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">Functor</span>.<br/>

<br/>
<span class="id" type="var">Create</span> <span class="id" type="var">HintDb</span> <span class="id" type="var">functor</span> <span class="id" type="var">discriminated</span>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> {<span class="id" type="var">objC</span> <span class="id" type="var">C</span> <span class="id" type="var">objD</span> <span class="id" type="var">D</span>} <span class="id" type="var">F</span> <span class="id" type="var">c</span> : <span class="id" type="tactic">simpl</span> <span class="id" type="var">nomatch</span>, <span class="id" type="tactic">rename</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a> {<span class="id" type="var">objC</span>} [<span class="id" type="var">C</span>] {<span class="id" type="var">objD</span>} [<span class="id" type="var">D</span>] <span class="id" type="var">F</span> [<span class="id" type="var">s</span> <span class="id" type="var">d</span>] <span class="id" type="var">m</span> : <span class="id" type="tactic">simpl</span> <span class="id" type="var">nomatch</span>, <span class="id" type="tactic">rename</span>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#FCompositionOf"><span class="id" type="projection">FCompositionOf</span></a> [<span class="id" type="var">objC</span> <span class="id" type="var">C</span> <span class="id" type="var">objD</span> <span class="id" type="var">D</span>] <span class="id" type="var">F</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> : <span class="id" type="tactic">rename</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> [<span class="id" type="var">objC</span> <span class="id" type="var">C</span> <span class="id" type="var">objD</span> <span class="id" type="var">D</span>] <span class="id" type="var">F</span> <span class="id" type="var">_</span> : <span class="id" type="tactic">rename</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#FCompositionOf"><span class="id" type="projection">FCompositionOf</span></a> @<a class="idref" href="Homework6.html#FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#FCompositionOf"><span class="id" type="projection">FCompositionOf</span></a> @<a class="idref" href="Homework6.html#FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> : <span class="id" type="var">functor</span>.<br/>
<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> : <span class="id" type="var">functor</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="Functors_Equal"><span class="id" type="section">Functors_Equal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a> <span class="id" type="var">objC</span> <span class="id" type="var">C</span> <span class="id" type="var">objD</span> <span class="id" type="var">D</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> (<span class="id" type="var">F</span> <span class="id" type="var">G</span> : @<a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#objC"><span class="id" type="variable">objC</span></a> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#objD"><span class="id" type="variable">objD</span></a> <a class="idref" href="Homework6.html#D"><span class="id" type="variable">D</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">m</span>, <a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a> (<span class="id" type="var">s</span> := <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) (<span class="id" type="var">d</span> := <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> (<span class="id" type="var">s</span> := <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) (<span class="id" type="var">d</span> := <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span> : <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <span class="id" type="var">F</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <span class="id" type="var">G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">assumption</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">F</span> <span class="id" type="keyword">as</span> <span class="id" type="var">F'</span>; <span class="id" type="tactic">pose</span> <span class="id" type="var">G</span> <span class="id" type="keyword">as</span> <span class="id" type="var">G'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">F</span>, <span class="id" type="var">G</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a> <span class="id" type="var">F'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a> <span class="id" type="var">G'</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">F'</span> <span class="id" type="var">G'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">intro</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>; <span class="id" type="tactic">intuition</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#Functors_Equal"><span class="id" type="section">Functors_Equal</span></a>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="FunctorComposition"><span class="id" type="section">FunctorComposition</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">B</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objB</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">D</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objD</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">E</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objE</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#FCompositionOf"><span class="id" type="projection">FCompositionOf</span></a> : <span class="id" type="var">functor</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> (<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#FunctorComposition.D"><span class="id" type="variable">D</span></a> <a class="idref" href="Homework6.html#FunctorComposition.E"><span class="id" type="variable">E</span></a>) (<span class="id" type="var">F</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#FunctorComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#FunctorComposition.D"><span class="id" type="variable">D</span></a>) : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#FunctorComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#FunctorComposition.E"><span class="id" type="variable">E</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">Build_Functor</span></a> <a class="idref" href="Homework6.html#FunctorComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#FunctorComposition.E"><span class="id" type="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <span class="id" type="var">G</span> (<span class="id" type="var">F</span> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">m</span> ⇒ <span class="id" type="var">G</span>.(<a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a>) (<span class="id" type="var">F</span>.(<a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a>) <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">functor</span>; <span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#FunctorComposition"><span class="id" type="section">FunctorComposition</span></a>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="IdentityFunctor"><span class="id" type="section">IdentityFunctor</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>).<br/>

<br/>
</div>

<div class="doc">
There is an identity functor.  It does the obvious thing. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IdentityFunctor"><span class="id" type="definition">IdentityFunctor</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#IdentityFunctor.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#IdentityFunctor.C"><span class="id" type="variable">C</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">ObjectOf</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">x</span></a><a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">MorphismOf</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">x</span></a><a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#IdentityFunctor"><span class="id" type="section">IdentityFunctor</span></a>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="IdentityFunctorLemmas"><span class="id" type="section">IdentityFunctorLemmas</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">D</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objD</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="LeftIdentityFunctor"><span class="id" type="lemma">LeftIdentityFunctor</span></a> (<span class="id" type="var">F</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#IdentityFunctorLemmas.D"><span class="id" type="variable">D</span></a> <a class="idref" href="Homework6.html#IdentityFunctorLemmas.C"><span class="id" type="variable">C</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> (<a class="idref" href="Homework6.html#IdentityFunctor"><span class="id" type="definition">IdentityFunctor</span></a> <span class="id" type="var">_</span>) <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="RightIdentityFunctor"><span class="id" type="lemma">RightIdentityFunctor</span></a> (<span class="id" type="var">F</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#IdentityFunctorLemmas.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#IdentityFunctorLemmas.D"><span class="id" type="variable">D</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a> (<a class="idref" href="Homework6.html#IdentityFunctor"><span class="id" type="definition">IdentityFunctor</span></a> <span class="id" type="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#IdentityFunctorLemmas"><span class="id" type="section">IdentityFunctorLemmas</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#LeftIdentityFunctor"><span class="id" type="lemma">LeftIdentityFunctor</span></a> @<a class="idref" href="Homework6.html#RightIdentityFunctor"><span class="id" type="lemma">RightIdentityFunctor</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Immediate</span> @<a class="idref" href="Homework6.html#LeftIdentityFunctor"><span class="id" type="lemma">LeftIdentityFunctor</span></a> @<a class="idref" href="Homework6.html#RightIdentityFunctor"><span class="id" type="lemma">RightIdentityFunctor</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Rewrite</span> @<a class="idref" href="Homework6.html#LeftIdentityFunctor"><span class="id" type="lemma">LeftIdentityFunctor</span></a> @<a class="idref" href="Homework6.html#RightIdentityFunctor"><span class="id" type="lemma">RightIdentityFunctor</span></a> : <span class="id" type="var">functor</span>.<br/>
<span class="id" type="keyword">Hint Immediate</span> @<a class="idref" href="Homework6.html#LeftIdentityFunctor"><span class="id" type="lemma">LeftIdentityFunctor</span></a> @<a class="idref" href="Homework6.html#RightIdentityFunctor"><span class="id" type="lemma">RightIdentityFunctor</span></a> : <span class="id" type="var">functor</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="FunctorCompositionLemmas"><span class="id" type="section">FunctorCompositionLemmas</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">B</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objB</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">D</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objD</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">E</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objE</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="ComposeFunctorsAssociativity"><span class="id" type="lemma">ComposeFunctorsAssociativity</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">F</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#FunctorCompositionLemmas.B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#FunctorCompositionLemmas.C"><span class="id" type="variable">C</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">G</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#FunctorCompositionLemmas.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#FunctorCompositionLemmas.D"><span class="id" type="variable">D</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">H</span> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#FunctorCompositionLemmas.D"><span class="id" type="variable">D</span></a> <a class="idref" href="Homework6.html#FunctorCompositionLemmas.E"><span class="id" type="variable">E</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> (<a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> <a class="idref" href="Homework6.html#H"><span class="id" type="variable">H</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a>) <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> <a class="idref" href="Homework6.html#H"><span class="id" type="variable">H</span></a> (<a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> <a class="idref" href="Homework6.html#G"><span class="id" type="variable">G</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#FunctorCompositionLemmas"><span class="id" type="section">FunctorCompositionLemmas</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#ComposeFunctorsAssociativity"><span class="id" type="lemma">ComposeFunctorsAssociativity</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#ComposeFunctorsAssociativity"><span class="id" type="lemma">ComposeFunctorsAssociativity</span></a> : <span class="id" type="var">functor</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab139"></a><h1 class="section">Computable Category of Categories</h1>

<div class="paragraph"> </div>

 A (full) category of categories is computable if we have a
    function from an indexing type to the categories of the larger
    category. 
</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="ComputableCategory"><span class="id" type="section">ComputableCategory</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="ComputableCategory.I"><span class="id" type="variable">I</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="ComputableCategory.Index2Object"><span class="id" type="variable">Index2Object</span></a> : <a class="idref" href="Homework6.html#ComputableCategory.I"><span class="id" type="variable">I</span></a> → <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="ComputableCategory.Index2Cat"><span class="id" type="variable">Index2Cat</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#ComputableCategory.I"><span class="id" type="variable">I</span></a>, @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> (@<a class="idref" href="Homework6.html#ComputableCategory.Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Coercion</span> <span class="id" type="var">Index2Cat</span> : <span class="id" type="var">I</span> &gt;-&gt; <span class="id" type="var">Category</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="ComputableCategory"><span class="id" type="definition">ComputableCategory</span></a> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#ComputableCategory.I"><span class="id" type="variable">I</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (@<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Build_Category</span></a> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> : <a class="idref" href="Homework6.html#ComputableCategory.I"><span class="id" type="variable">I</span></a> ⇒ <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#D"><span class="id" type="variable">D</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#ComputableCategory.I"><span class="id" type="variable">I</span></a> ⇒ <a class="idref" href="Homework6.html#IdentityFunctor"><span class="id" type="definition">IdentityFunctor</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> <span class="id" type="var">E</span> : <a class="idref" href="Homework6.html#ComputableCategory.I"><span class="id" type="variable">I</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> (<span class="id" type="var">C</span> := <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a>) (<span class="id" type="var">D</span> := <a class="idref" href="Homework6.html#D"><span class="id" type="variable">D</span></a>) (<span class="id" type="var">E</span> := <a class="idref" href="Homework6.html#E"><span class="id" type="variable">E</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a>; <span class="id" type="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#ComputableCategory"><span class="id" type="section">ComputableCategory</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab140"></a><h2 class="section">The category of small-ish categories</h2>
 We don't actually want to restrict ourselves to <span class="inlinecode"><span class="id" type="keyword">Set</span></span>, because
    other things are in <span class="inlinecode"><span class="id" type="keyword">Type</span></span>, and, e.g., <span class="inlinecode"><a class="idref" href="Topology.html#inclusion.T"><span class="id" type="variable">T</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> is not in <span class="inlinecode"><span class="id" type="keyword">Set</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Notation</span> <a name="CategoryOfCategoriesOn"><span class="id" type="abbreviation">CategoryOfCategoriesOn</span></a> <span class="id" type="var">Sets</span><br/>
&nbsp;&nbsp;:= (<a class="idref" href="Homework6.html#ComputableCategory"><span class="id" type="definition">ComputableCategory</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT1"><span class="id" type="definition">projT1</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#projT2"><span class="id" type="definition">projT2</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">obj</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <span class="id" type="var">Sets</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">obj</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">}</span></a>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryOfCategories"><span class="id" type="definition">CategoryOfCategories</span></a> := <a class="idref" href="Homework6.html#CategoryOfCategoriesOn"><span class="id" type="abbreviation">CategoryOfCategoriesOn</span></a> <span class="id" type="keyword">Type</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryInCategoryOfCategories"><span class="id" type="definition">CategoryInCategoryOfCategories</span></a> <span class="id" type="var">obj</span><br/>
: @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a> → <a class="idref" href="Homework6.html#CategoryOfCategories"><span class="id" type="definition">CategoryOfCategories</span></a><br/>
&nbsp;&nbsp;:= @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryInCategoryOfCategories'"><span class="id" type="definition">CategoryInCategoryOfCategories'</span></a> <span class="id" type="var">obj</span><br/>
: @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;:= @<a class="idref" href="Homework6.html#CategoryInCategoryOfCategories"><span class="id" type="definition">CategoryInCategoryOfCategories</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a>.<br/>

<br/>
<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#CategoryInCategoryOfCategories"><span class="id" type="definition">CategoryInCategoryOfCategories</span></a> : <span class="id" type="var">Category</span> &gt;-&gt; <span class="id" type="var">Object</span>.<br/>
<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#CategoryInCategoryOfCategories'"><span class="id" type="definition">CategoryInCategoryOfCategories'</span></a> : <span class="id" type="var">Category</span> &gt;-&gt; <span class="id" type="var">sigT</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab141"></a><h1 class="section">Category of Sets</h1>
 (The category Set of sets). Chapter 2 was all about the category
    of sets, denoted <span class="inlinecode"><span class="id" type="keyword">Set</span></span>. The objects are the sets and the morphisms
    are the functions; we even used the current notation, referring to
    the set of functions <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.Y"><span class="id" type="variable">Y</span></a></span> as <tt>Hom<sub>Set</sub>(X,
    Y)</tt>.  The composition formula
    <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span> is given by function composition, and for every set <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span>, the
    identity function <span class="inlinecode"><a class="idref" href="Monoid.html#id"><span class="id" type="projection">id</span></a></span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> serves as the identity morphism
    for <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span>(<span class="id" type="keyword">Set</span>)</span>. The two laws clearly hold, so <span class="inlinecode"><span class="id" type="keyword">Set</span></span> is indeed a
    category. 
<div class="paragraph"> </div>

 We use <span class="inlinecode"><span class="id" type="keyword">Notation</span></span> to get around type-checking until we instantiate
    it with a particular universe. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Notation</span> <a name="CategoryOf"><span class="id" type="abbreviation">CategoryOf</span></a> <span class="id" type="var">Sets</span> :=<br/>
&nbsp;&nbsp;({|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Morphism</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Y</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Sets</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">→</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Y</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Identity</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Sets</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">));</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Compose</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">f</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">g</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">f</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">g</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">)));</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">LeftIdentity</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Y</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">@</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">eq_refl</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">&lambda;</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">,</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">)</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">RightIdentity</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Y</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">@</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">eq_refl</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">&lambda;</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">X</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">,</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">)</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">p</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Associativity</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">_</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">eq_refl</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;: @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">Sets</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryOfSets"><span class="id" type="definition">CategoryOfSets</span></a> := <a class="idref" href="Homework6.html#CategoryOf"><span class="id" type="abbreviation">CategoryOf</span></a> <span class="id" type="keyword">Set</span>.<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryOfTypes"><span class="id" type="definition">CategoryOfTypes</span></a> := <a class="idref" href="Homework6.html#CategoryOf"><span class="id" type="abbreviation">CategoryOf</span></a> <span class="id" type="keyword">Type</span>.<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryOfProps"><span class="id" type="definition">CategoryOfProps</span></a> := <a class="idref" href="Homework6.html#CategoryOf"><span class="id" type="abbreviation">CategoryOf</span></a> <span class="id" type="keyword">Prop</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab142"></a><h1 class="section">Discrete Category Functors</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="FunctorFromDiscrete"><span class="id" type="section">FunctorFromDiscrete</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="FunctorFromDiscrete.O"><span class="id" type="variable">O</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">D</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objD</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="FunctorFromDiscrete.objOf"><span class="id" type="variable">objOf</span></a> : <a class="idref" href="Homework6.html#FunctorFromDiscrete.O"><span class="id" type="variable">O</span></a> → <a class="idref" href="Homework6.html#FunctorFromDiscrete.objD"><span class="id" type="variable">objD</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="FunctorFromDiscrete.FunctorFromDiscrete_MorphismOf"><span class="id" type="variable">FunctorFromDiscrete_MorphismOf</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> (<a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> <a class="idref" href="Homework6.html#FunctorFromDiscrete.O"><span class="id" type="variable">O</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#FunctorFromDiscrete.D"><span class="id" type="variable">D</span></a> (<a class="idref" href="Homework6.html#FunctorFromDiscrete.objOf"><span class="id" type="variable">objOf</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) (<a class="idref" href="Homework6.html#FunctorFromDiscrete.objOf"><span class="id" type="variable">objOf</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> ⇒ <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="FunctorFromDiscrete"><span class="id" type="definition">FunctorFromDiscrete</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> (<a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> <a class="idref" href="Homework6.html#FunctorFromDiscrete.O"><span class="id" type="variable">O</span></a>) <a class="idref" href="Homework6.html#FunctorFromDiscrete.D"><span class="id" type="variable">D</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">ObjectOf</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">objOf</span></a><a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">;</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">MorphismOf</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">FunctorFromDiscrete_MorphismOf</span></a> |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">category</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#FunctorFromDiscrete"><span class="id" type="section">FunctorFromDiscrete</span></a>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="ObjectFunctorTo"><span class="id" type="abbreviation">ObjectFunctorTo</span></a> <span class="id" type="var">Index2Object</span> <span class="id" type="var">Index2Cat</span> <span class="id" type="var">Sets</span> :=<br/>
&nbsp;&nbsp;((<a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">Build_Functor</span></a> (@<a class="idref" href="Homework6.html#ComputableCategory"><span class="id" type="definition">ComputableCategory</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Index2Cat</span>) (<a class="idref" href="Homework6.html#CategoryOf"><span class="id" type="abbreviation">CategoryOf</span></a> <span class="id" type="var">Sets</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">C'</span> ⇒ <span class="id" type="var">Index2Object</span> <a class="idref" href="Homework6.html#C'"><span class="id" type="variable">C'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">F</span> ⇒ <a class="idref" href="Homework6.html#ObjectOf"><span class="id" type="projection">ObjectOf</span></a> <a class="idref" href="Homework6.html#F"><span class="id" type="variable">F</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a>))).<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="Obj"><span class="id" type="section">Obj</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="ObjectFunctor"><span class="id" type="definition">ObjectFunctor</span></a> <span class="id" type="var">I</span> (<span class="id" type="var">Index2Object</span> : <a class="idref" href="Homework6.html#I"><span class="id" type="variable">I</span></a> → <span class="id" type="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">Index2Cat</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#I"><span class="id" type="variable">I</span></a>, @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> (@<a class="idref" href="Homework6.html#Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Homework6.html#ObjectFunctorTo"><span class="id" type="abbreviation">ObjectFunctorTo</span></a> <a class="idref" href="Homework6.html#Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#Index2Cat"><span class="id" type="variable">Index2Cat</span></a> <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="ObjectFunctorToSet"><span class="id" type="definition">ObjectFunctorToSet</span></a> <span class="id" type="var">I</span> (<span class="id" type="var">Index2Object</span> : <a class="idref" href="Homework6.html#I"><span class="id" type="variable">I</span></a> → <span class="id" type="keyword">Set</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">Index2Cat</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#I"><span class="id" type="variable">I</span></a>, @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> (@<a class="idref" href="Homework6.html#Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Homework6.html#ObjectFunctorTo"><span class="id" type="abbreviation">ObjectFunctorTo</span></a> <a class="idref" href="Homework6.html#Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#Index2Cat"><span class="id" type="variable">Index2Cat</span></a> <span class="id" type="keyword">Set</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="ObjectFunctorToProp"><span class="id" type="definition">ObjectFunctorToProp</span></a> <span class="id" type="var">I</span> (<span class="id" type="var">Index2Object</span> : <a class="idref" href="Homework6.html#I"><span class="id" type="variable">I</span></a> → <span class="id" type="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">Index2Cat</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#I"><span class="id" type="variable">I</span></a>, @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> (@<a class="idref" href="Homework6.html#Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Homework6.html#ObjectFunctorTo"><span class="id" type="abbreviation">ObjectFunctorTo</span></a> <a class="idref" href="Homework6.html#Index2Object"><span class="id" type="variable">Index2Object</span></a> <a class="idref" href="Homework6.html#Index2Cat"><span class="id" type="variable">Index2Cat</span></a> <span class="id" type="keyword">Prop</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#Obj"><span class="id" type="section">Obj</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#ObjectFunctor"><span class="id" type="definition">ObjectFunctor</span></a> {<span class="id" type="var">I</span> <span class="id" type="var">Index2Object</span> <span class="id" type="var">Index2Cat</span>}.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#ObjectFunctorToSet"><span class="id" type="definition">ObjectFunctorToSet</span></a> {<span class="id" type="var">I</span> <span class="id" type="var">Index2Object</span> <span class="id" type="var">Index2Cat</span>}.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#ObjectFunctorToProp"><span class="id" type="definition">ObjectFunctorToProp</span></a> {<span class="id" type="var">I</span> <span class="id" type="var">Index2Object</span> <span class="id" type="var">Index2Cat</span>}.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="InducedFunctor"><span class="id" type="section">InducedFunctor</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="InducedFunctor.O"><span class="id" type="variable">O</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">O'</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">obj</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="InducedFunctor.f"><span class="id" type="variable">f</span></a> : <a class="idref" href="Homework6.html#InducedFunctor.O"><span class="id" type="variable">O</span></a> → <a class="idref" href="Homework6.html#InducedFunctor.O'"><span class="id" type="variable">O'</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="InducedDiscreteFunctor"><span class="id" type="definition">InducedDiscreteFunctor</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> (<a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> <a class="idref" href="Homework6.html#InducedFunctor.O"><span class="id" type="variable">O</span></a>) <a class="idref" href="Homework6.html#InducedFunctor.O'"><span class="id" type="variable">O'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> ?<span class="id" type="var">C</span> ?<span class="id" type="var">D</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">Build_Functor</span></a> <span class="id" type="var">C</span> <span class="id" type="var">D</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#InducedFunctor.f"><span class="id" type="variable">f</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">m</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> ⇒ <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> (<a class="idref" href="Homework6.html#InducedFunctor.f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) <span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#RightIdentity"><span class="id" type="projection">RightIdentity</span></a>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#InducedFunctor"><span class="id" type="section">InducedFunctor</span></a>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="disc"><span class="id" type="section">disc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t</span> := <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">intro</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="DiscreteFunctor"><span class="id" type="definition">DiscreteFunctor</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#CategoryOfTypes"><span class="id" type="definition">CategoryOfTypes</span></a> <a class="idref" href="Homework6.html#CategoryOfCategories"><span class="id" type="definition">CategoryOfCategories</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">Build_Functor</span></a> <a class="idref" href="Homework6.html#CategoryOfTypes"><span class="id" type="definition">CategoryOfTypes</span></a> <a class="idref" href="Homework6.html#CategoryOfCategories"><span class="id" type="definition">CategoryOfCategories</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">O</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> <a class="idref" href="Homework6.html#O"><span class="id" type="variable">O</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">f</span> ⇒ <a class="idref" href="Homework6.html#InducedDiscreteFunctor"><span class="id" type="definition">InducedDiscreteFunctor</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="DiscreteSetFunctor"><span class="id" type="definition">DiscreteSetFunctor</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#CategoryOfSets"><span class="id" type="definition">CategoryOfSets</span></a> <a class="idref" href="Homework6.html#CategoryOfCategories"><span class="id" type="definition">CategoryOfCategories</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">Build_Functor</span></a> <a class="idref" href="Homework6.html#CategoryOfSets"><span class="id" type="definition">CategoryOfSets</span></a> <a class="idref" href="Homework6.html#CategoryOfCategories"><span class="id" type="definition">CategoryOfCategories</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">O</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#existT"><span class="id" type="constructor">existT</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> <a class="idref" href="Homework6.html#O"><span class="id" type="variable">O</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">f</span> ⇒ <a class="idref" href="Homework6.html#InducedDiscreteFunctor"><span class="id" type="definition">InducedDiscreteFunctor</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#disc"><span class="id" type="section">disc</span></a>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="DiscreteAdjoints"><span class="id" type="section">DiscreteAdjoints</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="DiscreteObjectIdentity"><span class="id" type="lemma">DiscreteObjectIdentity</span></a> : <a class="idref" href="Homework6.html#ComposeFunctors"><span class="id" type="definition">ComposeFunctors</span></a> <a class="idref" href="Homework6.html#ObjectFunctor"><span class="id" type="definition">ObjectFunctor</span></a> <a class="idref" href="Homework6.html#DiscreteFunctor"><span class="id" type="definition">DiscreteFunctor</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#IdentityFunctor"><span class="id" type="definition">IdentityFunctor</span></a> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Functor_Eq"><span class="id" type="lemma">Functor_Eq</span></a>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#DiscreteAdjoints"><span class="id" type="section">DiscreteAdjoints</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab143"></a><h1 class="section">Finite Discrete Category</h1>

</div>
<div class="code">

<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="NatCategory"><span class="id" type="definition">NatCategory</span></a> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) := <span class="id" type="keyword">Eval</span> <span class="id" type="tactic">unfold</span> <span class="id" type="var">DiscreteCategory</span>, <span class="id" type="var">DiscreteCategory_Identity</span> <span class="id" type="keyword">in</span> <a class="idref" href="Homework6.html#DiscreteCategory"><span class="id" type="definition">DiscreteCategory</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">|</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Homework6.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">}</span></a>.<br/>

<br/>
<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#NatCategory"><span class="id" type="definition">NatCategory</span></a> : <span class="id" type="var">nat</span> &gt;-&gt; <span class="id" type="var">Category</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab144"></a><h1 class="section">Category Morphisms</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="category_morphisms"><span class="id" type="section">category_morphisms</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">obj</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">morphism_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Quoting Wikipedia,

<div class="paragraph"> </div>

      In category theory, an epimorphism (also called an epic morphism
      or, colloquially, an epi) is a morphism <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> <span class="inlinecode">&rarr;</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.Y"><span class="id" type="variable">Y</span></a></span> which is
      right-cancellative in the sense that, for all morphisms <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.g"><span class="id" type="variable">g</span></a>,</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_31.html#g'"><span class="id" type="variable">g'</span></a></span> <span class="inlinecode">:</span>
      <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.Y"><span class="id" type="variable">Y</span></a></span> <span class="inlinecode">&rarr;</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.Z"><span class="id" type="variable">Z</span></a></span>, <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.g"><span class="id" type="variable">g</span></a></span> <span class="inlinecode">○</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_31.html#g'"><span class="id" type="variable">g'</span></a></span> <span class="inlinecode">○</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.g"><span class="id" type="variable">g</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_31.html#g'"><span class="id" type="variable">g'</span></a></span>

<div class="paragraph"> </div>

      Epimorphisms are analogues of surjective functions, but they are
      not exactly the same. The dual of an epimorphism is a
      monomorphism (i.e. an epimorphism in a category <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> is a
      monomorphism in the dual category <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> <span class="inlinecode"><sup>op</sup></span>).  
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_morphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">z</span> (<span class="id" type="var">m1</span> <span class="id" type="var">m2</span> : <a class="idref" href="Homework6.html#category_morphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#z"><span class="id" type="variable">z</span></a>), <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_morphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">z</span> (<span class="id" type="var">m1</span> <span class="id" type="var">m2</span> : <a class="idref" href="Homework6.html#category_morphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#z"><span class="id" type="variable">z</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>), <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="category_morphisms.properties"><span class="id" type="section">properties</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="IdentityIsEpimorphism"><span class="id" type="lemma">IdentityIsEpimorphism</span></a> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">category</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="IdentityIsMonomorphism"><span class="id" type="lemma">IdentityIsMonomorphism</span></a> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">category</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="EpimorphismComposition"><span class="id" type="lemma">EpimorphismComposition</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> <span class="id" type="var">m0</span> <span class="id" type="var">m1</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m0"><span class="id" type="variable">m0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#Compose"><span class="id" type="projection">Compose</span></a> (<span class="id" type="var">C</span> := <a class="idref" href="Homework6.html#category_morphisms.C"><span class="id" type="variable">C</span></a>) (<span class="id" type="var">s</span> := <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) (<span class="id" type="var">d</span> := <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">d'</span> := <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>) <a class="idref" href="Homework6.html#m0"><span class="id" type="variable">m0</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span> | [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span> <span class="id" type="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="MonomorphismComposition"><span class="id" type="lemma">MonomorphismComposition</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> <span class="id" type="var">m0</span> <span class="id" type="var">m1</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m0"><span class="id" type="variable">m0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<a class="idref" href="Homework6.html#Compose"><span class="id" type="projection">Compose</span></a> (<span class="id" type="var">C</span> := <a class="idref" href="Homework6.html#category_morphisms.C"><span class="id" type="variable">C</span></a>) (<span class="id" type="var">s</span> := <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) (<span class="id" type="var">d</span> := <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">d'</span> := <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>) <a class="idref" href="Homework6.html#m0"><span class="id" type="variable">m0</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span> | [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span> <span class="id" type="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_morphisms.properties"><span class="id" type="section">properties</span></a>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_morphisms"><span class="id" type="section">category_morphisms</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Immediate</span> @<a class="idref" href="Homework6.html#IdentityIsEpimorphism"><span class="id" type="lemma">IdentityIsEpimorphism</span></a> @<a class="idref" href="Homework6.html#IdentityIsMonomorphism"><span class="id" type="lemma">IdentityIsMonomorphism</span></a> @<a class="idref" href="Homework6.html#MonomorphismComposition"><span class="id" type="lemma">MonomorphismComposition</span></a> @<a class="idref" href="Homework6.html#EpimorphismComposition"><span class="id" type="lemma">EpimorphismComposition</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Immediate</span> @<a class="idref" href="Homework6.html#IdentityIsEpimorphism"><span class="id" type="lemma">IdentityIsEpimorphism</span></a> @<a class="idref" href="Homework6.html#IdentityIsMonomorphism"><span class="id" type="lemma">IdentityIsMonomorphism</span></a> @<a class="idref" href="Homework6.html#MonomorphismComposition"><span class="id" type="lemma">MonomorphismComposition</span></a> @<a class="idref" href="Homework6.html#EpimorphismComposition"><span class="id" type="lemma">EpimorphismComposition</span></a> : <span class="id" type="var">morphism</span>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> {<span class="id" type="var">obj</span>} [<span class="id" type="var">C</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>] <span class="id" type="var">m</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> {<span class="id" type="var">obj</span>} [<span class="id" type="var">C</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>] <span class="id" type="var">m</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="AssociativityComposition"><span class="id" type="section">AssociativityComposition</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">obj</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variables</span> <a name="AssociativityComposition.o0"><span class="id" type="variable">o0</span></a> <a name="AssociativityComposition.o1"><span class="id" type="variable">o1</span></a> <a name="AssociativityComposition.o2"><span class="id" type="variable">o2</span></a> <a name="AssociativityComposition.o3"><span class="id" type="variable">o3</span></a> <a name="AssociativityComposition.o4"><span class="id" type="variable">o4</span></a> : <a class="idref" href="Homework6.html#AssociativityComposition.C"><span class="id" type="variable">C</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">morphism_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="compose4associativity_helper"><span class="id" type="lemma">compose4associativity_helper</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o3"><span class="id" type="variable">o3</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o4"><span class="id" type="variable">o4</span></a>) (<span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o2"><span class="id" type="variable">o2</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o3"><span class="id" type="variable">o3</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">c</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o1"><span class="id" type="variable">o1</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o2"><span class="id" type="variable">o2</span></a>) (<span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o0"><span class="id" type="variable">o0</span></a> <a class="idref" href="Homework6.html#AssociativityComposition.o1"><span class="id" type="variable">o1</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">((</span></a><a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#AssociativityComposition"><span class="id" type="section">AssociativityComposition</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">compose4associativity'</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">a</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">((</span></a><span class="id" type="var">b</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">c</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">d</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>)%<span class="id" type="var">morphism</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#compose4associativity_helper"><span class="id" type="lemma">compose4associativity_helper</span></a> ].<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">compose4associativity</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- (<a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(?</span></a><span class="id" type="var">a</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">b</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(?</span></a><span class="id" type="var">c</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">d</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>)%<span class="id" type="var">morphism</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">compose4associativity'</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> (<a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(?</span></a><span class="id" type="var">a</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">b</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(?</span></a><span class="id" type="var">c</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">d</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>)%<span class="id" type="var">morphism</span> ] ⇒ <span class="id" type="var">compose4associativity'</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab145"></a><h1 class="section">Category Isomorphisms</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <a name="category_isomorphisms"><span class="id" type="section">category_isomorphisms</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">obj</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">morphism_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsInverseOf'1"><span class="id" type="definition">IsInverseOf'1</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) : <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsInverseOf'2"><span class="id" type="definition">IsInverseOf'2</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) : <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#IsInverseOf'1"><span class="id" type="definition">IsInverseOf'1</span></a> / <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Homework6.html#IsInverseOf'2"><span class="id" type="definition">IsInverseOf'2</span></a> / <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsInverseOf"><span class="id" type="definition">IsInverseOf</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) : <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="keyword">Eval</span> <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> @<a class="idref" href="Homework6.html#IsInverseOf'1"><span class="id" type="definition">IsInverseOf'1</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> @<a class="idref" href="Homework6.html#IsInverseOf'2"><span class="id" type="definition">IsInverseOf'2</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="IsInverseOf_sym"><span class="id" type="lemma">IsInverseOf_sym</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">m</span> <span class="id" type="var">m'</span> : @<a class="idref" href="Homework6.html#IsInverseOf"><span class="id" type="definition">IsInverseOf</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> → @<a class="idref" href="Homework6.html#IsInverseOf"><span class="id" type="definition">IsInverseOf</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="category_isomorphisms.IsomorphismOf"><span class="id" type="section">IsomorphismOf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Record</span> <a name="IsomorphismOf"><span class="id" type="record">IsomorphismOf</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">IsomorphismOf_Morphism</span> :> <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> := <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="Inverse"><span class="id" type="projection">Inverse</span></a> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="LeftInverse"><span class="id" type="projection">LeftInverse</span></a> : <a class="idref" href="Homework6.html#Inverse"><span class="id" type="method">Inverse</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="RightInverse"><span class="id" type="projection">RightInverse</span></a> : <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#Inverse"><span class="id" type="method">Inverse</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Existing</span> <span class="id" type="keyword">Class</span> <span class="id" type="var">IsomorphismOf</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hint Resolve</span> <a class="idref" href="Homework6.html#RightInverse"><span class="id" type="projection">RightInverse</span></a> <a class="idref" href="Homework6.html#LeftInverse"><span class="id" type="projection">LeftInverse</span></a> : <span class="id" type="var">category</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hint Resolve</span> <a class="idref" href="Homework6.html#RightInverse"><span class="id" type="projection">RightInverse</span></a> <a class="idref" href="Homework6.html#LeftInverse"><span class="id" type="projection">LeftInverse</span></a> : <span class="id" type="var">morphism</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsomorphismOf_sig2"><span class="id" type="definition">IsomorphismOf_sig2</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">m'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">|</span></a> <span class="id" type="var">m'</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">m'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="Homework6.html#Inverse"><span class="id" type="projection">Inverse</span></a> <span class="id" type="var">i</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#LeftInverse"><span class="id" type="projection">LeftInverse</span></a> | <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#RightInverse"><span class="id" type="projection">RightInverse</span></a> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsomorphismOf_sig"><span class="id" type="definition">IsomorphismOf_sig</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">m'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">|</span></a> <span class="id" type="var">m'</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">m'</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'&'_x_'}'"><span class="id" type="notation">}</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Identity</span> <span class="id" type="keyword">Coercion</span> <span class="id" type="var">Isomorphism_sig</span> : <span class="id" type="var">IsomorphismOf_sig</span> &gt;-&gt; <span class="id" type="var">sig2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="sig2_IsomorphismOf"><span class="id" type="instance">sig2_IsomorphismOf</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IsomorphismOf_sig"><span class="id" type="definition">IsomorphismOf_sig</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: @<a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <span class="id" type="var">i</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <span class="id" type="var">i</span>) | <span class="id" type="tactic">apply</span> (<a class="idref" href="Homework6.html#proj3_sig"><span class="id" type="definition">proj3_sig</span></a> <span class="id" type="var">i</span>) ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#IsomorphismOf_sig2"><span class="id" type="definition">IsomorphismOf_sig2</span></a> : <span class="id" type="var">IsomorphismOf</span> &gt;-&gt; <span class="id" type="var">sig2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#sig2_IsomorphismOf"><span class="id" type="instance">sig2_IsomorphismOf</span></a> : <span class="id" type="var">IsomorphismOf_sig</span> &gt;-&gt; <span class="id" type="var">IsomorphismOf</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="IsomorphismOf_Identity"><span class="id" type="instance">IsomorphismOf_Identity</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>) : <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <span class="id" type="var">_</span>); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="InverseOf"><span class="id" type="instance">InverseOf</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> (<a class="idref" href="Homework6.html#Inverse"><span class="id" type="projection">Inverse</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="ComposeIsomorphismOf"><span class="id" type="instance">ComposeIsomorphismOf</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" type="var">m1</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" type="var">m2</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i1</span> : <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i2</span> : <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> (<a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="Homework6.html#Inverse"><span class="id" type="projection">Inverse</span></a> <span class="id" type="var">i2</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#Inverse"><span class="id" type="projection">Inverse</span></a> <span class="id" type="var">i1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="var">compose4associativity</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">i1</span>, <span class="id" type="var">i2</span>; <span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="var">rewrite_hyp</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_isomorphisms.IsomorphismOf"><span class="id" type="section">IsomorphismOf</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="category_isomorphisms.Isomorphism"><span class="id" type="section">Isomorphism</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Record</span> <a name="Isomorphism"><span class="id" type="record">Isomorphism</span></a> (<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="Isomorphism_Morphism"><span class="id" type="projection">Isomorphism_Morphism</span></a> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="Isomorphism_Of"><span class="id" type="projection">Isomorphism_Of</span></a> :> <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#Isomorphism_Morphism"><span class="id" type="method">Isomorphism_Morphism</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="var">Existing</span> <span class="id" type="keyword">Instance</span> <span class="id" type="var">Isomorphism_Of</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Coercion</span> <a class="idref" href="Homework6.html#Build_Isomorphism"><span class="id" type="constructor">Build_Isomorphism</span></a> : <span class="id" type="var">IsomorphismOf</span> &gt;-&gt; <span class="id" type="var">Isomorphism</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphism"><span class="id" type="section">Isomorphism</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Infix</span> <a name="category_isomorphisms.:category_scope:x_'≅'_x"><span class="id" type="notation">"</span></a>&cong;" := (<a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70) : <span class="id" type="var">category_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Infix</span> <a name="category_isomorphisms.:type_scope:x_'≅'_x"><span class="id" type="notation">"</span></a>&cong;" := (<a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70) : <span class="id" type="var">type_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="category_isomorphisms.IsIsomorphism"><span class="id" type="section">IsIsomorphism</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="IsIsomorphism"><span class="id" type="definition">IsIsomorphism</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">m'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#IsInverseOf"><span class="id" type="definition">IsInverseOf</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="IsomrphismOf_IsIsomorphism"><span class="id" type="lemma">IsomrphismOf_IsIsomorphism</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#IsIsomorphism"><span class="id" type="definition">IsIsomorphism</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">i</span>; <span class="id" type="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="Homework6.html#Inverse"><span class="id" type="projection">Inverse</span></a> <span class="id" type="var">i</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">i</span>; <span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="IsIsomorphism_IsomorphismOf"><span class="id" type="lemma">IsIsomorphism_IsomorphismOf</span></a> {<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>} (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IsIsomorphism"><span class="id" type="definition">IsIsomorphism</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">_</span> : <a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [ ? [ ? ? ] ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="var">esplit</span>; <span class="id" type="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_isomorphisms.IsIsomorphism"><span class="id" type="section">IsIsomorphism</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="category_isomorphisms.Isomorphic"><span class="id" type="section">Isomorphic</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="Isomorphic"><span class="id" type="definition">Isomorphic</span></a> (<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">),</span></a> <a class="idref" href="Homework6.html#IsInverseOf"><span class="id" type="definition">IsInverseOf</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> <a name="category_isomorphisms.Isomorphic.::x_'≅'_x"><span class="id" type="notation">"</span></a>&cong;" := (<a class="idref" href="Homework6.html#Isomorphic"><span class="id" type="definition">Isomorphic</span></a>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> <a name="category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">"</span></a>&cong;" := (<a class="idref" href="Homework6.html#Isomorphic"><span class="id" type="definition">Isomorphic</span></a>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 70) : <span class="id" type="var">type_scope</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Isomrphism_Isomorphic"><span class="id" type="lemma">Isomrphism_Isomorphic</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">i</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">i</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">m</span> <span class="id" type="var">i</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#IsomrphismOf_IsIsomorphism"><span class="id" type="lemma">IsomrphismOf_IsIsomorphism</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Isomorphic_Isomorphism"><span class="id" type="lemma">Isomorphic_Isomorphism</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">_</span> : <a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [ ? [ ? [ ? ? ] ] ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="var">esplit</span>; <span class="id" type="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_iso'</span> := <span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#Isomorphic"><span class="id" type="definition">Isomorphic</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Homework6.html#Isomorphic_Isomorphism"><span class="id" type="lemma">Isomorphic_Isomorphism</span></a> <span class="id" type="var">i</span>) <span class="id" type="keyword">as</span> [ ? [] ] ; <span class="id" type="tactic">clear</span> <span class="id" type="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <a class="idref" href="Homework6.html#Isomorphic"><span class="id" type="definition">Isomorphic</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#Isomrphism_Isomorphic"><span class="id" type="lemma">Isomrphism_Isomorphic</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t_iso</span>:= <span class="id" type="var">t_iso'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">unique_pose</span> (<a class="idref" href="Homework6.html#Isomorphism_Of"><span class="id" type="projection">Isomorphism_Of</span></a> <span class="id" type="var">i</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">eapply</span> <a class="idref" href="Homework6.html#Build_Isomorphism"><span class="id" type="constructor">Build_Isomorphism</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#IsomorphismOf_Identity"><span class="id" type="instance">IsomorphismOf_Identity</span></a> @<a class="idref" href="Homework6.html#InverseOf"><span class="id" type="instance">InverseOf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="Homework6.html#ComposeIsomorphismOf"><span class="id" type="instance">ComposeIsomorphismOf</span></a> : <span class="id" type="var">category</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#IsomorphismOf_Identity"><span class="id" type="instance">IsomorphismOf_Identity</span></a> @<a class="idref" href="Homework6.html#InverseOf"><span class="id" type="instance">InverseOf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="Homework6.html#ComposeIsomorphismOf"><span class="id" type="instance">ComposeIsomorphismOf</span></a> : <span class="id" type="var">morphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Hint Extern</span> 1 ⇒ <span class="id" type="var">eassumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Isomorphic_refl"><span class="id" type="lemma">Isomorphic_refl</span></a> <span class="id" type="var">c</span> : <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t_iso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#IsomorphismOf_Identity"><span class="id" type="instance">IsomorphismOf_Identity</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Isomorphic_sym"><span class="id" type="lemma">Isomorphic_sym</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t_iso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eauto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Isomorphic_trans"><span class="id" type="lemma">Isomorphic_trans</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> : <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> → <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic.:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t_iso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> @<a class="idref" href="Homework6.html#ComposeIsomorphismOf"><span class="id" type="instance">ComposeIsomorphismOf</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eauto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Global</span>&nbsp;<span class="id" type="keyword">Add</span> <span class="id" type="var">Parametric</span> <span class="id" type="var">Relation</span> : <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#Isomorphic"><span class="id" type="definition">Isomorphic</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span> <span class="id" type="var">proved</span> <span class="id" type="tactic">by</span> <a class="idref" href="Homework6.html#Isomorphic_refl"><span class="id" type="lemma">Isomorphic_refl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="var">proved</span> <span class="id" type="tactic">by</span> <a class="idref" href="Homework6.html#Isomorphic_sym"><span class="id" type="lemma">Isomorphic_sym</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> <span class="id" type="var">proved</span> <span class="id" type="tactic">by</span> <a class="idref" href="Homework6.html#Isomorphic_trans"><span class="id" type="lemma">Isomorphic_trans</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">as</span> <span class="id" type="var">Isomorphic_rel</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_isomorphisms.Isomorphic"><span class="id" type="section">Isomorphic</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="iso_is_epi"><span class="id" type="lemma">iso_is_epi</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#IsIsomorphism"><span class="id" type="definition">IsIsomorphism</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="Homework6.html#IsEpimorphism"><span class="id" type="definition">IsEpimorphism</span></a> (<span class="id" type="var">C</span> := <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>) <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> 1 <span class="id" type="keyword">as</span> [ <span class="id" type="var">x</span> [ <span class="id" type="var">i0</span> <span class="id" type="var">i1</span> ] ]; <span class="id" type="tactic">intros</span> <span class="id" type="var">z</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span> <span class="id" type="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">m1</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">x</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>); [ <span class="id" type="var">rewrite_hyp</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">m2</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">x</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a>); [ <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rewrite_hyp</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="iso_is_mono"><span class="id" type="lemma">iso_is_mono</span></a> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) : <a class="idref" href="Homework6.html#IsIsomorphism"><span class="id" type="definition">IsIsomorphism</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="Homework6.html#IsMonomorphism"><span class="id" type="definition">IsMonomorphism</span></a> (<span class="id" type="var">C</span> := <a class="idref" href="Homework6.html#category_isomorphisms.C"><span class="id" type="variable">C</span></a>) <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> 1 <span class="id" type="keyword">as</span> [ <span class="id" type="var">x</span> [ <span class="id" type="var">i0</span> <span class="id" type="var">i1</span> ] ]; <span class="id" type="tactic">intros</span> <span class="id" type="var">z</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span> <span class="id" type="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">m</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">m1</span>); [ <span class="id" type="var">rewrite_hyp</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">m</span><a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <span class="id" type="var">m2</span>); [ <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rewrite_hyp</span>; <span class="id" type="tactic">autorewrite</span> <span class="id" type="keyword">with</span> <span class="id" type="var">morphism</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#category_isomorphisms"><span class="id" type="section">category_isomorphisms</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#RightInverse"><span class="id" type="projection">RightInverse</span></a> @<a class="idref" href="Homework6.html#LeftInverse"><span class="id" type="projection">LeftInverse</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="Homework6.html#IsomorphismOf_Identity"><span class="id" type="instance">IsomorphismOf_Identity</span></a> @<a class="idref" href="Homework6.html#ComposeIsomorphismOf"><span class="id" type="instance">ComposeIsomorphismOf</span></a> : <span class="id" type="var">category</span>.<br/>
<span class="id" type="keyword">Hint Resolve</span> @<a class="idref" href="Homework6.html#RightInverse"><span class="id" type="projection">RightInverse</span></a> @<a class="idref" href="Homework6.html#LeftInverse"><span class="id" type="projection">LeftInverse</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="Homework6.html#IsomorphismOf_Identity"><span class="id" type="instance">IsomorphismOf_Identity</span></a> @<a class="idref" href="Homework6.html#ComposeIsomorphismOf"><span class="id" type="instance">ComposeIsomorphismOf</span></a> : <span class="id" type="var">morphism</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" type="keyword">Notation</span></span> <span class="inlinecode">"<a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a></span> <span class="inlinecode"><span class="id" type="var"><sup>-1</sup></span>"</span> <span class="inlinecode">:=</span> <span class="inlinecode">(<a class="idref" href="Homework6.html#Inverse"><span class="id" type="projection">Inverse</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a>)</span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">morphism_scope</span>.</span> 
</div>
<div class="code">

<br/>

<br/>
<span class="id" type="keyword">Infix</span> <a name=":category_scope:x_'≅'_x"><span class="id" type="notation">"</span></a>&cong;" := (@<a class="idref" href="Homework6.html#Isomorphism"><span class="id" type="record">Isomorphism</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) : <span class="id" type="var">category_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab146"></a><h1 class="section">PreOrders as Categories</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="preorder_category"><span class="id" type="section">preorder_category</span></a>.<br/>
</div>

<div class="doc">
A preorder <span class="inlinecode">(<a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a>,</span> <span class="inlinecode">&le;)</span> consists of a set <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> and a binary relation
      <span class="inlinecode">&le;</span> that is reflexive and transitive. We can make from <span class="inlinecode">(<a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a>,</span> <span class="inlinecode">&le;)</span> <span class="inlinecode">:</span>
      <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><span class="id" type="var">PrO</span></span> a category <span class="inlinecode"><a class="idref" href="CoveringSpace.html#X'"><span class="id" type="variable">X'</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_35.html#Exercise_4_1_2_35.Cat"><span class="id" type="variable">Cat</span></a></span> as follows.  Define <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="CoveringSpace.html#X'"><span class="id" type="variable">X'</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span>
      and for every two objects <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_lemmas.X"><span class="id" type="variable">X</span></a></span> define

<div class="paragraph"> </div>

      <span class="inlinecode">[<span class="id" type="var">Hom_X'</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="keyword">if</span></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> <span class="inlinecode"><span class="id" type="keyword">then</span></span> <span class="inlinecode">{"<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>"}</span> <span class="inlinecode"><span class="id" type="keyword">else</span></span> <span class="inlinecode">∅]</span>

<div class="paragraph"> </div>

      ...

<div class="paragraph"> </div>

      In Coq, we can simply take the set of proofs of <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="preorder_category.single_preorder"><span class="id" type="section">single_preorder</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <span class="id" type="var">X</span> <span class="id" type="var">R</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> <a name="preorder_category.single_preorder.::x_'≤'_x"><span class="id" type="notation">"</span></a>&le;" := <a class="idref" href="Homework6.html#preorder_category.single_preorder.R"><span class="id" type="variable">R</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="PreOrderCategory"><span class="id" type="definition">PreOrderCategory</span></a> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#preorder_category.single_preorder.X"><span class="id" type="variable">X</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Morphism</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">R</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Identity</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">reflexivity</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Compose</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">:=</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">(</span></a><span class="id" type="keyword">fun</span> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">y</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">z</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">A</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">B</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">⇒</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">transitivity</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">B</span></a> <a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">A</span></a><a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#preorder_category.single_preorder"><span class="id" type="section">single_preorder</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="preorder_category.all_preorders"><span class="id" type="section">all_preorders</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Record</span> &gt; <a name="PreOrderedSet"><span class="id" type="record">PreOrderedSet</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="PreOrderedSetType"><span class="id" type="projection">PreOrderedSetType</span></a> :> <span class="id" type="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="PreOrderedSetRelation"><span class="id" type="projection">PreOrderedSetRelation</span></a> :> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#PreOrderedSetType"><span class="id" type="method">PreOrderedSetType</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="PreOrderedSetPreOrder"><span class="id" type="projection">PreOrderedSetPreOrder</span></a> :> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#PreOrderedSetRelation"><span class="id" type="method">PreOrderedSetRelation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="CategoryOfPreOrders"><span class="id" type="definition">CategoryOfPreOrders</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= @<a class="idref" href="Homework6.html#ComputableCategory"><span class="id" type="definition">ComputableCategory</span></a> <a class="idref" href="Homework6.html#PreOrderedSet"><span class="id" type="record">PreOrderedSet</span></a> <span class="id" type="var">_</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">X</span> ⇒ <a class="idref" href="Homework6.html#PreOrderCategory"><span class="id" type="definition">PreOrderCategory</span></a> <a class="idref" href="Homework6.html#X"><span class="id" type="variable">X</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#preorder_category.all_preorders"><span class="id" type="section">all_preorders</span></a>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#preorder_category"><span class="id" type="section">preorder_category</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab147"></a><h1 class="section">Orders</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="Comparable"><span class="id" type="record">Comparable</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">R</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="comparability"><span class="id" type="projection">comparability</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">∨</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>

<br/>
<span class="id" type="keyword">Class</span> <a name="LinearOrder"><span class="id" type="record">LinearOrder</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">R</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) : <span class="id" type="keyword">Prop</span> := {<br/>
&nbsp;&nbsp;<a name="LinearOrder_Reflexive"><span class="id" type="projection">LinearOrder_Reflexive</span></a> :> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#Reflexive"><span class="id" type="class">RelationClasses.Reflexive</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> | 2 ;<br/>
&nbsp;&nbsp;<a name="LinearOrder_Transitive"><span class="id" type="projection">LinearOrder_Transitive</span></a> :> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#Transitive"><span class="id" type="class">RelationClasses.Transitive</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> | 2 ;<br/>
&nbsp;&nbsp;<a name="LinearOrder_Comparable"><span class="id" type="projection">LinearOrder_Comparable</span></a> :> <a class="idref" href="Homework6.html#Comparable"><span class="id" type="class">Comparable</span></a> <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> | 2 }.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Same_relation"><span class="id" type="definition">Same_relation</span></a> <span class="id" type="var">T</span> (<span class="id" type="var">R</span> <span class="id" type="var">R'</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'<->'_x"><span class="id" type="notation">↔</span></a> <a class="idref" href="Homework6.html#R'"><span class="id" type="variable">R'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>.<br/>

<br/>
</div>

<div class="doc">
Equality is a pre-order 
</div>
<div class="code">
<span class="id" type="keyword">Program Instance</span> <a name="eq_pre_order"><span class="id" type="instance">eq_pre_order</span></a> <span class="id" type="var">T</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <span class="id" type="var">T</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab148"></a><h2 class="section">Meets and joins</h2>

</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="is_meet"><span class="id" type="definition">is_meet</span></a> <span class="id" type="var">S</span> <span class="id" type="var">le</span> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>) : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> → <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>, <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> → <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> → <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="is_join"><span class="id" type="definition">is_join</span></a> <span class="id" type="var">S</span> <span class="id" type="var">le</span> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>) : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> → <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>, <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> → <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>

<br/>
<span class="id" type="keyword">Class</span> <a name="MeetOf"><span class="id" type="record">MeetOf</span></a> {<span class="id" type="var">S</span>} <span class="id" type="var">le</span> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>) :=<br/>
&nbsp;&nbsp;{ <a name="MeetElement"><span class="id" type="projection">MeetElement</span></a> :> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="meet_is_meet"><span class="id" type="projection">meet_is_meet</span></a> : <a class="idref" href="Homework6.html#is_meet"><span class="id" type="definition">is_meet</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="Homework6.html#MeetElement"><span class="id" type="method">MeetElement</span></a> }.<br/>

<br/>
<span class="id" type="keyword">Class</span> <a name="JoinOf"><span class="id" type="record">JoinOf</span></a> {<span class="id" type="var">S</span>} <span class="id" type="var">le</span> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> <a class="idref" href="Homework6.html#le"><span class="id" type="variable">le</span></a>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>) :=<br/>
&nbsp;&nbsp;{ <a name="JoinElement"><span class="id" type="projection">JoinElement</span></a> :> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="join_is_join"><span class="id" type="projection">join_is_join</span></a> : <a class="idref" href="Homework6.html#is_join"><span class="id" type="definition">is_join</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="Homework6.html#JoinElement"><span class="id" type="method">JoinElement</span></a> }.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="IndexedMeetsAndJoins"><span class="id" type="section">IndexedMeetsAndJoins</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="IndexedMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> <a name="IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">"</span></a>≤" := <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="IndexedMeetsAndJoins.Index"><span class="id" type="variable">Index</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="IndexedMeetsAndJoins.IndexToSet"><span class="id" type="variable">IndexToSet</span></a> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.Index"><span class="id" type="variable">Index</span></a> → <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Coercion</span> <span class="id" type="var">IndexToSet</span> : <span class="id" type="var">Index</span> &gt;-&gt; <span class="id" type="var">T</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="is_indexed_meet"><span class="id" type="definition">is_indexed_meet</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> → <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.Index"><span class="id" type="variable">Index</span></a>, <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.Index"><span class="id" type="variable">Index</span></a>, <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="is_indexed_join"><span class="id" type="definition">is_indexed_join</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> → <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.Index"><span class="id" type="variable">Index</span></a>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">i</span> : <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.Index"><span class="id" type="variable">Index</span></a>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Class</span> <a name="IndexedMeetOf"><span class="id" type="record">IndexedMeetOf</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a name="IndexedMeetElement"><span class="id" type="projection">IndexedMeetElement</span></a> :> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="indexed_meet_is_meet"><span class="id" type="projection">indexed_meet_is_meet</span></a> : <a class="idref" href="Homework6.html#is_indexed_meet"><span class="id" type="definition">is_indexed_meet</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#IndexedMeetElement"><span class="id" type="method">IndexedMeetElement</span></a> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Class</span> <a name="IndexedJoinOf"><span class="id" type="record">IndexedJoinOf</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a name="IndexedJoinElement"><span class="id" type="projection">IndexedJoinElement</span></a> :> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins.T"><span class="id" type="variable">T</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="indexed_join_is_join"><span class="id" type="projection">indexed_join_is_join</span></a> : <a class="idref" href="Homework6.html#is_indexed_join"><span class="id" type="definition">is_indexed_join</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#IndexedJoinElement"><span class="id" type="method">IndexedJoinElement</span></a> }.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#IndexedMeetsAndJoins"><span class="id" type="section">IndexedMeetsAndJoins</span></a>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="EnsemblesMeetsAndJoins"><span class="id" type="section">EnsemblesMeetsAndJoins</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="EnsemblesMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> <a name="EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">"</span></a>≤" := <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="EnsemblesMeetsAndJoins.U"><span class="id" type="variable">U</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="is_ensemble_meet"><span class="id" type="definition">is_ensemble_meet</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) : <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> → <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.U"><span class="id" type="variable">U</span></a> → <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.U"><span class="id" type="variable">U</span></a> → <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="is_ensemble_join"><span class="id" type="definition">is_ensemble_join</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) : <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> → <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.U"><span class="id" type="variable">U</span></a> → <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="keyword">∀</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.U"><span class="id" type="variable">U</span></a> → <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.::x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Class</span> <a name="EnsembleMeetOf"><span class="id" type="record">EnsembleMeetOf</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a name="EnsembleMeetElement"><span class="id" type="projection">EnsembleMeetElement</span></a> :> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ensemble_meet_is_meet"><span class="id" type="projection">ensemble_meet_is_meet</span></a> : <a class="idref" href="Homework6.html#is_ensemble_meet"><span class="id" type="definition">is_ensemble_meet</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#EnsembleMeetElement"><span class="id" type="method">EnsembleMeetElement</span></a> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Class</span> <a name="EnsembleJoinOf"><span class="id" type="record">EnsembleJoinOf</span></a> `(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.leq"><span class="id" type="variable">leq</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a name="EnsembleJoinElement"><span class="id" type="projection">EnsembleJoinElement</span></a> :> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins.T"><span class="id" type="variable">T</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ensemble_join_is_join"><span class="id" type="projection">ensemble_join_is_join</span></a> : <a class="idref" href="Homework6.html#is_ensemble_join"><span class="id" type="definition">is_ensemble_join</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#EnsembleJoinElement"><span class="id" type="method">EnsembleJoinElement</span></a> }.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#EnsemblesMeetsAndJoins"><span class="id" type="section">EnsemblesMeetsAndJoins</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab149"></a><h2 class="section">Opposite relations</h2>

</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="opposite_relation"><span class="id" type="definition">opposite_relation</span></a> {<span class="id" type="var">T</span>} :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a><br/>
&nbsp;&nbsp;:= <span class="id" type="keyword">fun</span> <span class="id" type="var">R</span> ⇒ (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> ⇒ <a class="idref" href="Homework6.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab150"></a><h2 class="section">Relation Homomorphisms</h2>

</div>
<div class="code">
<span class="id" type="keyword">Record</span> <a name="RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">r</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <span class="id" type="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">r'</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <span class="id" type="var">T'</span>) :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="RelationHomomorphism_Function"><span class="id" type="projection">RelationHomomorphism_Function</span></a> :> <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a> → <a class="idref" href="Homework6.html#T'"><span class="id" type="variable">T'</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="RelationHomomorphism_Respectful"><span class="id" type="projection">RelationHomomorphism_Respectful</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.Morphisms.html#respectful"><span class="id" type="definition">respectful</span></a> <a class="idref" href="Homework6.html#r"><span class="id" type="variable">r</span></a> <a class="idref" href="Homework6.html#r'"><span class="id" type="variable">r'</span></a> <a class="idref" href="Homework6.html#RelationHomomorphism_Function"><span class="id" type="method">RelationHomomorphism_Function</span></a> <a class="idref" href="Homework6.html#RelationHomomorphism_Function"><span class="id" type="method">RelationHomomorphism_Function</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="identity_relation_homomorphism"><span class="id" type="definition">identity_relation_homomorphism</span></a> `(<span class="id" type="var">r</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <span class="id" type="var">T</span>)<br/>
: <a class="idref" href="Homework6.html#RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a> <a class="idref" href="Homework6.html#r"><span class="id" type="variable">r</span></a> <a class="idref" href="Homework6.html#r"><span class="id" type="variable">r</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="compose_relation_homomorphisms"><span class="id" type="definition">compose_relation_homomorphisms</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">r</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <span class="id" type="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">r'</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <span class="id" type="var">T'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">r''</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">Relation_Definitions.relation</span></a> <span class="id" type="var">T''</span>)<br/>
: <a class="idref" href="Homework6.html#RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a> <a class="idref" href="Homework6.html#r'"><span class="id" type="variable">r'</span></a> <a class="idref" href="Homework6.html#r''"><span class="id" type="variable">r''</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a> <a class="idref" href="Homework6.html#r"><span class="id" type="variable">r</span></a> <a class="idref" href="Homework6.html#r'"><span class="id" type="variable">r'</span></a><br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a> <a class="idref" href="Homework6.html#r"><span class="id" type="variable">r</span></a> <a class="idref" href="Homework6.html#r''"><span class="id" type="variable">r''</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">m1</span> (<span class="id" type="var">m2</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">m1</span>, <span class="id" type="var">m2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="RelationHomomorphism_Eq"><span class="id" type="lemma">RelationHomomorphism_Eq</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`(<span class="id" type="var">m</span> : @<a class="idref" href="Homework6.html#RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a> <span class="id" type="var">T0</span> <span class="id" type="var">r0</span> <span class="id" type="var">T1</span> <span class="id" type="var">r1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">m'</span> : <a class="idref" href="Homework6.html#RelationHomomorphism"><span class="id" type="record">RelationHomomorphism</span></a> <a class="idref" href="Homework6.html#r0"><span class="id" type="variable">r0</span></a> <a class="idref" href="Homework6.html#r1"><span class="id" type="variable">r1</span></a>)<br/>
: (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#m'"><span class="id" type="variable">m'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H0</span> : <a class="idref" href="Homework6.html#RelationHomomorphism_Function"><span class="id" type="projection">RelationHomomorphism_Function</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#RelationHomomorphism_Function"><span class="id" type="projection">RelationHomomorphism_Function</span></a> <span class="id" type="var">m'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">m</span>, <span class="id" type="var">m'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="f_equal_dep"><span class="id" type="section">f_equal_dep</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="f_type_equal"><span class="id" type="lemma">f_type_equal</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">A'</span> <span class="id" type="var">B'</span>} : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#A'"><span class="id" type="variable">A'</span></a> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#A'"><span class="id" type="variable">A'</span></a> → <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="forall_extensionality_dep"><span class="id" type="lemma">forall_extensionality_dep</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">f</span> <span class="id" type="var">g</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> <span class="id" type="var">f</span> <span class="id" type="keyword">with</span> <span class="id" type="var">g</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.FunctionalExtensionality.html#functional_extensionality_dep"><span class="id" type="axiom">functional_extensionality_dep</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="forall_extensionality_dep_JMeq"><span class="id" type="lemma">forall_extensionality_dep_JMeq</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">f</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>) (<span class="id" type="var">g</span> : <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> → <span class="id" type="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> → (<a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>) → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">intuition</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#forall_extensionality_dep"><span class="id" type="lemma">forall_extensionality_dep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="JMeq_eqT"><span class="id" type="lemma">JMeq_eqT</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">y</span> : <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>) : <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="fg_equal_JMeq"><span class="id" type="lemma">fg_equal_JMeq</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">B'</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>, <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) (<span class="id" type="var">g</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>, <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) <span class="id" type="var">x</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> → (<a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> → <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a>) → <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="f_equal_JMeq"><span class="id" type="lemma">f_equal_JMeq</span></a> <span class="id" type="var">A</span> <span class="id" type="var">A'</span> <span class="id" type="var">B</span> <span class="id" type="var">B'</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>, <a class="idref" href="Homework6.html#A'"><span class="id" type="variable">A'</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a>) (<span class="id" type="var">g</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>, <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> → (<a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> → <a class="idref" href="Homework6.html#A'"><span class="id" type="variable">A'</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#B'"><span class="id" type="variable">B'</span></a>) → (<a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> → <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>) → <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="var">destruct_type</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq"><span class="id" type="inductive">JMeq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="f_equal1_JMeq"><span class="id" type="lemma">f_equal1_JMeq</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">B</span> <span class="id" type="var">a0</span> <span class="id" type="var">b0</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">a0</span> : <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a>), <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="f_equal2_JMeq"><span class="id" type="lemma">f_equal2_JMeq</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">A1</span> <span class="id" type="var">B</span> <span class="id" type="var">a0</span> <span class="id" type="var">b0</span> <span class="id" type="var">a1</span> <span class="id" type="var">b1</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">a0</span> : <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a>) (<span class="id" type="var">a1</span> : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>), <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="f_equal3_JMeq"><span class="id" type="lemma">f_equal3_JMeq</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">B</span> <span class="id" type="var">a0</span> <span class="id" type="var">b0</span> <span class="id" type="var">a1</span> <span class="id" type="var">b1</span> <span class="id" type="var">a2</span> <span class="id" type="var">b2</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">a0</span> : <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a>) (<span class="id" type="var">a1</span> : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) (<span class="id" type="var">a2</span> : <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a>), <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> → <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="f_equal4_JMeq"><span class="id" type="lemma">f_equal4_JMeq</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">A3</span> <span class="id" type="var">B</span> <span class="id" type="var">a0</span> <span class="id" type="var">b0</span> <span class="id" type="var">a1</span> <span class="id" type="var">b1</span> <span class="id" type="var">a2</span> <span class="id" type="var">b2</span> <span class="id" type="var">a3</span> <span class="id" type="var">b3</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">a0</span> : <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a>) (<span class="id" type="var">a1</span> : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) (<span class="id" type="var">a2</span> : <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a>) (<span class="id" type="var">a3</span> : <a class="idref" href="Homework6.html#A3"><span class="id" type="variable">A3</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a>), <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> → <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> → <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a> → <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b3"><span class="id" type="variable">b3</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a> <a class="idref" href="Homework6.html#b3"><span class="id" type="variable">b3</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="f_equal5_JMeq"><span class="id" type="lemma">f_equal5_JMeq</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">A3</span> <span class="id" type="var">A4</span> <span class="id" type="var">B</span> <span class="id" type="var">a0</span> <span class="id" type="var">b0</span> <span class="id" type="var">a1</span> <span class="id" type="var">b1</span> <span class="id" type="var">a2</span> <span class="id" type="var">b2</span> <span class="id" type="var">a3</span> <span class="id" type="var">b3</span> <span class="id" type="var">a4</span> <span class="id" type="var">b4</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">a0</span> : <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a>) (<span class="id" type="var">a1</span> : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a>) (<span class="id" type="var">a2</span> : <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a>) (<span class="id" type="var">a3</span> : <a class="idref" href="Homework6.html#A3"><span class="id" type="variable">A3</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a>) (<span class="id" type="var">a4</span> : <a class="idref" href="Homework6.html#A4"><span class="id" type="variable">A4</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a>), <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a> <a class="idref" href="Homework6.html#a4"><span class="id" type="variable">a4</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> → <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> → <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a> → <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b3"><span class="id" type="variable">b3</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> → <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> → <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a> → <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b3"><span class="id" type="variable">b3</span></a> → <a class="idref" href="Homework6.html#a4"><span class="id" type="variable">a4</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b4"><span class="id" type="variable">b4</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#a0"><span class="id" type="variable">a0</span></a> <a class="idref" href="Homework6.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Homework6.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Homework6.html#a3"><span class="id" type="variable">a3</span></a> <a class="idref" href="Homework6.html#a4"><span class="id" type="variable">a4</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#b0"><span class="id" type="variable">b0</span></a> <a class="idref" href="Homework6.html#b1"><span class="id" type="variable">b1</span></a> <a class="idref" href="Homework6.html#b2"><span class="id" type="variable">b2</span></a> <a class="idref" href="Homework6.html#b3"><span class="id" type="variable">b3</span></a> <a class="idref" href="Homework6.html#b4"><span class="id" type="variable">b4</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_JMeq"><span class="id" type="lemma">eq_JMeq</span></a> <span class="id" type="var">T</span> (<span class="id" type="var">A</span> <span class="id" type="var">B</span> : <a class="idref" href="Homework6.html#T"><span class="id" type="variable">T</span></a>) : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> → <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="functional_extensionality_dep_JMeq"><span class="id" type="lemma">functional_extensionality_dep_JMeq</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">A</span>} {<span class="id" type="var">B1</span> <span class="id" type="var">B2</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a> → <span class="id" type="keyword">Type</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>, <a class="idref" href="Homework6.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="var">g</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>, <a class="idref" href="Homework6.html#B2"><span class="id" type="variable">B2</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B2"><span class="id" type="variable">B2</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) → <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">B1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">B2</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">extensionality</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">auto</span>); <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">f</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">g</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">extensionality</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="functional_extensionality_dep_JMeq'"><span class="id" type="lemma">functional_extensionality_dep_JMeq'</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">A1</span> <span class="id" type="var">A2</span>} {<span class="id" type="var">B1</span> : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> → <span class="id" type="keyword">Type</span>} {<span class="id" type="var">B2</span> : <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a> → <span class="id" type="keyword">Type</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> (<span class="id" type="var">f</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a>, <a class="idref" href="Homework6.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="var">g</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a>, <a class="idref" href="Homework6.html#B2"><span class="id" type="variable">B2</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#B2"><span class="id" type="variable">B2</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ (<a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#A2"><span class="id" type="variable">A2</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a>) → <a class="idref" href="Homework6.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#g"><span class="id" type="variable">g</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#functional_extensionality_dep_JMeq"><span class="id" type="lemma">functional_extensionality_dep_JMeq</span></a>; <span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#f_equal_dep"><span class="id" type="section">f_equal_dep</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="identity_dep"><span class="id" type="inductive">identity_dep</span></a> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">a</span> : <a class="idref" href="Homework6.html#A"><span class="id" type="variable">A</span></a>) : <span class="id" type="keyword">∀</span> <span class="id" type="var">B</span> : <span class="id" type="keyword">Type</span>, <a class="idref" href="Homework6.html#B"><span class="id" type="variable">B</span></a> → <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;<a name="identity_dep_refl"><span class="id" type="constructor">identity_dep_refl</span></a> : <a class="idref" href="Homework6.html#identity_dep"><span class="id" type="inductive">identity_dep</span></a> <span class="id" type="var">a</span> <span class="id" type="var">a</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">JMeq_eq</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#eq_JMeq"><span class="id" type="lemma">eq_JMeq</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">f_equal_dep_cleanup</span> := <span class="id" type="var">JMeq_eq</span>; <span class="id" type="var">eta_red</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">f_equal_dep'</span> := <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" type="var">f</span> ?<span class="id" type="var">a</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">g</span> ?<span class="id" type="var">b</span> ] ⇒ <span class="id" type="tactic">apply</span> (@<a class="idref" href="Homework6.html#f_equal_JMeq"><span class="id" type="lemma">f_equal_JMeq</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>); <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="var">f</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <span class="id" type="var">g</span> ] ⇒ <span class="id" type="var">f_equal_dep'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" type="var">x</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">y</span> ] ⇒ <span class="id" type="var">f_equal_dep_cleanup</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="var">f_equal_dep_cleanup</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">f_equal_dep</span> := <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" type="var">f</span> ?<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">g</span> ?<span class="id" type="var">b</span> ] ⇒ <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>; <span class="id" type="var">f_equal_dep'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" type="var">f</span> ?<span class="id" type="var">a</span> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">g</span> ?<span class="id" type="var">b</span> ] ⇒ <span class="id" type="var">f_equal_dep'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="var">f_equal_dep_cleanup</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="misc"><span class="id" type="section">misc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="sig_JMeq"><span class="id" type="lemma">sig_JMeq</span></a> <span class="id" type="var">A0</span> <span class="id" type="var">A1</span> <span class="id" type="var">B0</span> <span class="id" type="var">B1</span> (<span class="id" type="var">a</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig"><span class="id" type="inductive">sig</span></a> <a class="idref" href="Homework6.html#A0"><span class="id" type="variable">A0</span></a> <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a>) (<span class="id" type="var">b</span> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#sig"><span class="id" type="inductive">sig</span></a> <a class="idref" href="Homework6.html#B0"><span class="id" type="variable">B0</span></a> <a class="idref" href="Homework6.html#B1"><span class="id" type="variable">B1</span></a>) : <a class="idref" href="Homework6.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#B1"><span class="id" type="variable">B1</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a> → <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">destruct_sig</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="var">destruct_type</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq"><span class="id" type="inductive">JMeq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">JMeq_eq</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">JMeq_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="proof_irrelevance_JMeq"><span class="id" type="lemma">proof_irrelevance_JMeq</span></a> (<span class="id" type="var">P</span> <span class="id" type="var">Q</span> : <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">p</span> : <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a>) (<span class="id" type="var">q</span> : <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>) (<span class="id" type="var">H</span> : <a class="idref" href="Homework6.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#Q"><span class="id" type="variable">Q</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Homework6.html#::x_'=='_x"><span class="id" type="notation">==</span></a> <a class="idref" href="Homework6.html#q"><span class="id" type="variable">q</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#eq_JMeq"><span class="id" type="lemma">eq_JMeq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">ProofIrrelevance.proof_irrelevance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#misc"><span class="id" type="section">misc</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab151"></a><h1 class="section">Groupoids</h1>
 Definition 4.2.3.7. A groupoid is a category <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> such that every
    morphism is an isomorphism.  If <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> and <span class="inlinecode"><a class="idref" href="ComputableCategory.html#D"><span class="id" type="variable">D</span></a></span> are groupoids, a morphism
    of groupoids, denoted <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="ComputableCategory.html#D"><span class="id" type="variable">D</span></a></span>, is simply a functor. The category
    of groupoids is denoted <span class="inlinecode"><span class="id" type="var">Grpd</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="IsGroupoid"><span class="id" type="record">IsGroupoid</span></a> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">obj</span>) :=<br/>
&nbsp;&nbsp;{ <a name="is_groupoid"><span class="id" type="projection">is_groupoid</span></a> :> <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Homework6.html#IsomorphismOf"><span class="id" type="class">IsomorphismOf</span></a> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> }.<br/>

<br/>
<span class="id" type="keyword">Record</span> &gt; <a name="Groupoid"><span class="id" type="record">Groupoid</span></a> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="GroupoidType"><span class="id" type="projection">GroupoidType</span></a> :> <span class="id" type="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="GroupoidCategory"><span class="id" type="projection">GroupoidCategory</span></a> :> @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#GroupoidType"><span class="id" type="method">GroupoidType</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="GroupoidIsGroupoid"><span class="id" type="projection">GroupoidIsGroupoid</span></a> :> <a class="idref" href="Homework6.html#IsGroupoid"><span class="id" type="class">IsGroupoid</span></a> <a class="idref" href="Homework6.html#GroupoidCategory"><span class="id" type="method">GroupoidCategory</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" type="var">Existing</span> <span class="id" type="keyword">Instance</span> <span class="id" type="var">GroupoidIsGroupoid</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="CategoryOfGroupoids"><span class="id" type="definition">CategoryOfGroupoids</span></a> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#Groupoid"><span class="id" type="record">Groupoid</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> @<a class="idref" href="Homework6.html#ComputableCategory"><span class="id" type="definition">ComputableCategory</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#GroupoidCategory"><span class="id" type="projection">GroupoidCategory</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab152"></a><h1 class="section">Dual Categories</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">category_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="OppositeCategory"><span class="id" type="section">OppositeCategory</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="OppositeCategory"><span class="id" type="definition">OppositeCategory</span></a> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>) : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#objC"><span class="id" type="variable">objC</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= @<a class="idref" href="Homework6.html#Build_Category"><span class="id" type="constructor">Build_Category</span></a> <a class="idref" href="Homework6.html#objC"><span class="id" type="variable">objC</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> ⇒ <a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="Homework6.html#Identity"><span class="id" type="projection">Identity</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span> ⇒ @<a class="idref" href="Homework6.html#Compose"><span class="id" type="projection">Compose</span></a> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_sym"><span class="id" type="lemma">eq_sym</span></a> (@<a class="idref" href="Homework6.html#Associativity"><span class="id" type="projection">Associativity</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ @<a class="idref" href="Homework6.html#RightIdentity"><span class="id" type="projection">RightIdentity</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ @<a class="idref" href="Homework6.html#LeftIdentity"><span class="id" type="projection">LeftIdentity</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>).<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#OppositeCategory"><span class="id" type="section">OppositeCategory</span></a>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="OppositeFunctor"><span class="id" type="section">OppositeFunctor</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objC</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">D</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <span class="id" type="var">objD</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="OppositeFunctor.F"><span class="id" type="variable">F</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.C"><span class="id" type="variable">C</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.D"><span class="id" type="variable">D</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="OppositeFunctor.COp"><span class="id" type="variable">COp</span></a> := <a class="idref" href="Homework6.html#OppositeCategory"><span class="id" type="definition">OppositeCategory</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.C"><span class="id" type="variable">C</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="OppositeFunctor.DOp"><span class="id" type="variable">DOp</span></a> := <a class="idref" href="Homework6.html#OppositeCategory"><span class="id" type="definition">OppositeCategory</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.D"><span class="id" type="variable">D</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="OppositeFunctor"><span class="id" type="definition">OppositeFunctor</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.COp"><span class="id" type="variable">COp</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.DOp"><span class="id" type="variable">DOp</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Homework6.html#Build_Functor"><span class="id" type="constructor">Build_Functor</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.COp"><span class="id" type="variable">COp</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.DOp"><span class="id" type="variable">DOp</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">c</span> : <a class="idref" href="Homework6.html#OppositeFunctor.COp"><span class="id" type="variable">COp</span></a> ⇒ <a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a> <a class="idref" href="Homework6.html#c"><span class="id" type="variable">c</span></a> : <a class="idref" href="Homework6.html#OppositeFunctor.DOp"><span class="id" type="variable">DOp</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">s</span> <span class="id" type="var">d</span> : <a class="idref" href="Homework6.html#OppositeFunctor.COp"><span class="id" type="variable">COp</span></a>) (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#OppositeFunctor.C"><span class="id" type="variable">C</span></a>.(<a class="idref" href="Homework6.html#Morphism"><span class="id" type="projection">Morphism</span></a>) <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) ⇒ <a class="idref" href="Homework6.html#MorphismOf"><span class="id" type="projection">MorphismOf</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a> (<span class="id" type="var">s</span> := <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a>) (<span class="id" type="var">d</span> := <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a>) <a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">d'</span> <span class="id" type="var">d</span> <span class="id" type="var">s</span> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span> ⇒ <a class="idref" href="Homework6.html#FCompositionOf"><span class="id" type="projection">FCompositionOf</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a> <a class="idref" href="Homework6.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="Homework6.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="Homework6.html#d'"><span class="id" type="variable">d'</span></a> <a class="idref" href="Homework6.html#m2"><span class="id" type="variable">m2</span></a> <a class="idref" href="Homework6.html#m1"><span class="id" type="variable">m1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Homework6.html#FIdentityOf"><span class="id" type="projection">FIdentityOf</span></a> <a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a>).<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#OppositeFunctor"><span class="id" type="section">OppositeFunctor</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab153"></a><h2 class="section">Prop is pre-order</h2>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <a name="PropPreOrder"><span class="id" type="section">PropPreOrder</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> <span class="id" type="keyword">Prop</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Program.Basics.html#impl"><span class="id" type="definition">impl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="PropHasMeets"><span class="id" type="instance">PropHasMeets</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#MeetOf"><span class="id" type="class">MeetOf</span></a> <a class="idref" href="Homework6.html#Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#MeetElement"><span class="id" type="method">MeetElement</span></a> := <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="var">b</span> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="PropHasJoins"><span class="id" type="instance">PropHasJoins</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#JoinOf"><span class="id" type="class">JoinOf</span></a> <a class="idref" href="Homework6.html#Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#JoinElement"><span class="id" type="method">JoinElement</span></a> := <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">∨</span></a> <span class="id" type="var">b</span> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="PropHasIndexedMeets"><span class="id" type="instance">PropHasIndexedMeets</span></a> <span class="id" type="var">Index</span> (<span class="id" type="var">Indexer</span> : <a class="idref" href="Homework6.html#Index"><span class="id" type="variable">Index</span></a> → <span class="id" type="keyword">Prop</span>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IndexedMeetOf"><span class="id" type="class">IndexedMeetOf</span></a> <a class="idref" href="Homework6.html#Indexer"><span class="id" type="variable">Indexer</span></a> <a class="idref" href="Homework6.html#Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#IndexedMeetElement"><span class="id" type="method">IndexedMeetElement</span></a> := <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <span class="id" type="var">Indexer</span> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="PropHasIndexedJoins"><span class="id" type="instance">PropHasIndexedJoins</span></a> <span class="id" type="var">Index</span> (<span class="id" type="var">Indexer</span> : <a class="idref" href="Homework6.html#Index"><span class="id" type="variable">Index</span></a> → <span class="id" type="keyword">Prop</span>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IndexedJoinOf"><span class="id" type="class">IndexedJoinOf</span></a> <a class="idref" href="Homework6.html#Indexer"><span class="id" type="variable">Indexer</span></a> <a class="idref" href="Homework6.html#Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#IndexedJoinElement"><span class="id" type="method">IndexedJoinElement</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">i</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <span class="id" type="var">Indexer</span> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="PropHasEnsembleMeets"><span class="id" type="instance">PropHasEnsembleMeets</span></a> (<span class="id" type="var">U</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <span class="id" type="keyword">Prop</span>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#EnsembleMeetOf"><span class="id" type="class">EnsembleMeetOf</span></a> <a class="idref" href="Homework6.html#U"><span class="id" type="variable">U</span></a> <a class="idref" href="Homework6.html#Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#EnsembleMeetElement"><span class="id" type="method">EnsembleMeetElement</span></a> := <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <span class="id" type="var">U</span> → <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="PropHasEnsembleJoins"><span class="id" type="instance">PropHasEnsembleJoins</span></a> (<span class="id" type="var">U</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <span class="id" type="keyword">Prop</span>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#EnsembleJoinOf"><span class="id" type="class">EnsembleJoinOf</span></a> <a class="idref" href="Homework6.html#U"><span class="id" type="variable">U</span></a> <a class="idref" href="Homework6.html#Prop_PreOrder"><span class="id" type="instance">Prop_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#EnsembleJoinElement"><span class="id" type="method">EnsembleJoinElement</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">i</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <span class="id" type="var">U</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#PropPreOrder"><span class="id" type="section">PropPreOrder</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab154"></a><h2 class="section">Ensembles form a pre-order</h2>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <a name="EnsemblePreOrder"><span class="id" type="section">EnsemblePreOrder</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <a name="EnsemblePreOrder.T"><span class="id" type="variable">T</span></a> : <span class="id" type="keyword">Type</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a> : @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <a class="idref" href="Homework6.html#EnsemblePreOrder.T"><span class="id" type="variable">T</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Included"><span class="id" type="definition">Included</span></a> <span class="id" type="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 1 ⇒ <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 1 ⇒ <span class="id" type="var">destruct_head_hnf</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Intersection"><span class="id" type="inductive">Intersection</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 1 ⇒ <span class="id" type="var">destruct_head_hnf</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Union"><span class="id" type="inductive">Union</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 2 ⇒ <span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 2 ⇒ <span class="id" type="tactic">right</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="EnsembleHasMeets"><span class="id" type="instance">EnsembleHasMeets</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#MeetOf"><span class="id" type="class">MeetOf</span></a> <a class="idref" href="Homework6.html#Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#MeetElement"><span class="id" type="method">MeetElement</span></a> := <span class="id" type="var">a</span> <a class="idref" href="Homework6.html#::x_'∩'_x"><span class="id" type="notation">&cap;</span></a> <span class="id" type="var">b</span> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="EnsembleHasJoins"><span class="id" type="instance">EnsembleHasJoins</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Homework6.html#JoinOf"><span class="id" type="class">JoinOf</span></a> <a class="idref" href="Homework6.html#Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a> <a class="idref" href="Homework6.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Homework6.html#b"><span class="id" type="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#JoinElement"><span class="id" type="method">JoinElement</span></a> := <span class="id" type="var">a</span> <a class="idref" href="Homework6.html#::x_'∪'_x"><span class="id" type="notation">&cup;</span></a> <span class="id" type="var">b</span> |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="EnsembleHasIndexedMeets"><span class="id" type="instance">EnsembleHasIndexedMeets</span></a> <span class="id" type="var">Index</span> (<span class="id" type="var">Indexer</span> : <a class="idref" href="Homework6.html#Index"><span class="id" type="variable">Index</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <a class="idref" href="Homework6.html#EnsemblePreOrder.T"><span class="id" type="variable">T</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IndexedMeetOf"><span class="id" type="class">IndexedMeetOf</span></a> <a class="idref" href="Homework6.html#Indexer"><span class="id" type="variable">Indexer</span></a> <a class="idref" href="Homework6.html#Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#IndexedMeetElement"><span class="id" type="method">IndexedMeetElement</span></a> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <span class="id" type="var">Indexer</span> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>) |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="EnsembleHasIndexedJoins"><span class="id" type="instance">EnsembleHasIndexedJoins</span></a> <span class="id" type="var">Index</span> (<span class="id" type="var">Indexer</span> : <a class="idref" href="Homework6.html#Index"><span class="id" type="variable">Index</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <a class="idref" href="Homework6.html#EnsemblePreOrder.T"><span class="id" type="variable">T</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#IndexedJoinOf"><span class="id" type="class">IndexedJoinOf</span></a> <a class="idref" href="Homework6.html#Indexer"><span class="id" type="variable">Indexer</span></a> <a class="idref" href="Homework6.html#Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#IndexedJoinElement"><span class="id" type="method">IndexedJoinElement</span></a> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">i</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <span class="id" type="var">Indexer</span> <a class="idref" href="Homework6.html#i"><span class="id" type="variable">i</span></a>) |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="EnsembleHasEnsembleMeets"><span class="id" type="instance">EnsembleHasEnsembleMeets</span></a> (<span class="id" type="var">U</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <a class="idref" href="Homework6.html#EnsemblePreOrder.T"><span class="id" type="variable">T</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#EnsembleMeetOf"><span class="id" type="class">EnsembleMeetOf</span></a> <a class="idref" href="Homework6.html#U"><span class="id" type="variable">U</span></a> <a class="idref" href="Homework6.html#Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#EnsembleMeetElement"><span class="id" type="method">EnsembleMeetElement</span></a> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">S</span>, <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <span class="id" type="var">U</span> → <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>) |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <a name="EnsembleHasEnsembleJoins"><span class="id" type="instance">EnsembleHasEnsembleJoins</span></a> (<span class="id" type="var">U</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a> <a class="idref" href="Homework6.html#EnsemblePreOrder.T"><span class="id" type="variable">T</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="Homework6.html#EnsembleJoinOf"><span class="id" type="class">EnsembleJoinOf</span></a> <a class="idref" href="Homework6.html#U"><span class="id" type="variable">U</span></a> <a class="idref" href="Homework6.html#Ensemble_PreOrder"><span class="id" type="instance">Ensemble_PreOrder</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Homework6.html#EnsembleJoinElement"><span class="id" type="method">EnsembleJoinElement</span></a> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">S</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <span class="id" type="var">U</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Homework6.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Homework6.html#::x_'∈'_x"><span class="id" type="notation">&isin;</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>) |}.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#EnsemblePreOrder"><span class="id" type="section">EnsemblePreOrder</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab155"></a><h1 class="section">Exercise 4.1.2.29</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="Exercise_4_1_2_29"><span class="id" type="section">Exercise_4_1_2_29</span></a>.<br/>
</div>

<div class="doc">
<a name="lab156"></a><h2 class="section">Problem</h2>
 Let <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a></span> be the graph whose vertices are all cities in the US and
      whose arrows are airplane flights connecting cities. What idea
      is captured by the free category on <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a></span>? <a name="lab157"></a><h2 class="section">Solution</h2>
 The objects are cities in the US, can the arrows are plane trips
      (consisting of zero or more flights) that you can take to get
      from one city to another. 
</div>
<div class="code">
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#Exercise_4_1_2_29"><span class="id" type="section">Exercise_4_1_2_29</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab158"></a><h1 class="section">Exercise 4.1.2.30</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="Exercise_4_1_2_30"><span class="id" type="section">Exercise_4_1_2_30</span></a>.<br/>
</div>

<div class="doc">
<a name="lab159"></a><h2 class="section">Problem</h2>
 Let <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_1_14.html#Exercise_4_1_1_14.Grph"><span class="id" type="variable">Grph</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_35.html#Exercise_4_1_2_35.Cat"><span class="id" type="variable">Cat</span></a></span> denote the free category functor from
      Example 4.1.2.27, and let <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_35.html#Exercise_4_1_2_35.Cat"><span class="id" type="variable">Cat</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_1_14.html#Exercise_4_1_1_14.Grph"><span class="id" type="variable">Grph</span></a></span> denote the
      underlying graph functor from Example 4.1.2.27. We have seen the
      composition <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span> <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_1_14.html#Exercise_4_1_1_14.Grph"><span class="id" type="variable">Grph</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_1_14.html#Exercise_4_1_1_14.Grph"><span class="id" type="variable">Grph</span></a></span> before; what was it called? <a name="lab160"></a><h2 class="section">Solution</h2>
 It was called the paths-graph in Example 4.1.2.19. 
</div>
<div class="code">
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#Exercise_4_1_2_30"><span class="id" type="section">Exercise_4_1_2_30</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab161"></a><h1 class="section">Exercise 4.1.2.31</h1>

</div>
<div class="code">
<span class="id" type="keyword">Module</span> <a name="Exercise_4_1_2_31"><span class="id" type="module">Exercise_4_1_2_31</span></a>.<br/>
</div>

<div class="doc">
<a name="lab162"></a><h2 class="section">Problem</h2>
 Recall the graph <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a></span> from Example 3.3.1.2. Let <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Homework6.html#OppositeFunctor.F"><span class="id" type="variable">F</span></a>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a>)</span> be the
      free category on <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a></span>. What is <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>)</span>? What is <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>)</span>?

<div class="paragraph"> </div>

      Here is a picture of the graph <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">(<a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a>,</span> <span class="inlinecode"><a class="idref" href="Graph.html#src"><span class="id" type="variable">src</span></a>,</span> <span class="inlinecode"><a class="idref" href="Graph.html#tgt"><span class="id" type="variable">tgt</span></a>):</span>

<span class="inlinecode">&lt;&lt;</span>
                                <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.g"><span class="id" type="variable">g</span></a></span>
                             <span class="inlinecode"><span class="id" type="var">________</span></span>
               <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a></span>    <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a></span>     <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a></span> <span class="inlinecode">/</span>        <span class="inlinecode">&#x2198</span>
               <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span> <span class="inlinecode">-------&gt;</span> <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span>           <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span>
                            <span class="inlinecode">\<span class="id" type="var">________</span>&#x2197</span>
                                <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.h"><span class="id" type="constructor">h</span></a></span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a></span> <span class="inlinecode">:=</span>
                          <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.j"><span class="id" type="constructor">j</span></a></span>
                  <span class="inlinecode"><span class="id" type="var">__</span></span>   <span class="inlinecode"><span class="id" type="var">________</span></span>
                 <span class="inlinecode">/</span>  <span class="inlinecode">&#x2198</span> <span class="inlinecode">/</span>        <span class="inlinecode">&#x2198</span>
              <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a></span> <span class="inlinecode">|</span>    <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>        <span class="inlinecode"><span class="id" type="var">&#x25cb;</span></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a></span>
                 <span class="inlinecode">\<span class="id" type="var">__</span>/</span> <span class="inlinecode">&#x2196<span class="id" type="var">________</span>/</span>
                          <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.k"><span class="id" type="constructor">k</span></a></span>
<span class="inlinecode">&gt;&gt;</span>

      <span class="inlinecode"><span class="id" type="var">We</span></span> <span class="inlinecode"><span class="id" type="var">have</span></span> <span class="inlinecode">[<a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">{<a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a>}]</span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#and"><span class="id" type="inductive">and</span></a></span> <span class="inlinecode">[<a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">{<a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a>,</span> <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.g"><span class="id" type="variable">g</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.h"><span class="id" type="constructor">h</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.j"><span class="id" type="constructor">j</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.k"><span class="id" type="constructor">k</span></a>}].</span> <span class="inlinecode"><span class="id" type="var">The</span></span>
      <span class="inlinecode"><span class="id" type="var">source</span></span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#and"><span class="id" type="inductive">and</span></a></span> <span class="inlinecode"><span class="id" type="var">target</span></span> <span class="inlinecode"><span class="id" type="var">functions</span></span> <span class="inlinecode">[<a class="idref" href="Graph.html#src"><span class="id" type="variable">src</span></a>,</span> <span class="inlinecode"><a class="idref" href="Graph.html#tgt"><span class="id" type="variable">tgt</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a>]</span> <span class="inlinecode"><span class="id" type="var">can</span></span> <span class="inlinecode"><span class="id" type="var">be</span></span> <span class="inlinecode"><span class="id" type="var">captured</span></span> <span class="inlinecode"><span class="id" type="keyword">in</span></span>
      <span class="inlinecode"><span class="id" type="var">the</span></span> <span class="inlinecode"><span class="id" type="var">table</span></span> <span class="inlinecode"><span class="id" type="var">to</span></span> <span class="inlinecode"><span class="id" type="var">the</span></span> <span class="inlinecode"><span class="id" type="tactic">left</span></span> <span class="inlinecode"><span class="id" type="var">below</span>:</span>

<span class="inlinecode">&lt;&lt;</span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Graph.html#src"><span class="id" type="variable">src</span></a></span> <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Graph.html#tgt"><span class="id" type="variable">tgt</span></a></span>                <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>
      <span class="inlinecode">--------------</span>               <span class="inlinecode">---</span>
      <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a></span>   <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a></span>                  <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a></span>
      <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.g"><span class="id" type="variable">g</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a></span>   <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span>                  <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a></span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.h"><span class="id" type="constructor">h</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a></span>   <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span>                  <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>   <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>                  <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.j"><span class="id" type="constructor">j</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>   <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a></span>                  <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a></span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.k"><span class="id" type="constructor">k</span></a></span> <span class="inlinecode">||</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a></span>   <span class="inlinecode">|</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>
<span class="inlinecode">&gt;&gt;</span>

   <span class="inlinecode"></span><a name="lab163"></a><h2 class="section">Solution</h2>
 We have

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode">{<a class="idref" href="Homework6.html#Exercise_4_1_2_31.gf"><span class="id" type="constructor">gf</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.hf"><span class="id" type="constructor">hf</span></a>}</span>

</li>
<li> <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode">{}</span>

</li>
</ul>
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="Exercise_4_1_2_31.V"><span class="id" type="inductive">V</span></a> := <a name="Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> | <a name="Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a> | <a name="Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> | <a name="Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a> | <a name="Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.V"><span class="id" type="inductive">V</span></a> → <a class="idref" href="Homework6.html#Exercise_4_1_2_31.V"><span class="id" type="inductive">V</span></a> → <span class="id" type="keyword">Set</span> :=<br/>
&nbsp;&nbsp;| <a name="Exercise_4_1_2_31.f"><span class="id" type="constructor">f</span></a> : <a class="idref" href="Homework6.html#A"><span class="id" type="inductive">A</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a><br/>
&nbsp;&nbsp;| <a name="Exercise_4_1_2_31.g"><span class="id" type="constructor">g</span></a> : <a class="idref" href="Homework6.html#A"><span class="id" type="inductive">A</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a><br/>
&nbsp;&nbsp;| <a name="Exercise_4_1_2_31.h"><span class="id" type="constructor">h</span></a> : <a class="idref" href="Homework6.html#A"><span class="id" type="inductive">A</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.w"><span class="id" type="constructor">w</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a><br/>
&nbsp;&nbsp;| <a name="Exercise_4_1_2_31.i"><span class="id" type="constructor">i</span></a> : <a class="idref" href="Homework6.html#A"><span class="id" type="inductive">A</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a><br/>
&nbsp;&nbsp;| <a name="Exercise_4_1_2_31.j"><span class="id" type="constructor">j</span></a> : <a class="idref" href="Homework6.html#A"><span class="id" type="inductive">A</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a><br/>
&nbsp;&nbsp;| <a name="Exercise_4_1_2_31.k"><span class="id" type="constructor">k</span></a> : <a class="idref" href="Homework6.html#A"><span class="id" type="inductive">A</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.z"><span class="id" type="constructor">z</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Graph"><span class="id" type="record">Graph</span></a> := @<a class="idref" href="Homework6.html#Exercise_4_1_2_31.Build_Graph"><span class="id" type="constructor">Build_Graph</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.V"><span class="id" type="inductive">V</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Category"><span class="id" type="record">Category</span></a> := @<a class="idref" href="Homework6.html#Exercise_4_1_2_31.PathsCategory"><span class="id" type="definition">PathsCategory</span></a> (<a class="idref" href="Homework6.html#Exercise_4_1_2_31.Vertex"><span class="id" type="projection">Vertex</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a>) (<a class="idref" href="Homework6.html#Exercise_4_1_2_31.Edge"><span class="id" type="projection">Edge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="Exercise_4_1_2_31.Hom_C_v_x"><span class="id" type="inductive">Hom_C_v_x</span></a> := <a name="Exercise_4_1_2_31.gf"><span class="id" type="constructor">gf</span></a> | <a name="Exercise_4_1_2_31.hf"><span class="id" type="constructor">hf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="Exercise_4_1_2_31.Hom_C_x_v"><span class="id" type="definition">Hom_C_x_v</span></a> := <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t'</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> *; <span class="id" type="var">tac</span>; <span class="id" type="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">trivial</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">trivial</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">trivial</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="var">subst_eq_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">x</span> <span class="id" type="keyword">return</span> <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t''</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">e</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span> |- <span class="id" type="var">_</span> ] ⇒  <span class="id" type="keyword">let</span> <span class="id" type="var">a'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">b'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">a'</span> := <span class="id" type="var">a</span>) <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">b'</span> := <span class="id" type="var">b</span>) <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">a'</span>); [ | <span class="id" type="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">b'</span>); [ | <span class="id" type="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">e</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t'</span> <span class="id" type="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">f_equal</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">clear</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> (<span class="id" type="var">t'</span> <span class="id" type="var">tac</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t'''</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t''</span> <span class="id" type="var">tac</span>; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.JMeq.html#JMeq_eq"><span class="id" type="axiom">JMeq_eq</span></a>; <span class="id" type="tactic">solve</span> [ <span class="id" type="var">t''</span> <span class="id" type="var">tac</span> ]).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">t''''</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> (<span class="id" type="var">t''</span> <span class="id" type="var">tac</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">left</span>; <span class="id" type="var">t'''</span> <span class="id" type="tactic">idtac</span> | <span class="id" type="tactic">right</span>; <span class="id" type="var">t'''</span> <span class="id" type="tactic">idtac</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
We first show that <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>)</span> contains no elements. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Exercise_4_1_2_31.Hom_C_x_v_empty_helper"><span class="id" type="lemma">Hom_C_x_v_empty_helper</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#False"><span class="id" type="inductive">False</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.path"><span class="id" type="inductive">path</span></a> <span class="id" type="var">_</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">a'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">b'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">a'</span> := <span class="id" type="var">a</span>) <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">b'</span> := <span class="id" type="var">b</span>) <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">a'</span>); [ | <span class="id" type="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">b'</span>); [ | <span class="id" type="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">clearbody</span> <span class="id" type="var">a'</span> <span class="id" type="var">b'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t'</span> <span class="id" type="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
We now show that <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>)</span> contains only gf and hf. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Exercise_4_1_2_31.Hom_C_v_x_only_helper"><span class="id" type="lemma">Hom_C_v_x_only_helper</span></a> <span class="id" type="var">S</span> <span class="id" type="var">D</span> (<span class="id" type="var">m</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a> <a class="idref" href="Homework6.html#D"><span class="id" type="variable">D</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">Hs</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#S"><span class="id" type="variable">S</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">Hd</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#D"><span class="id" type="variable">D</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">g'</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> := <a class="idref" href="Homework6.html#Exercise_4_1_2_31.AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.g"><span class="id" type="constructor">g</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">f'</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> := <a class="idref" href="Homework6.html#Exercise_4_1_2_31.AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.f"><span class="id" type="constructor">f</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">h'</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> := <a class="idref" href="Homework6.html#Exercise_4_1_2_31.AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.h"><span class="id" type="constructor">h</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'+'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#Hs"><span class="id" type="variable">Hs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> ⇒ (<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#Hd"><span class="id" type="variable">Hd</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> ⇒ <a class="idref" href="Homework6.html#g'"><span class="id" type="variable">g'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#f'"><span class="id" type="variable">f'</span></a>)%<span class="id" type="var">morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'+'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'+'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Homework6.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#Hs"><span class="id" type="variable">Hs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> ⇒ (<span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#Hd"><span class="id" type="variable">Hd</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> ⇒ <a class="idref" href="Homework6.html#h'"><span class="id" type="variable">h'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#f'"><span class="id" type="variable">f'</span></a>)%<span class="id" type="var">morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'+'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">g'</span> <span class="id" type="var">f'</span> <span class="id" type="var">h'</span>; <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; [ <span class="id" type="tactic">subst</span> | ]; <span class="id" type="var">t'</span> <span class="id" type="tactic">idtac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; [ <span class="id" type="tactic">subst</span> | ]; <span class="id" type="var">t'</span> <span class="id" type="tactic">idtac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; [ | ]; <span class="id" type="var">t'</span> <span class="id" type="tactic">idtac</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t''''</span> <span class="id" type="tactic">idtac</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="Exercise_4_1_2_31.Hom"><span class="id" type="variable">Hom</span></a> {<span class="id" type="var">obj</span>} <span class="id" type="var">C</span> := @<a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a> <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a>.<br/>

<br/>
</div>

<div class="doc">
Now, the relevant proofs.  I first show that <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>)</span> is
      isomorphic to the empty set 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Exercise_4_1_2_31.Hom_C_x_v_empty"><span class="id" type="lemma">Hom_C_x_v_empty</span></a> : (<a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom"><span class="id" type="definition">Hom</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> <a class="idref" href="Homework6.html#:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom"><span class="id" type="definition">Hom</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom_C_x_v_empty_helper"><span class="id" type="lemma">Hom_C_x_v_empty_helper</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">return</span> <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> <span class="id" type="keyword">with</span> <span class="id" type="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#::'∅'"><span class="id" type="notation">&empty;</span></a> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">return</span> <span class="id" type="var">_</span> <span class="id" type="keyword">with</span> <span class="id" type="keyword">end</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span>; <span class="id" type="var">t'</span> <span class="id" type="tactic">idtac</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now, I show that <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>)</span> is isomorphic to a two element set. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="Exercise_4_1_2_31.Hom_C_v_x_empty"><span class="id" type="lemma">Hom_C_v_x_empty</span></a> : (<a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom"><span class="id" type="definition">Hom</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> <a class="idref" href="Homework6.html#:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom_C_v_x"><span class="id" type="inductive">Hom_C_v_x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom"><span class="id" type="definition">Hom</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.v"><span class="id" type="constructor">v</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom_C_v_x_only_helper"><span class="id" type="lemma">Hom_C_v_x_only_helper</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#inl"><span class="id" type="constructor">inl</span></a> <span class="id" type="var">_</span> ⇒ <a class="idref" href="Homework6.html#Exercise_4_1_2_31.gf"><span class="id" type="constructor">gf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#inr"><span class="id" type="constructor">inr</span></a> <span class="id" type="var">_</span> ⇒ <a class="idref" href="Homework6.html#Exercise_4_1_2_31.hf"><span class="id" type="constructor">hf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">let</span> <span class="id" type="var">g'</span> := <a class="idref" href="Homework6.html#Exercise_4_1_2_31.AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.g"><span class="id" type="constructor">g</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">f'</span> := <a class="idref" href="Homework6.html#Exercise_4_1_2_31.AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.f"><span class="id" type="constructor">f</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">h'</span> := <a class="idref" href="Homework6.html#Exercise_4_1_2_31.AddEdge"><span class="id" type="constructor">AddEdge</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.NoEdges"><span class="id" type="constructor">NoEdges</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.h"><span class="id" type="constructor">h</span></a> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Morphism"><span class="id" type="projection">Morphism</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_31.C"><span class="id" type="definition">C</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <a class="idref" href="Homework6.html#Exercise_4_1_2_31.Hom_C_v_x"><span class="id" type="inductive">Hom_C_v_x</span></a> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">return</span> <span class="id" type="var">_</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#Exercise_4_1_2_31.gf"><span class="id" type="constructor">gf</span></a> ⇒ (<a class="idref" href="Homework6.html#g'"><span class="id" type="variable">g'</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#f'"><span class="id" type="variable">f'</span></a>)%<span class="id" type="var">morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Homework6.html#Exercise_4_1_2_31.hf"><span class="id" type="constructor">hf</span></a> ⇒ (<a class="idref" href="Homework6.html#h'"><span class="id" type="variable">h'</span></a> <a class="idref" href="Homework6.html#:morphism_scope:x_'o'_x"><span class="id" type="notation">&#x25cb;</span></a> <a class="idref" href="Homework6.html#f'"><span class="id" type="variable">f'</span></a>)%<span class="id" type="var">morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">intros</span> [ | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" type="keyword">context</span>[<span class="id" type="keyword">match</span> ?<span class="id" type="var">x</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">_</span> <span class="id" type="keyword">end</span>] ] ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>; <span class="id" type="var">t'</span> <span class="id" type="tactic">idtac</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#"><span class="id" type="module">Exercise_4_1_2_31</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab164"></a><h1 class="section">Exercise 4.1.2.33</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="Exercise_4_1_2_33"><span class="id" type="section">Exercise_4_1_2_33</span></a>.<br/>
</div>

<div class="doc">
<a name="lab165"></a><h2 class="section">Problem</h2>
 Recall the definition of the set <span class="inlinecode"></span> <span class="inlinecode"><span class="id" type="var">_n_</span></span> <span class="inlinecode"></span> for any natural number
      <span class="inlinecode"><a class="idref" href="ChainCategory.html#n"><span class="id" type="variable">n</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Notations.html#ℕ"><span class="id" type="abbreviation">&#x2115;</span></a></span>, and let <span class="inlinecode"><span class="id" type="var">D_n</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" type="var">Disc</span>(</span> <span class="inlinecode"><span class="id" type="var">_n_</span></span> <span class="inlinecode">)</span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Exercise_4_1_2_35.html#Exercise_4_1_2_35.Cat"><span class="id" type="variable">Cat</span></a></span>. List all the
      morphisms in <span class="inlinecode"><span class="id" type="var">D_4</span></span>.  List all the functors <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a></span>. <a name="lab166"></a><h2 class="section">Solution</h2>
 I defined the discrete categories above, as coercions from the
      natural numbers.  The functors <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a></span> are the functions
      <span class="inlinecode">{1,</span> <span class="inlinecode">2,</span> <span class="inlinecode">3}</span> <span class="inlinecode">→</span> <span class="inlinecode">{1,</span> <span class="inlinecode">2}</span>.  There is the function which sends
      everything to 1, the function which sends everything to 2, and
      functions which send two numbers to 1 and the other one to 2,
      and vice versa. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> := <a class="idref" href="Homework6.html#NatCategory"><span class="id" type="definition">NatCategory</span></a> 3.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a> := <a class="idref" href="Homework6.html#NatCategory"><span class="id" type="definition">NatCategory</span></a> 2.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="OneLtTwo"><span class="id" type="lemma">OneLtTwo</span></a> : 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> 2. <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">constructor</span>. <span class="id" type="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="ZeroLtTwo"><span class="id" type="lemma">ZeroLtTwo</span></a> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> 2. <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">constructor</span>. <span class="id" type="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="ThreeNotLtThree"><span class="id" type="lemma">ThreeNotLtThree</span></a> <span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Homework6.html#n"><span class="id" type="variable">n</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> 3 → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#False"><span class="id" type="inductive">False</span></a>. <span class="id" type="tactic">omega</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">mk_functor</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Homework6.html#FunctorFromDiscrete"><span class="id" type="definition">FunctorFromDiscrete</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">as</span> <span class="id" type="var">n</span> <span class="id" type="keyword">return</span> (<a class="idref" href="Homework6.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> 3 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Unicode.Utf8_core.html#:type_scope:x_'→'_x"><span class="id" type="notation">&rarr;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'|'_x_'}'"><span class="id" type="notation">{</span></a><span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'|'_x_'}'"><span class="id" type="notation">:</span></a> <a class="idref" href="Homework6.html#ℕ"><span class="id" type="abbreviation">&#x2115;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'|'_x_'}'"><span class="id" type="notation">|</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'|'_x_'}'"><span class="id" type="notation">}</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <span class="id" type="var">a</span> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <span class="id" type="var">b</span> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2 ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <span class="id" type="var">c</span> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n'</span>)) ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">pf</span> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="Homework6.html#ThreeNotLtThree"><span class="id" type="lemma">ThreeNotLtThree</span></a> <a class="idref" href="Homework6.html#pf"><span class="id" type="variable">pf</span></a> <span class="id" type="keyword">with</span> <span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Specif.html#proj2_sig"><span class="id" type="definition">proj2_sig</span></a> <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">exact</span> <a class="idref" href="Homework6.html#ZeroLtTwo"><span class="id" type="lemma">ZeroLtTwo</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">exact</span> <a class="idref" href="Homework6.html#OneLtTwo"><span class="id" type="lemma">OneLtTwo</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_1"><span class="id" type="definition">E_4_1_2_33_Functor_1</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 0 0 0. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_2"><span class="id" type="definition">E_4_1_2_33_Functor_2</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 0 0 1. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_3"><span class="id" type="definition">E_4_1_2_33_Functor_3</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 0 1 0. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_4"><span class="id" type="definition">E_4_1_2_33_Functor_4</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 0 1 1. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_5"><span class="id" type="definition">E_4_1_2_33_Functor_5</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 1 0 0. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_6"><span class="id" type="definition">E_4_1_2_33_Functor_6</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 1 0 1. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_7"><span class="id" type="definition">E_4_1_2_33_Functor_7</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 1 1 0. <span class="id" type="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Example</span> <a name="E_4_1_2_33_Functor_8"><span class="id" type="definition">E_4_1_2_33_Functor_8</span></a> : <a class="idref" href="Homework6.html#Functor"><span class="id" type="record">Functor</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_3"><span class="id" type="variable">D_3</span></a> <a class="idref" href="Homework6.html#Exercise_4_1_2_33.D_2"><span class="id" type="variable">D_2</span></a>. <span class="id" type="var">mk_functor</span> 1 1 1. <span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#Exercise_4_1_2_33"><span class="id" type="section">Exercise_4_1_2_33</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab167"></a><h1 class="section">Exercise 4.2.1.10</h1>

</div>
<div class="code">
<span class="id" type="keyword">Module</span> <a name="Exercise_4_2_1_10"><span class="id" type="module">Exercise_4_2_1_10</span></a>.<br/>
</div>

<div class="doc">
<a name="lab168"></a><h2 class="section">Problem</h2>
 Let <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">{1,</span> <span class="inlinecode">2,</span> <span class="inlinecode">3,</span> <span class="inlinecode">4}</span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><span class="id" type="keyword">Set</span></span>. What is the automorphism group
      of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span> in <span class="inlinecode"><span class="id" type="keyword">Set</span></span>, and how many elements does this group have? What
      is the endomorphism monoid of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span> in <span class="inlinecode"><span class="id" type="keyword">Set</span></span>, and how many
      elements does this monoid have?

<div class="paragraph"> </div>

      Recall from Example 4.1.2.3 that every group has an underlying
      monoid <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.G"><span class="id" type="definition">G</span></a>)</span>; is the endomorphism monoid of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span> the underlying
      monoid of the automorphism group of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span>? <a name="lab169"></a><h2 class="section">Solution</h2>
 The automorphism group is the set of permutations of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span>.  There
      are <span class="inlinecode">4!</span> <span class="inlinecode">=</span> <span class="inlinecode">24</span> of them.  The endomorphism monoid is the set of
      functions <span class="inlinecode"><a class="idref" href="Topology.html#inverse_compose.f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.maximal_law.S"><span class="id" type="variable">S</span></a></span>.  There are <span class="inlinecode">4</span> <span class="inlinecode">^</span> <span class="inlinecode">4</span> <span class="inlinecode">=</span> <span class="inlinecode">256</span> of them.  
</div>
<div class="code">
<span class="id" type="keyword">End</span> <a class="idref" href="Homework6.html#"><span class="id" type="module">Exercise_4_2_1_10</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab170"></a><h1 class="section">Exercise 4.2.1.13</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="Exercise_4_2_1_13"><span class="id" type="section">Exercise_4_2_1_13</span></a>.<br/>
</div>

<div class="doc">
<a name="lab171"></a><h2 class="section">Problem</h2>
 We have seen that a preorder can be considered as a category
      <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span>. Recall from Definition 3.4.1.1 that a partial order is a
      preorder with an additional property.  Phrase the defining
      property for preorders in terms of isomorphisms in the category
      <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span>. <a name="lab172"></a><h2 class="section">Solution</h2>
 A preorder category <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span> is a partial order category if the only
      isomorphisms are identity morphisms. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">category_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Class</span> <a name="IsoImpliesId"><span class="id" type="record">IsoImpliesId</span></a> <span class="id" type="var">obj</span> (<span class="id" type="var">C</span> : @<a class="idref" href="Homework6.html#Category"><span class="id" type="record">Category</span></a> <a class="idref" href="Homework6.html#obj"><span class="id" type="variable">obj</span></a>) := { <a name="iso_implies_id"><span class="id" type="projection">iso_implies_id</span></a> :> <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Homework6.html#C"><span class="id" type="variable">C</span></a>, <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Homework6.html#:type_scope:x_'≅'_x"><span class="id" type="notation">&cong;</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Homework6.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Homework6.html#y"><span class="id" type="variable">y</span></a> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">PreOrder</span> <span class="id" type="var">X</span> <span class="id" type="var">R</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> "≤" := <span class="id" type="var">R</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">PartialOrderCategory_is_PartialOrder</span> `(<span class="id" type="var">IsoImpliesId</span> <span class="id" type="var">_</span> (<span class="id" type="var">PreOrderCategory</span> (<span class="id" type="var">R</span> := <span class="id" type="var">R</span>) <span class="id" type="var">_</span>))<br/>
&nbsp;&nbsp;: <span class="id" type="var">PartialOrder</span> <span class="id" type="var">_</span> <span class="id" type="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">compute</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">x0</span>; <span class="id" type="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">intuition</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">f</span> <span class="id" type="var">g</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">iso_implies_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">g</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">proof_irrelevance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">PartialOrder_is_PartialOrderCategory</span> `(<span class="id" type="var">H0</span> : <span class="id" type="var">PartialOrder</span> <span class="id" type="var">X</span> <span class="id" type="var">eq</span> <span class="id" type="var">R</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">IsoImpliesId</span> (<span class="id" type="var">PreOrderCategory</span> (<span class="id" type="var">R</span> := <span class="id" type="var">R</span>) <span class="id" type="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">H0</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">i</span> <span class="id" type="keyword">as</span> [ ? [ ] ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_1_13</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab173"></a><h1 class="section">Exercise 4.2.1.14</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <span class="id" type="var">Exercise_4_2_1_14</span>.<br/>
</div>

<div class="doc">
<a name="lab174"></a><h2 class="section">Problem</h2>
 Suppose that <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> is a preorder (considered as a category). Let
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span> be objects such that <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> and <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span>. Prove
      that there is an isomorphism <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode">&cong;</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> in <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span>. <a name="lab175"></a><h2 class="section">Solution</h2>
 The objects of the hom sets are unique (by, e.g.,
      <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">proof_irrelevance</span></a></span>).  Therefore, we have composed morphisms <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span>
      <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> and <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span>, which are, by uniqueness, the identity
      morphisms. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">category_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">PreOrder</span> <span class="id" type="var">X</span> <span class="id" type="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <span class="id" type="var">C</span> := <span class="id" type="var">PreOrderCategory</span> (<span class="id" type="var">R</span> := <span class="id" type="var">R</span>) <span class="id" type="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> "≤" := <span class="id" type="var">R</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Exercise_4_2_1_14</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">C</span>, <span class="id" type="var">x</span> &le; <span class="id" type="var">y</span> → <span class="id" type="var">y</span> &le; <span class="id" type="var">x</span> → <span class="id" type="var">x</span> &cong; <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">g</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">proof_irrelevance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_1_14</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab176"></a><h1 class="section">Exercise 4.2.1.16</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <span class="id" type="var">Exercise_4_2_1_16</span>.<br/>
</div>

<div class="doc">
<a name="lab177"></a><h2 class="section">Problem</h2>
 Every linear order is a partial order with a special
      property. Can you phrase this property in terms of hom-sets? <a name="lab178"></a><h2 class="section">Solution</h2>
 Yes, I can. <hr/>
 <a name="lab179"></a><h3 class="section">Real Solution</h3>
 For all <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a></span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Topology.html#intersection_union_commute.C"><span class="id" type="variable">C</span></a></span>, we have either <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>)</span> <span class="inlinecode">≠</span> <span class="inlinecode">&empty;</span> or
      <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>)</span> <span class="inlinecode">≠</span> <span class="inlinecode">&empty;</span>, i.e., that there is an element of <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span>
      <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>)</span> <span class="inlinecode">&#x2294;</span> <span class="inlinecode"><span class="id" type="var">Hom_C</span>(<a class="idref" href="Homework6.html#Exercise_4_1_2_31.x"><span class="id" type="constructor">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.y"><span class="id" type="constructor">y</span></a>)</span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">category_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Context</span> `(<span class="id" type="var">PreOrder</span> <span class="id" type="var">X</span> <span class="id" type="var">R</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <span class="id" type="var">C</span> := <span class="id" type="var">PreOrderCategory</span> (<span class="id" type="var">R</span> := <span class="id" type="var">R</span>) <span class="id" type="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Class</span> <span class="id" type="var">CategoryConnected</span> <span class="id" type="var">obj</span> (<span class="id" type="var">C</span> : @<span class="id" type="var">Category</span> <span class="id" type="var">obj</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" type="var">category_connected</span> :> <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">inhabited</span> ((<span class="id" type="var">Morphism</span> <span class="id" type="var">C</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) &#x2294; (<span class="id" type="var">Morphism</span> <span class="id" type="var">C</span> <span class="id" type="var">y</span> <span class="id" type="var">x</span>)) }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> "≤" := <span class="id" type="var">R</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">LinearOrderCategory_is_LinearOrder</span> `(<span class="id" type="var">CategoryConnected</span> <span class="id" type="var">_</span> <span class="id" type="var">C</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">LinearOrder</span> <span class="id" type="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">firstorder</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> ? ? ? <span class="id" type="var">f</span> <span class="id" type="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (<span class="id" type="var">Compose</span> (<span class="id" type="var">C</span> := <span class="id" type="var">C</span>) <span class="id" type="var">g</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">LinearOrder_is_LinearOrderCategory</span> `(<span class="id" type="var">H0</span> : <span class="id" type="var">LinearOrder</span> <span class="id" type="var">X</span> <span class="id" type="var">R</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">CategoryConnected</span> <span class="id" type="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> ((<span class="id" type="var">_</span> : <span class="id" type="var">Comparable</span> <span class="id" type="var">R</span>) <span class="id" type="var">x</span> <span class="id" type="var">y</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">compute</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_1_16</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SetCategory</span> <span class="id" type="var">TopologyCategory</span> <span class="id" type="var">PreOrderCategory</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Functor</span> <span class="id" type="var">Morphism</span> <span class="id" type="var">Duals</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">IndiscreteTopology</span> <span class="id" type="var">DiscreteTopology</span>.<br/>

<br/>
<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">topology_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab180"></a><h1 class="section">Exercise 4.2.3.2</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <span class="id" type="var">Exercise_4_2_3_2</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab181"></a><h2 class="section">Problem</h2>
 Explain how "looking at points" gives a functor <span class="inlinecode"><span class="id" type="var">Top</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Set</span></span>. Does
      "looking at open sets" give a functor <span class="inlinecode"><span class="id" type="var">Top</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">PrO</span></span>? <a name="lab182"></a><h2 class="section">Solution</h2>
 Every topology has an underlying set of points, and every
      continuous function is a function on these sets.  Looking at
      open sets gives a functor <span class="inlinecode"><span class="id" type="var">Top</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">PrO</span></span> <span class="inlinecode"><sup>op</sup></span> where the open sets
      are ordered by inclusion.  There is not an obvious functor <span class="inlinecode"><span class="id" type="var">Top</span></span>
      <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">PrO</span></span> given by looking at open sets; taking interiors doesn't
      work with composition.  There might be a functor <span class="inlinecode"><span class="id" type="var">Top</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">PrO</span></span>
      given by looking at closed sets and closure, but I haven't
      looked in to that. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">UnderlyingPoints</span> : <span class="id" type="var">Functor</span> <span class="id" type="var">CategoryOfTopologies</span> <span class="id" type="var">CategoryOfTypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <span class="id" type="var">ObjectOf</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">X</span> : <span class="id" type="var">CategoryOfTopologies</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">X</span> : <span class="id" type="var">CategoryOfTypes</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">MorphismOf</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> <span class="id" type="var">CategoryOfTopologies</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">proj1_sig</span> <span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> <span class="id" type="var">CategoryOfTypes</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Record</span> &gt; <span class="id" type="var">OpenSet</span> `(<span class="id" type="var">Topology</span> <span class="id" type="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OpenSetSet</span> :> <span class="id" type="var">Ensemble</span> <span class="id" type="var">X</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OpenSetOpen</span> :> <span class="id" type="keyword">Open</span> <span class="id" type="var">OpenSetSet</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">OpenSet_eq</span> `(<span class="id" type="var">T</span> : <span class="id" type="var">Topology</span> <span class="id" type="var">X</span>) (<span class="id" type="var">A</span> <span class="id" type="var">B</span> : <span class="id" type="var">OpenSet</span> <span class="id" type="var">T</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">OpenSetSet</span> <span class="id" type="var">A</span> = <span class="id" type="var">OpenSetSet</span> <span class="id" type="var">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" type="var">A</span> = <span class="id" type="var">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">A</span>, <span class="id" type="var">B</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ProofIrrelevance.proof_irrelevance</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">opens_ordered_by_inclusion</span> `(<span class="id" type="var">Topology</span> <span class="id" type="var">X</span>) : @<span class="id" type="var">PreOrder</span> (<span class="id" type="var">OpenSet</span> <span class="id" type="var">_</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">U</span> <span class="id" type="var">V</span> ⇒ <span class="id" type="var">U</span> &sube; <span class="id" type="var">V</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">continuous_induced_functor_object_of</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> <span class="id" type="var">CategoryOfTopologies</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>)<br/>
&nbsp;&nbsp;: (<span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">d</span>) → (<span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span>; <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="var">inverse_image</span> (<span class="id" type="var">proj1_sig</span> <span class="id" type="var">m</span>) <span class="id" type="var">X</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">m</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">f</span> <span class="id" type="var">c</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">X</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">continuous_induced_functor_morphism_of</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> <span class="id" type="var">CategoryOfTopologies</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">s'</span> <span class="id" type="var">d'</span> (<span class="id" type="var">m'</span> : <span class="id" type="var">Morphism</span> (<span class="id" type="var">PreOrderCategory</span> (<span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">d</span>)) <span class="id" type="var">s'</span> <span class="id" type="var">d'</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Morphism</span> (<span class="id" type="var">PreOrderCategory</span> (<span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">continuous_induced_functor_object_of</span> <span class="id" type="var">m</span> <span class="id" type="var">s'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">continuous_induced_functor_object_of</span> <span class="id" type="var">m</span> <span class="id" type="var">d'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">s'</span> <span class="id" type="var">d'</span> <span class="id" type="var">m'</span> <span class="id" type="var">x</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">m</span>, <span class="id" type="var">m'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">m</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">f</span> <span class="id" type="var">c</span> ]; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">unfold</span> <span class="id" type="var">In</span>, <span class="id" type="var">inverse_image</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">continuous_induced_functor</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> <span class="id" type="var">CategoryOfTopologies</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">Morphism</span> <span class="id" type="var">CategoryOfPreOrders</span> (<span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">d</span>) (<span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <span class="id" type="var">ObjectOf</span> := (<span class="id" type="var">continuous_induced_functor_object_of</span> <span class="id" type="var">m</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">MorphismOf</span> := (<span class="id" type="var">continuous_induced_functor_morphism_of</span> <span class="id" type="var">m</span>) |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ProofIrrelevance.proof_irrelevance</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Here's the open-set functor 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">PreOrderedSets</span> : <span class="id" type="var">Functor</span> <span class="id" type="var">CategoryOfTopologies</span> (<span class="id" type="var">OppositeCategory</span> <span class="id" type="var">CategoryOfPreOrders</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">Build_Functor</span> <span class="id" type="var">CategoryOfTopologies</span> (<span class="id" type="var">OppositeCategory</span> <span class="id" type="var">CategoryOfPreOrders</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">opens_ordered_by_inclusion</span> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">continuous_induced_functor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">repeat</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" type="tactic">progress</span> (<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="var">expand</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" type="tactic">progress</span> <span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">OpenSet</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" type="tactic">apply</span> <span class="id" type="tactic">f_equal</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" type="tactic">apply</span> <span class="id" type="var">ProofIrrelevance.proof_irrelevance</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" type="tactic">apply</span> <span class="id" type="var">proof_irrelevance_JMeq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" type="tactic">apply</span> <span class="id" type="var">Functor_Eq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_3_2</span>.<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">Exercise_4_2_3_2_continuity_bad</span>.<br/>
</div>

<div class="doc">
Here's a proof that continuous functions don't necesarily
      respect openness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <span class="id" type="var">Three</span> := <span class="id" type="var">A</span> | <span class="id" type="var">B</span> | <span class="id" type="var">C</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">ThreeTopology1</span> : <span class="id" type="var">Topology</span> <span class="id" type="var">Three</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="var">DiscreteTopology</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">ThreeTopology2</span> : <span class="id" type="var">Topology</span> <span class="id" type="var">Three</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="var">IndiscreteTopology</span> <span class="id" type="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">f</span> : <span class="id" type="var">ThreeTopology1</span> → <span class="id" type="var">ThreeTopology2</span> := @<span class="id" type="var">id</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">continuous_function_continuous</span> : <span class="id" type="var">continuous</span> <span class="id" type="var">ThreeTopology1</span> <span class="id" type="var">ThreeTopology2</span> <span class="id" type="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">f_not_preserve_open</span> : <span class="id" type="tactic">∃</span> <span class="id" type="var">S</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" type="keyword">Open</span> <span class="id" type="var">_</span> <span class="id" type="var">ThreeTopology1</span> <span class="id" type="var">S</span> ∧ ~@<span class="id" type="keyword">Open</span> <span class="id" type="var">_</span> <span class="id" type="var">ThreeTopology2</span> (<span class="id" type="var">image</span> <span class="id" type="var">f</span> <span class="id" type="var">S</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="keyword">match</span> <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">A</span> ⇒ <span class="id" type="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intuition</span>; <span class="id" type="tactic">firstorder</span> <span class="id" type="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fg_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> (<span class="id" type="var">H</span> <span class="id" type="var">A</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> (<span class="id" type="var">H</span> <span class="id" type="var">B</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> (<span class="id" type="var">H</span> <span class="id" type="var">C</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : @<span class="id" type="var">eq</span> <span class="id" type="keyword">Prop</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span> : <span class="id" type="var">a</span> ↔ <span class="id" type="var">b</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">firstorder</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">_</span> : ?<span class="id" type="var">T</span>, <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">T</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">Prop</span> ⇒ <span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">t</span> : <span class="id" type="var">T</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">repeat</span> <span class="id" type="var">esplit</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">trivial</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">H</span> <span class="id" type="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">ex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">intuition</span> <span class="id" type="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_3_2_continuity_bad</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Notation</span> <span class="id" type="var">&#x2124;</span> := <span class="id" type="var">Z</span>.<br/>

<br/>
<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab183"></a><h1 class="section">Exercise 4.2.3.12</h1>

</div>
<div class="code">
<span class="id" type="keyword">Section</span> <span class="id" type="var">Exercise_4_2_3_12</span>.<br/>
</div>

<div class="doc">
<a name="lab184"></a><h2 class="section">Problem</h2>
 Consider the set <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span> of all (well-formed) arithmetic expressions
      in the symbols <span class="inlinecode">{0,</span> <span class="inlinecode">...,</span> <span class="inlinecode">9,</span> <span class="inlinecode">+,</span> <span class="inlinecode">-,</span> <span class="inlinecode">*,</span> <span class="inlinecode">(,</span> <span class="inlinecode">)}</span>. For example, here
      are some elements of <span class="inlinecode"><a class="idref" href="Homework6.html#Exercise_4_1_2_31.A"><span class="id" type="inductive">A</span></a></span>:

<div class="paragraph"> </div>

      <span class="inlinecode">[52,</span> <span class="inlinecode">52</span> <span class="inlinecode">-</span> <span class="inlinecode">7,</span> <span class="inlinecode">50</span> <span class="inlinecode">+</span> <span class="inlinecode">3</span> <span class="inlinecode">×</span> <span class="inlinecode">(6</span> <span class="inlinecode">-</span> <span class="inlinecode">2).]</span>

<div class="paragraph"> </div>

      We can say that an equivalence between two arithmetic
      expressions is a justification that they give the same "final
      answer", e.g. <span class="inlinecode">52</span> <span class="inlinecode">+</span> <span class="inlinecode">60</span> is equivalent to <span class="inlinecode">10</span> <span class="inlinecode">×</span> <span class="inlinecode">(5</span> <span class="inlinecode">+</span> <span class="inlinecode">6)</span> <span class="inlinecode">+</span> <span class="inlinecode">(2</span> <span class="inlinecode">+</span>
      <span class="inlinecode">)</span>, which is equivalent to <span class="inlinecode">10</span> <span class="inlinecode">×</span> <span class="inlinecode">11</span> <span class="inlinecode">+</span> <span class="inlinecode">2</span>. I’ve basically
      described a groupoid. What are its objects and what are its
      morphisms? <a name="lab185"></a><h2 class="section">Solution</h2>
 The objects are formal (valid) arithmetic expressions.  The
      morphisms are proofs (justifications) that two arithmetic
      expressions compute the same value.  Note that applying symmetry
      twice is equivalent to doing nothing, and so all proofs have an
      inverse. 
<div class="paragraph"> </div>

 Here's a proof that, at least in Coq, <span class="inlinecode"><span class="id" type="tactic">symmetry</span></span> (<span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_sym"><span class="id" type="lemma">eq_sym</span></a></span>) is
      an "inverse of" operator. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eq_trans_id</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">T</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> (<span class="id" type="var">pf</span> : @<span class="id" type="var">eq</span> <span class="id" type="var">T</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eq_trans</span> (<span class="id" type="var">eq_sym</span> <span class="id" type="var">pf</span>) <span class="id" type="var">pf</span> = <span class="id" type="var">eq_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Here's a reification of the relevant fragment of arithmetic.
      Note that I take the integers as fundamental, and let
      parenthetization be implicit; it's simpler that way. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <span class="id" type="var">Expression</span> :=<br/>
&nbsp;&nbsp;| <span class="id" type="var">Constant</span> : <span class="id" type="var">&#x2124;</span> → <span class="id" type="var">Expression</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Pos</span> : <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Negate</span> : <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span><br/>
&nbsp;&nbsp;| <span class="id" type="keyword">Add</span> : <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Subtract</span> : <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Multiply</span> : <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span> → <span class="id" type="var">Expression</span>.<br/>

<br/>
</div>

<div class="doc">
This converts expressions into numbers, which makes it easier to
      reason about them.  In particular, we can use Coq's built in
      equality reasoning on integers to determine whether or not two
      expressions represent the same value. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">DenoteExpression</span> (<span class="id" type="var">e</span> : <span class="id" type="var">Expression</span>) : <span class="id" type="var">&#x2124;</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">e</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Constant</span> <span class="id" type="var">z</span> ⇒ <span class="id" type="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Pos</span> <span class="id" type="var">z</span> ⇒ <span class="id" type="var">DenoteExpression</span> <span class="id" type="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Negate</span> <span class="id" type="var">z</span> ⇒ -<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">Add</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> ⇒ (<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">a</span>) + (<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Subtract</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> ⇒ (<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">a</span>) - (<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Multiply</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> ⇒ (<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">a</span>) × (<span class="id" type="var">DenoteExpression</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Here's the category; the morphisms are equalities. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">ArithmeticCategory</span> : @<span class="id" type="var">Category</span> <span class="id" type="var">Expression</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <span class="id" type="var">Morphism</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> ⇒ <span class="id" type="var">DenoteExpression</span> <span class="id" type="var">x</span> = <span class="id" type="var">DenoteExpression</span> <span class="id" type="var">y</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Identity</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="var">eq_refl</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Compose</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> ⇒ <span class="id" type="var">eq_trans</span> <span class="id" type="var">q</span> <span class="id" type="var">p</span>) |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">intro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Here's the groupoid; the inversion operation is symmetry (note
      the <span class="inlinecode"><span class="id" type="tactic">∃</span></span> <span class="inlinecode">[<a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_sym"><span class="id" type="lemma">eq_sym</span></a></span> <span class="inlinecode"><a class="idref" href="CategoryIsomorphisms.html#m"><span class="id" type="variable">m</span></a>]</span>; <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Init.Logic.html#eq_sym"><span class="id" type="lemma">eq_sym</span></a></span> is symmetry of equality for
      Coq). 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">ArithmeticGroupoid</span> : <span class="id" type="var">Groupoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <span class="id" type="var">GroupoidCategory</span> := <span class="id" type="var">ArithmeticCategory</span> |}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="var">eq_sym</span> <span class="id" type="var">m</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_3_12</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab186"></a><h1 class="section">Exercise 4.2.4.3</h1>

</div>
<div class="code">
<span class="id" type="keyword">Module</span> <span class="id" type="var">Exercise_4_2_4_3</span>.<br/>
</div>

<div class="doc">
<a name="lab187"></a><h2 class="section">Problem</h2>
 Consider the set of possible laws (most likely an infinite set)
      that can be dictated to hold throughout a jurisdiction. Consider
      each law as a proposition ("such and such is (dictated to be)
      the case"), i.e as an object of our preorder <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>. Given a
      jurisdiction <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>, and a set of laws <span class="inlinecode">{<span class="id" type="var">L1</span>,</span> <span class="inlinecode"><span class="id" type="var">L2</span>,</span> <span class="inlinecode">...,</span> <span class="inlinecode"><span class="id" type="var">Ln</span>}</span> that are
      dictated to hold throughout <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>, we take their meet <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_3.html#L"><span class="id" type="variable">L</span></a>(<a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a>)</span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" type="var">L1</span></span>
      <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" type="var">L2</span></span> <span class="inlinecode">∧</span> <span class="inlinecode">...</span> <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" type="var">Ln</span></span> and consider it to be the single law of the
      land <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>. Suppose that <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> is a jurisdiction and <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">&sube;</span> <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> is a
      sub-jurisdiction (e.g.  <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> is a county and <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> is a state);
      then clearly any law dictated by the large jurisdiction (the
      state) must also hold throughout the small jurisdiction (the
      county). What is the relation in <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> between L(U) and L(V)?

<div class="paragraph"> </div>

      Consider the obvious preorder <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> on jurisdictions, where <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">&sube;</span>
      <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> means <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>. Is "the law of the land" a morphism of
      preorders <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>? To be a bit more highbrow, considering
      both <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> and <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> to be categories (by Proposition 4.2.1.17),
      we have a function <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_3.html#L"><span class="id" type="variable">L</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>; this question is
      asking whether <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_3.html#L"><span class="id" type="variable">L</span></a></span> extends to a functor <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>. <a name="lab188"></a><h2 class="section">Solution</h2>
 If <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">&sube;</span> <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>, then <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_3.html#L"><span class="id" type="variable">L</span></a>(<a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a>)</span> <span class="inlinecode">&le;</span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_3.html#L"><span class="id" type="variable">L</span></a>(<a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a>)</span>, because whenever all the laws of
      <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> hold, so must the laws of <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span>.

<div class="paragraph"> </div>

      We do not have a functor <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>, but a functor <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>
      <span class="inlinecode"><sup>op</sup></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">Law</span> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">LawAsProp</span> : <span class="id" type="var">Law</span> → <span class="id" type="keyword">Prop</span>.<br/>
</div>

<div class="doc">
The type of jurisdictions 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">Jurisdiction</span> : <span class="id" type="keyword">Type</span>.<br/>
</div>

<div class="doc">
The laws of a jurisdiction is a subset of the set of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.Law"><span class="id" type="variable">Law</span></a></span>s 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">LawsOf</span> : <span class="id" type="var">Jurisdiction</span> → <span class="id" type="var">Ensemble</span> <span class="id" type="var">Law</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> "&lt;=" := <span class="id" type="var">impl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Infix</span> "≤" := <span class="id" type="var">impl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <span class="id" type="var">LawOfTheLand</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">V</span> : <span class="id" type="var">Jurisdiction</span>.<br/>
</div>

<div class="doc">
An <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a></span> <span class="inlinecode"><a class="idref" href="Topology.html#inclusion.T"><span class="id" type="variable">T</span></a></span> is a subset of <span class="inlinecode"><a class="idref" href="Topology.html#inclusion.T"><span class="id" type="variable">T</span></a></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <span class="id" type="var">V_Laws</span> : <span class="id" type="var">Ensemble</span> <span class="id" type="var">Law</span> := <span class="id" type="var">LawsOf</span> <span class="id" type="var">V</span>.<br/>
</div>

<div class="doc">
A <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> is a law of <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> if there is some <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.Law"><span class="id" type="variable">Law</span></a></span> which is
        equal to <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span> when treated as a <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <span class="id" type="var">V_LawsAsProp</span> : <span class="id" type="var">Ensemble</span> <span class="id" type="keyword">Prop</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">P</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">L</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">L</span> &isin; <span class="id" type="var">V_Laws</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧ <span class="id" type="var">LawAsProp</span> <span class="id" type="var">L</span> = <span class="id" type="var">P</span>.<br/>
</div>

<div class="doc">
Since <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> has all meets (defined by subsets, i.e.,
       <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl1/stdlib/Coq.Sets.Ensembles.html#Ensemble"><span class="id" type="definition">Ensemble</span></a></span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>s), we can define the law of the land as the
       meet of all of the laws of <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">LawOfTheLand</span> := <span class="id" type="var">PropHasEnsembleMeets</span> <span class="id" type="var">V_LawsAsProp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <span class="id" type="var">LawOfTheLand</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">LawOfTheLand_subset_flip</span> (<span class="id" type="var">U</span> <span class="id" type="var">V</span> : <span class="id" type="var">Jurisdiction</span>) (<span class="id" type="var">P</span> := <span class="id" type="var">Prop_PreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">LawOfTheVLand</span> := <span class="id" type="var">EnsembleMeetElement</span> (<span class="id" type="var">EnsembleMeetOf</span> := <span class="id" type="var">LawOfTheLand</span> <span class="id" type="var">V</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">LawOfTheULand</span> := <span class="id" type="var">EnsembleMeetElement</span> (<span class="id" type="var">EnsembleMeetOf</span> := <span class="id" type="var">LawOfTheLand</span> <span class="id" type="var">U</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">LawsOf</span> <span class="id" type="var">U</span> &sube; <span class="id" type="var">LawsOf</span> <span class="id" type="var">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" type="var">LawOfTheVLand</span> &le; <span class="id" type="var">LawOfTheULand</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">JurisdictionPreOrder</span> : @<span class="id" type="var">PreOrder</span> <span class="id" type="var">Jurisdiction</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">U</span> <span class="id" type="var">V</span> ⇒ <span class="id" type="var">LawsOf</span> <span class="id" type="var">U</span> &sube; <span class="id" type="var">LawsOf</span> <span class="id" type="var">V</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">LawOfTheLandFunctor</span> : <span class="id" type="var">Functor</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">OppositeCategory</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">Prop_PreOrder</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> {| <span class="id" type="var">ObjectOf</span> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">V</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">EnsembleMeetElement</span> (<span class="id" type="var">EnsembleMeetOf</span> := <span class="id" type="var">LawOfTheLand</span> <span class="id" type="var">V</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">MorphismOf</span> := (@<span class="id" type="var">LawOfTheLand_subset_flip</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" type="keyword">∀</span> <span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>) <span class="id" type="var">s</span> <span class="id" type="var">d</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Morphism</span> (<span class="id" type="var">OppositeCategory</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">Prop_PreOrder</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>) |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">proof_irrelevance</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_4_3</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

<a name="lab189"></a><h1 class="section">Exercise 4.2.4.4</h1>

</div>
<div class="code">
<span class="id" type="keyword">Module</span> <span class="id" type="var">Exercise_4_2_4_4</span>.<br/>
</div>

<div class="doc">
<a name="lab190"></a><h2 class="section">Problem</h2>
 Take again the preorder <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> of jurisdictions from Exercise
      4.2.4.3 and the idea that laws are propositions. But this time,
      let <span class="inlinecode"><a class="idref" href="Exercise_3_4_1_7.html#Exercise_3_4_1_7.R"><span class="id" type="variable">R</span></a>(<a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a>)</span> be the set of all possible laws (not just those
      dictated to hold) that are in actuality being respected,
      i.e. followed, by all people in <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>. This assigns to each
      jurisdiction a set. Since preorders can be considered
      categories, does our "the set of respected laws" function <span class="inlinecode"><a class="idref" href="Exercise_3_4_1_7.html#Exercise_3_4_1_7.R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">:</span>
      <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><span class="id" type="keyword">Set</span></span> extend to a functor <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Set</span></span>?

<div class="paragraph"> </div>

      What about if instead we take the meet of all these laws and
      assign to each jurisdiction the maximal law respected
      throughout. Does this assignment <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">Ob</span></span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> extend to a
      functor <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>? <a name="lab191"></a><h2 class="section">Solution</h2>
 If <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">&sube;</span> <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>, then <span class="inlinecode"><a class="idref" href="Exercise_3_4_1_7.html#Exercise_3_4_1_7.R"><span class="id" type="variable">R</span></a>(<a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a>)</span> <span class="inlinecode">&sube;</span> <span class="inlinecode"><a class="idref" href="Exercise_3_4_1_7.html#Exercise_3_4_1_7.R"><span class="id" type="variable">R</span></a>(<a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a>)</span>, because all the people in <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span>
      are also people in <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>, and so respect all the laws which
      everyone in <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> respects.  However, people in <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> might respect
      additional laws.  Again, we do not have a functor <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Set</span></span>,
      but <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#J"><span class="id" type="variable">J</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Set</span></span> <span class="inlinecode"><sup>op</sup></span>.

<div class="paragraph"> </div>

      The "maximal law" assignment does give us a functor a functor
      <span class="inlinecode"><span class="id" type="keyword">Set</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>, because if <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span> <span class="inlinecode">&sube;</span> <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>, then the maximal law of <span class="inlinecode"><a class="idref" href="Topology.html#subset_ensemble_union_intersection.U"><span class="id" type="variable">U</span></a></span>
      implies the maximal law of <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">Person</span> : <span class="id" type="keyword">Type</span>.<br/>
</div>

<div class="doc">
A jurisdiction is a set of people 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">Jurisdiction</span> := <span class="id" type="var">Ensemble</span> <span class="id" type="var">Person</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">Law</span> : <span class="id" type="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">LawAsProp</span> : <span class="id" type="var">Law</span> → <span class="id" type="keyword">Prop</span>.<br/>
</div>

<div class="doc">
The laws of a jurisdiction is a subset of the set of <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.Law"><span class="id" type="variable">Law</span></a></span>s 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">SetOfLaws</span> := <span class="id" type="var">Ensemble</span> <span class="id" type="var">Law</span>.<br/>
</div>

<div class="doc">
Each person respects some set of laws 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">RespectedLawsOfPerson</span> : <span class="id" type="var">Person</span> → <span class="id" type="var">SetOfLaws</span>.<br/>

<br/>
</div>

<div class="doc">
The laws respected by a jurisdiction is the set of laws
      respected by every person in that jurisdiction 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <span class="id" type="var">RespectedLawsOf</span> (<span class="id" type="var">J</span> : <span class="id" type="var">Jurisdiction</span>) : <span class="id" type="var">SetOfLaws</span> :=<br/>
&nbsp;&nbsp;| <span class="id" type="var">RespectedLawsOfAll</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">law</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">person</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">person</span> &isin; <span class="id" type="var">J</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" type="var">law</span> &isin; <span class="id" type="var">RespectedLawsOfPerson</span> <span class="id" type="var">person</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" type="var">law</span> &isin; <span class="id" type="var">RespectedLawsOf</span> <span class="id" type="var">J</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">JurisdictionPreOrder</span><br/>
&nbsp;&nbsp;: @<span class="id" type="var">PreOrder</span> <span class="id" type="var">Jurisdiction</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">U</span> <span class="id" type="var">V</span> ⇒ <span class="id" type="var">U</span> &sube; <span class="id" type="var">V</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Global Instance</span> <span class="id" type="var">SetsPreOrder</span> : @<span class="id" type="var">PreOrder</span> <span class="id" type="var">SetOfLaws</span> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" type="var">Ensemble_PreOrder</span> <span class="id" type="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 1 ⇒ <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Hint Extern</span> 1 ⇒ <span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">RespectedLawsOf</span>.<br/>

<br/>
</div>

<div class="doc">
If jurisdiction <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span> is a subset of jurisdiction <span class="inlinecode"><a class="idref" href="Category.html#d"><span class="id" type="variable">d</span></a></span>, we can show
      by unfolding of definitions and firstorder logical reasoning
      that the respected laws of <span class="inlinecode"><a class="idref" href="Category.html#d"><span class="id" type="variable">d</span></a></span> are a subset of the respected
      laws of <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span>.  (Intuitively, everyone in <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span> follows all the laws
      respected by people in <span class="inlinecode"><a class="idref" href="Category.html#d"><span class="id" type="variable">d</span></a></span>, and then some.) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">RespectedLawsOfFunctor_MorphismOf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>) <span class="id" type="var">s</span> <span class="id" type="var">d</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">Morphism</span> (<span class="id" type="var">OppositeCategory</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">SetsPreOrder</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">RespectedLawsOf</span> <span class="id" type="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">RespectedLawsOf</span> <span class="id" type="var">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">split</span> || <span class="id" type="tactic">intro</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">RespectedLawsOf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The fact that this is a functor follows by proof irrelevance. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">RespectedLawsOfFunctor</span> : <span class="id" type="var">Functor</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">OppositeCategory</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">SetsPreOrder</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">Build_Functor</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">OppositeCategory</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">SetsPreOrder</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">RespectedLawsOf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">RespectedLawsOfFunctor_MorphismOf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">proof_irrelevance</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <span class="id" type="var">maximal_law</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> <span class="id" type="var">S</span> : <span class="id" type="var">SetOfLaws</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> is a law of <span class="inlinecode"><a class="idref" href="PathsCategory.html#PathsCategory.V"><span class="id" type="variable">V</span></a></span> if there is some <span class="inlinecode"><a class="idref" href="Exercise_4_2_4_4.html#Exercise_4_2_4_4.Law"><span class="id" type="variable">Law</span></a></span> which is
        equal to <span class="inlinecode"><a class="idref" href="SubspaceTopology.html#subspace_topology.P"><span class="id" type="variable">P</span></a></span> when treated as a <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <span class="id" type="var">SetOfLawsAsProp</span> : <span class="id" type="var">Ensemble</span> <span class="id" type="keyword">Prop</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">P</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">L</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">L</span> &isin; <span class="id" type="var">S</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧ <span class="id" type="var">LawAsProp</span> <span class="id" type="var">L</span> = <span class="id" type="var">P</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">maximal_law</span> : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">EnsembleMeetElement</span> (<span class="id" type="var">EnsembleMeetOf</span> := <span class="id" type="var">PropHasEnsembleMeets</span> <span class="id" type="var">SetOfLawsAsProp</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <span class="id" type="var">maximal_law</span>.<br/>

<br/>
</div>

<div class="doc">
If jurisdiction <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span> is a subset of jurisdiction <span class="inlinecode"><a class="idref" href="Category.html#d"><span class="id" type="variable">d</span></a></span>, we can show
      by unfolding of definitions and firstorder logical reasoning
      that the maximal respected law of <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span> implies are a subset of
      the respected laws of <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span>.  (Intuitively, everyone in <span class="inlinecode"><a class="idref" href="Category.html#s"><span class="id" type="variable">s</span></a></span>
      follows all the laws respected by people in <span class="inlinecode"><a class="idref" href="Category.html#d"><span class="id" type="variable">d</span></a></span>, and then some.) 
<div class="paragraph"> </div>

 This proof is done by a combination of unfolding of definitions,
      firstorder logical reasoning, and educated guessing on the basis
      of hypotheses. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">MaximalRespectedLawOfFunctor_MorphismOf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">s</span> <span class="id" type="var">d</span> (<span class="id" type="var">m</span> : <span class="id" type="var">Morphism</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>) <span class="id" type="var">s</span> <span class="id" type="var">d</span>)<br/>
&nbsp;&nbsp;: <span class="id" type="var">Morphism</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">Prop_PreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">maximal_law</span> (<span class="id" type="var">RespectedLawsOf</span> <span class="id" type="var">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">maximal_law</span> (<span class="id" type="var">RespectedLawsOf</span> <span class="id" type="var">d</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">intro</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">RespectedLawsOf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="var">destruct_head_hnf</span> @<span class="id" type="var">ex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">progress</span> <span class="id" type="tactic">intuition</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">eexists</span>; <span class="id" type="tactic">split</span>; <span class="id" type="tactic">try</span> <span class="id" type="var">eassumption</span>; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">constructor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">firstorder</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The fact that this is a functor follows by proof irrelevance. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">MaximalRespectedLawOfFunctor</span> : <span class="id" type="var">Functor</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">Prop_PreOrder</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">Build_Functor</span> (<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">JurisdictionPreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">PreOrderCategory</span> <span class="id" type="var">Prop_PreOrder</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">J</span> ⇒ <span class="id" type="var">maximal_law</span> (<span class="id" type="var">RespectedLawsOf</span> <span class="id" type="var">J</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">MaximalRespectedLawOfFunctor_MorphismOf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">abstract</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">proof_irrelevance</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Exercise_4_2_4_4</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
</div>
<div class="code">
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>